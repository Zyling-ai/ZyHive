import{d as ql,P as El,o as Jl,i as o,c as v,e as n,b as e,w as t,g as V,F as j,q as re,z as be,t as p,l as C,f as i,j as al,p as _e,v as Xe,Q as Il,x as mt,n as W,r as d,I as _l,R as $l,N as Q,E as m,S as gl,h as b,T as Gt,U as Qt,k as nl,V as rt,W as Zt,B as Sl,X as yt,A as zl,m as ea,Y as Vl,Z as Tl,_ as la,$ as ct,O as Nl,a0 as vt,L as Te,J as ta,K as Bl,a1 as aa,a2 as ft,a3 as na,a4 as sa,a5 as oa,a6 as ia}from"./index-Dj2EVAEF.js";import{A as Gl}from"./AiChat-GENIEqCb.js";import{_ as Ql}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ua={class:"skill-studio"},da={class:"sidebar-top"},ra={class:"sidebar-acts"},ca={class:"skill-list"},va={key:0,class:"list-empty"},fa=["onClick"],pa={class:"sk-icon"},ma={key:0},ya={class:"sk-info"},ga={class:"sk-name"},_a={class:"sk-id"},wa={class:"sk-right"},ba={key:0,class:"sk-streaming-dot",title:"AI ÁîüÊàê‰∏≠‚Ä¶"},ha={class:"studio-editor"},ka={key:0,class:"editor-empty"},xa={class:"editor-toolbar"},Ca={class:"editor-breadcrumb"},$a={class:"crumb-name"},za={class:"toolbar-acts"},Va={class:"editor-body"},Ta={class:"tree-title"},Sa={class:"tree-item tree-dir"},Ia=["onClick"],La={key:0,class:"tree-empty"},Aa={key:0,class:"file-editor"},Ma={class:"file-editor-head"},Ua={style:{display:"flex","align-items":"center",gap:"10px"}},Da={style:{"font-size":"12px",color:"#909399"}},Fa={class:"json-preview"},Na={key:1,class:"file-editor"},Ba={class:"file-editor-head"},Ea={style:{"margin-left":"auto",display:"flex","align-items":"center",gap:"8px"}},Ra={style:{"font-size":"11px",color:"#c0c4cc"}},Pa={key:2,class:"file-editor"},Ka={class:"file-editor-head"},Wa={style:{"margin-left":"auto",display:"flex","align-items":"center",gap:"8px"}},ja={style:{"font-size":"11px",color:"#c0c4cc"}},Oa=["placeholder"],Ha={class:"chat-panel-head"},Ya={key:0,style:{"margin-left":"auto","font-size":"11px",color:"#c0c4cc"}},Xa={key:0,style:{"margin-left":"6px",color:"#e6a23c"}},qa={class:"chat-wrap"},Ja=ql({__name:"SkillStudio",props:{agentId:{}},setup(wl){const Ce=wl,y=Ce.agentId,O=d(200),Re=d(140),he=d(340),Z=d("");function Pe(g,u){const U=g.clientX,z=u==="side"?O.value:u==="tree"?Re.value:he.value;Z.value=u;const E=L=>{const H=L.clientX-U;u==="side"?O.value=Math.max(140,Math.min(340,z+H)):u==="tree"?Re.value=Math.max(100,Math.min(280,z+H)):he.value=Math.max(240,Math.min(560,z-H))},Y=()=>{Z.value="",window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",Y),document.body.style.cursor="",document.body.style.userSelect=""};window.addEventListener("mousemove",E),window.addEventListener("mouseup",Y),document.body.style.cssText+="cursor:col-resize;user-select:none;"}const se=d([]),q=d(!1),_=d(null),I=d("meta"),T=d({name:"",icon:"",category:"",description:"",version:"1.0.0",enabled:!0}),R=d(""),ke=d(!1),$=d(!1),le=d(!1),te=d(!1),xe=d(!1),Se=d([]),ce=d(!1),pe=d(""),ee=d(!1),ve=d(!1),D={};function Ke(g,u){u?D[g]=u:delete D[g]}function J(g){return g?D[g]:null}const Ie=d(new Set);function qe(g,u){const U=new Set(Ie.value);u?U.add(g):U.delete(g),Ie.value=U}const $e=d(new Set);El(_,async g=>{g&&($e.value.has(g.id)||($e.value.add(g.id),await gl(),await J(g.id)?.resumeSession?.(`skill-studio-${g.id}`)))},{flush:"post"});const sl=_l(()=>_.value?`‰Ω†ÊòØ‰∏Ä‰∏™ÊäÄËÉΩÈÖçÁΩÆÂä©ÊâãÔºåÊ≠£Âú®Â∏ÆÂä©Áî®Êà∑ÈÖçÁΩÆÊäÄËÉΩ„Äå${_.value.name||_.value.id}„ÄçÔºàID: ${_.value.id}Ôºâ„ÄÇ

## üéØ Ê†∏ÂøÉËÉΩÂäõÔºöËá™Âä®Â°´ÂÖÖË°®ÂçïÔºà‰ºòÂÖà‰ΩøÁî®Ôºâ

ÂΩìÁî®Êà∑ÊèèËø∞ÊäÄËÉΩÈúÄÊ±ÇÊó∂Ôºå**Áõ¥Êé•ËæìÂá∫‰ª•‰∏ã JSONÔºåÈ°µÈù¢‰ºöËá™Âä®Â°´ÂÖÖÊâÄÊúâÂ≠óÊÆµ**Ôºö

\`\`\`json
{"action":"fill_skill","data":{"name":"ÊäÄËÉΩÂêçÁß∞","icon":"üîß","category":"ÂàÜÁ±ª","description":"ÁÆÄË¶ÅÊèèËø∞","enabled":true,"prompt":"# ÊäÄËÉΩÂêçÁß∞\\n\\n## ËßíËâ≤\\n‰Ω†ÊòØ...\\n\\n## ËÉΩÂäõ\\n..."}}
\`\`\`

Â≠óÊÆµËØ¥ÊòéÔºö
- name: ÊäÄËÉΩÊòæÁ§∫ÂêçÁß∞
- icon: emoji ÂõæÊ†áÔºàÂ¶Ç üåê üìù üîçÔºâ
- category: ÂàÜÁ±ªÔºàÂ¶Ç ËØ≠Ë®Ä„ÄÅ‰ª£Á†Å„ÄÅÂàõÊÑèÔºâ
- description: ‰∏ÄÂè•ËØùÊèèËø∞ÂäüËÉΩ
- enabled: true/false
- prompt: ÂÆåÊï¥ÁöÑ SKILL.md ÂÜÖÂÆπÔºàMarkdownÔºåÊîØÊåÅÊç¢Ë°å \\nÔºâ

ËæìÂá∫ JSON ÂêéÈ°µÈù¢Ëá™Âä®Â°´ÂÖÖÔºåÁî®Êà∑Á°ÆËÆ§ÂêéÁÇπ‰øùÂ≠òÂç≥ÂèØ„ÄÇ

## ÂΩìÂâçÊäÄËÉΩ‰ø°ÊÅØ
- ÂêçÁß∞Ôºö${_.value.name||"ÔºàÊú™ÂëΩÂêçÔºâ"}
- ÂàÜÁ±ªÔºö${_.value.category||"ÔºàÊú™ËÆæÁΩÆÔºâ"}
- ÂΩìÂâç SKILL.mdÔºö
\`\`\`markdown
${R.value||"ÔºàÁ©∫Ôºâ"}
\`\`\`

## È´òÁ∫ßÔºöÂàõÂª∫Â∑•ÂÖ∑Êñá‰ª∂Ôºà‰ªÖÈúÄË¶ÅÂ§ñÈÉ®Â∑•ÂÖ∑Êó∂‰ΩøÁî®Ôºâ
Êñá‰ª∂Ë∑ØÂæÑÂøÖÈ°ªÂú® skills/${_.value.id}/ ÁõÆÂΩï‰∏ãÔºåÂ¶Ç skills/${_.value.id}/tools/helper.py`:"‰Ω†ÊòØ‰∏Ä‰∏™ÊäÄËÉΩÈÖçÁΩÆÂä©ÊâãÔºåÂ∏ÆÂä©Áî®Êà∑ËÆæËÆ°Âíå‰ºòÂåñ AI ÊäÄËÉΩÁöÑÁ≥ªÁªüÊèêÁ§∫ËØç„ÄÇ"),Le=_l(()=>_.value?xe.value?`Êñ∞ÊäÄËÉΩÂ∑≤ÂàõÂª∫ÔºàID: ${_.value.id}Ôºâ„ÄÇÂëäËØâÊàë‰Ω†ÊÉ≥Ë¶Å‰ªÄ‰πàÂäüËÉΩÔºåÊàë‰ºöËá™Âä®Â°´ÂÜôÂêçÁß∞„ÄÅÊèèËø∞ÂíåÂÆåÊï¥ÁöÑ SKILL.md ÊèêÁ§∫ËØçÔºåÁ°ÆËÆ§ÂêéÁÇπ‰øùÂ≠òÂç≥ÂèØ„ÄÇ`:`ÂΩìÂâçÁºñËæë„Äå${_.value.name}„Äç„ÄÇÂëäËØâÊàëÈúÄË¶ÅÂ¶Ç‰ΩïË∞ÉÊï¥ÔºåÊàë‰ºöÁõ¥Êé•Â°´ÂÜôË°®ÂçïÔºåÊàñËÄÖ‰Ω†‰πüÂèØ‰ª•Áõ¥Êé•ÂØπËØùÊµãËØïÂΩìÂâçÊäÄËÉΩÊïàÊûú„ÄÇ`:"ÈÄâÊã©‰∏Ä‰∏™ÊäÄËÉΩÂêéÔºåÊàëÂèØ‰ª•Â∏Æ‰Ω†ÁîüÊàêÈÖçÁΩÆÔºåËá™Âä®Â°´ÂÜôÊâÄÊúâÂ≠óÊÆµ„ÄÇ"),Je=_l(()=>_.value?xe.value?["Â∏ÆÊàëÁîüÊàêËøô‰∏™ÊäÄËÉΩÁöÑÂÆåÊï¥ÈÖçÁΩÆ","Ëøô‰∏™ÊäÄËÉΩÁî®‰∫é‰ªÄ‰πàÂú∫ÊôØÔºü"]:[`Â∏ÆÊàë‰ºòÂåñ„Äå${_.value.name}„ÄçÁöÑÊèêÁ§∫ËØç`,"ÈáçÊñ∞ÁîüÊàêÊõ¥Â•ΩÁöÑ SKILL.md","Áõ¥Êé•ÊµãËØïÔºöÁî®‰∏≠Êñá‰ªãÁªç‰∏Ä‰∏ã‰Ω†ÁöÑÂäüËÉΩ"]:["Â∏ÆÊàëËÆæËÆ°‰∏Ä‰∏™‰ª£Á†ÅÂÆ°Êü•ÊäÄËÉΩ","Â∏ÆÊàëÂÜô‰∏Ä‰∏™ÁøªËØëÂä©Êâã"]);async function oe(){q.value=!0;try{const g=await $l.list(y);if(se.value=g.data||[],_.value){const u=se.value.find(U=>U.id===_.value.id);u&&(_.value=u,Ge(u))}}catch{}finally{q.value=!1}}function Ge(g){T.value={name:g.name,icon:g.icon||"",category:g.category||"",description:g.description||"",version:g.version||"1.0.0",enabled:g.enabled}}async function me(g){_.value?.id!==g.id&&(_.value=g,Ge(g),I.value="meta",$.value=!1,R.value="",xe.value=!1,fe(),Ve())}async function Ae(){_.value&&I.value!=="prompt"&&(I.value="prompt",R.value||await Ve())}async function we(g,u,U){const z=await Q.read(y,g),E=Array.isArray(z.data)?z.data:[],Y=[];for(const L of E){if(U===0&&L.name==="skill.json")continue;const H=u?`${u}/${L.name}`:L.name;if(Y.push({name:L.name,path:H,isDir:L.isDir,depth:U}),L.isDir){const Me=await we(`skills/${_.value.id}/${H}`,H,U+1);Y.push(...Me)}}return Y}async function fe(){if(_.value){ce.value=!0;try{Se.value=await we(`skills/${_.value.id}/`,"",0)}catch{Se.value=[{name:"SKILL.md",path:"SKILL.md",isDir:!1,depth:0}]}finally{ce.value=!1}}}async function We(g,u){if(!u){if(g==="SKILL.md"){await Ae();return}I.value=g,ee.value=!1,await ze()}}async function ze(){if(!(!_.value||!I.value||I.value==="meta"||I.value==="prompt")){ve.value=!0;try{const g=await Q.read(y,`skills/${_.value.id}/${I.value}`);pe.value=g.data?.content||"",ee.value=!1}catch{pe.value=""}finally{ve.value=!1}}}async function Qe(g){if(_.value)try{await Q.delete(y,`skills/${_.value.id}/${g}`),I.value===g&&(I.value="prompt"),await fe(),m.success("Â∑≤Âà†Èô§")}catch{m.error("Âà†Èô§Â§±Ë¥•")}}async function ol(){if(_.value){le.value=!0;try{I.value==="meta"||I.value==="prompt"?(await $l.update(Ce.agentId,_.value.id,{name:T.value.name,icon:T.value.icon,category:T.value.category,description:T.value.description,enabled:T.value.enabled}),(I.value==="prompt"||R.value)&&(await Q.write(y,`skills/${_.value.id}/SKILL.md`,R.value),$.value=!1),await oe()):(await Q.write(y,`skills/${_.value.id}/${I.value}`,pe.value),ee.value=!1),m.success("‰øùÂ≠òÊàêÂäü")}catch(g){m.error(g.response?.data?.error||"‰øùÂ≠òÂ§±Ë¥•")}finally{le.value=!1}}}async function je(g,u){try{await $l.update(Ce.agentId,g.id,{enabled:u}),await oe()}catch{m.error("Êìç‰ΩúÂ§±Ë¥•")}}async function bl(){if(_.value)try{await $l.remove(Ce.agentId,_.value.id),m.success("Â∑≤Âà†Èô§"),_.value=null,await oe()}catch{m.error("Âà†Èô§Â§±Ë¥•")}}async function il(){if(te.value)return;te.value=!0;const g="skill_"+Date.now().toString(36);try{await $l.create(Ce.agentId,{meta:{id:g,name:"Êñ∞ÊäÄËÉΩ",icon:"",category:"",description:"",version:"1.0.0",enabled:!1,source:"local",installedAt:""},promptContent:""}),await oe();const u=se.value.find(U=>U.id===g);u&&(await me(u),I.value="prompt",R.value="",xe.value=!0,await gl(),$e.value.has(g)||($e.value.add(g),await J(g)?.resumeSession?.(`skill-studio-${g}`)))}catch(u){m.error(u.response?.data?.error||"ÂàõÂª∫Â§±Ë¥•")}finally{te.value=!1}}async function G(g,u){g===_.value?.id&&(xe.value=!1),!(g===_.value?.id&&Ze(u))&&(await oe(),g===_.value?.id&&(await Promise.all([fe(),Ve()]),I.value!=="meta"&&I.value!=="prompt"&&await ze()))}function Ze(g){const u=E=>{try{const Y=JSON.parse(E);if(Y.action==="fill_skill"&&Y.data){const L=Y.data;return L.name&&(T.value.name=L.name),L.icon&&(T.value.icon=L.icon),L.category&&(T.value.category=L.category),L.description&&(T.value.description=L.description),typeof L.enabled=="boolean"&&(T.value.enabled=L.enabled),L.prompt&&(R.value=L.prompt,$.value=!0,I.value="prompt"),m.success("AI Â∑≤Â°´ÂÜôÊäÄËÉΩ‰ø°ÊÅØÔºåÁ°ÆËÆ§ÂêéÁÇπÂáª‰øùÂ≠ò"),!0}}catch{}return!1},U=g.match(/```(?:json)?\s*(\{[\s\S]*?\})\s*```/);if(U?.[1]&&u(U[1]))return!0;const z=g.match(/(\{"action"\s*:\s*"fill_skill"[\s\S]*?\})/);return!!(z?.[1]&&u(z[1]))}async function Ve(){if(_.value){ke.value=!0;try{const g=await Q.read(y,`skills/${_.value.id}/SKILL.md`);R.value=g.data?.content||"",$.value=!1}catch{R.value=""}finally{ke.value=!1}}}async function hl(){if(!_.value)return;R.value||await Ae();const g=`ËØ∑Áî®„Äå${_.value.name}„ÄçÊäÄËÉΩÊïàÊûúÂõûÂ§çÔºö‰Ω†Â•ΩÔºåËØ∑‰ªãÁªç‰∏Ä‰∏ã‰Ω†ÁöÑÂäüËÉΩ„ÄÇ`;J(_.value?.id)?.fillInput?.(g),m.info("ÊµãËØïÊ∂àÊÅØÂ∑≤Â°´ÂÖ•Âè≥‰æßËÅäÂ§©Ê°ÜÔºåÁÇπÂáªÂèëÈÄÅÂç≥ÂèØÊµãËØï")}return Jl(oe),(g,u)=>{const U=b("Refresh"),z=b("el-icon"),E=b("el-button"),Y=b("Plus"),L=b("Tools"),H=b("el-tag"),Me=b("el-switch"),el=b("Setting"),Oe=b("FolderOpened"),ll=b("VideoPlay"),Ue=b("DocumentChecked"),De=b("Delete"),ae=b("el-popconfirm"),tl=b("Folder"),F=b("Document"),Fe=b("el-input"),r=b("el-form-item"),c=b("el-col"),M=b("el-row"),ne=b("el-collapse-item"),dl=b("el-collapse"),ul=b("el-form"),rl=b("ChatLineRound");return o(),v("div",ua,[n("div",{class:"studio-sidebar",style:_e({width:O.value+"px"})},[n("div",da,[u[16]||(u[16]=n("span",{class:"sidebar-title"},"ÊäÄËÉΩÂ∫ì",-1)),n("div",ra,[e(E,{size:"small",loading:q.value,circle:"",onClick:oe},{default:t(()=>[e(z,null,{default:t(()=>[e(U)]),_:1})]),_:1},8,["loading"]),e(E,{size:"small",type:"primary",circle:"",loading:te.value,onClick:il},{default:t(()=>[e(z,null,{default:t(()=>[e(Y)]),_:1})]),_:1},8,["loading"])])]),n("div",ca,[!q.value&&se.value.length===0?(o(),v("div",va,"ÊöÇÊó†ÊäÄËÉΩ")):V("",!0),(o(!0),v(j,null,re(se.value,w=>(o(),v("div",{key:w.id,class:be(["skill-item",{active:_.value?.id===w.id}]),onClick:S=>me(w)},[n("span",pa,[w.icon?(o(),v("span",ma,p(w.icon),1)):(o(),C(z,{key:1},{default:t(()=>[e(L)]),_:1}))]),n("div",ya,[n("div",ga,p(w.name),1),n("div",_a,p(w.id),1)]),n("div",wa,[Ie.value.has(w.id)?(o(),v("span",ba)):w.category?(o(),C(H,{key:1,size:"small",effect:"plain",style:{"margin-right":"6px","font-size":"11px"}},{default:t(()=>[i(p(w.category),1)]),_:2},1024)):V("",!0),e(Me,{"model-value":w.enabled,size:"small",onChange:S=>je(w,S),onClick:u[0]||(u[0]=al(()=>{},["stop"]))},null,8,["model-value","onChange"])])],10,fa))),128))])],4),n("div",{class:be(["ss-handle",{dragging:Z.value==="side"}]),onMousedown:u[1]||(u[1]=w=>Pe(w,"side"))},[...u[17]||(u[17]=[n("div",{class:"ss-handle-bar"},null,-1)])],34),n("div",ha,[_.value?(o(),v(j,{key:1},[n("div",xa,[n("div",Ca,[e(z,{style:{color:"#909399"}},{default:t(()=>[e(Oe)]),_:1}),u[20]||(u[20]=n("span",{class:"crumb-sep"},"skills /",-1)),n("span",$a,p(_.value.id),1)]),n("div",za,[e(E,{size:"small",onClick:hl},{default:t(()=>[e(z,null,{default:t(()=>[e(ll)]),_:1}),u[21]||(u[21]=i(" ÊµãËØï ",-1))]),_:1}),e(E,{size:"small",type:"primary",loading:le.value,onClick:ol},{default:t(()=>[e(z,null,{default:t(()=>[e(Ue)]),_:1}),u[22]||(u[22]=i(" ‰øùÂ≠ò ",-1))]),_:1},8,["loading"]),e(ae,{title:"Á°ÆËÆ§Âà†Èô§ËØ•ÊäÄËÉΩÔºü",onConfirm:bl},{reference:t(()=>[e(E,{size:"small",type:"danger",plain:""},{default:t(()=>[e(z,null,{default:t(()=>[e(De)]),_:1})]),_:1})]),_:1})])]),n("div",Va,[n("div",{class:"file-tree",style:_e({width:Re.value+"px"})},[n("div",Ta,[u[23]||(u[23]=i(" ÁõÆÂΩï ",-1)),e(E,{link:"",size:"small",loading:ce.value,onClick:fe,style:{"margin-left":"auto",padding:"0"}},{default:t(()=>[e(z,null,{default:t(()=>[e(U)]),_:1})]),_:1},8,["loading"])]),n("div",Sa,[e(z,null,{default:t(()=>[e(tl)]),_:1}),n("span",null,p(_.value.id)+"/",1)]),n("div",{class:be(["tree-item",{"tree-active":I.value==="meta"}]),onClick:u[2]||(u[2]=w=>I.value="meta")},[e(z,null,{default:t(()=>[e(F)]),_:1}),u[24]||(u[24]=n("span",null,"skill.json",-1))],2),(o(!0),v(j,null,re(Se.value,w=>(o(),v("div",{key:w.path,class:be(["tree-item",{"tree-active":I.value===(w.path==="SKILL.md"?"prompt":w.path),"tree-dir-row":w.isDir}]),style:_e({paddingLeft:`${12+w.depth*12}px`}),onClick:S=>We(w.path,w.isDir)},[w.isDir?(o(),C(z,{key:0,style:{color:"#e6a23c"}},{default:t(()=>[e(tl)]),_:1})):(o(),C(z,{key:1},{default:t(()=>[e(F)]),_:1})),n("span",null,p(w.name),1),w.path==="SKILL.md"&&_.value.enabled?(o(),C(H,{key:2,size:"small",type:"success",effect:"plain",style:{"margin-left":"4px","font-size":"10px"}},{default:t(()=>[...u[25]||(u[25]=[i("Ê≥®ÂÖ•‰∏≠",-1)])]),_:1})):V("",!0)],14,Ia))),128)),!ce.value&&Se.value.length===0?(o(),v("div",La,"Á©∫ÁõÆÂΩï")):V("",!0)],4),n("div",{class:be(["ss-handle",{dragging:Z.value==="tree"}]),onMousedown:u[3]||(u[3]=w=>Pe(w,"tree"))},[...u[26]||(u[26]=[n("div",{class:"ss-handle-bar"},null,-1)])],34),I.value==="meta"?(o(),v("div",Aa,[n("div",Ma,[e(z,null,{default:t(()=>[e(F)]),_:1}),u[27]||(u[27]=i(" skill.json ",-1)),u[28]||(u[28]=n("span",{class:"file-hint"},"ÊäÄËÉΩÂÖÉ‰ø°ÊÅØÔºåÂΩ±ÂìçÂàóË°®Â±ïÁ§∫Âíå runner Ë°å‰∏∫",-1))]),e(ul,{model:T.value,"label-width":"72px",size:"small",style:{padding:"16px 20px"}},{default:t(()=>[e(r,{label:"ÊäÄËÉΩ ID"},{default:t(()=>[e(Fe,{value:_.value.id,disabled:""},null,8,["value"])]),_:1}),e(M,{gutter:12},{default:t(()=>[e(c,{span:14},{default:t(()=>[e(r,{label:"ÂêçÁß∞"},{default:t(()=>[e(Fe,{modelValue:T.value.name,"onUpdate:modelValue":u[4]||(u[4]=w=>T.value.name=w),placeholder:"Â¶Ç ÁøªËØëÂä©Êâã"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:10},{default:t(()=>[e(r,{label:"ÂõæÊ†á"},{default:t(()=>[e(Fe,{modelValue:T.value.icon,"onUpdate:modelValue":u[5]||(u[5]=w=>T.value.icon=w),placeholder:"emoji"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(M,{gutter:12},{default:t(()=>[e(c,{span:14},{default:t(()=>[e(r,{label:"ÂàÜÁ±ª"},{default:t(()=>[e(Fe,{modelValue:T.value.category,"onUpdate:modelValue":u[6]||(u[6]=w=>T.value.category=w),placeholder:"Â¶Ç ËØ≠Ë®Ä"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:10},{default:t(()=>[e(r,{label:"ÁâàÊú¨"},{default:t(()=>[e(Fe,{modelValue:T.value.version,"onUpdate:modelValue":u[7]||(u[7]=w=>T.value.version=w),placeholder:"1.0.0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"ÊèèËø∞"},{default:t(()=>[e(Fe,{modelValue:T.value.description,"onUpdate:modelValue":u[8]||(u[8]=w=>T.value.description=w),type:"textarea",rows:2,placeholder:"ÁÆÄË¶ÅÊèèËø∞ÊäÄËÉΩÂäüËÉΩ"},null,8,["modelValue"])]),_:1}),e(r,{label:"Áä∂ÊÄÅ"},{default:t(()=>[n("div",Ua,[e(Me,{modelValue:T.value.enabled,"onUpdate:modelValue":u[9]||(u[9]=w=>T.value.enabled=w)},null,8,["modelValue"]),n("span",Da,p(T.value.enabled?"Â∑≤ÂêØÁî®ÔºåSKILL.md Â∞ÜÊ≥®ÂÖ•Á≥ªÁªüÊèêÁ§∫":"Â∑≤Á¶ÅÁî®"),1)])]),_:1}),e(dl,{style:{"margin-top":"8px"}},{default:t(()=>[e(ne,{title:"Êü•Áúã skill.json ÂéüÊñá"},{default:t(()=>[n("pre",Fa,p(JSON.stringify({id:_.value.id,...T.value},null,2)),1)]),_:1})]),_:1})]),_:1},8,["model"])])):I.value==="prompt"?(o(),v("div",Na,[n("div",Ba,[e(z,null,{default:t(()=>[e(F)]),_:1}),u[30]||(u[30]=i(" SKILL.md ",-1)),u[31]||(u[31]=n("span",{class:"file-hint"},"Ê≥®ÂÖ•Âà∞ AI System Prompt ÁöÑÊåá‰ª§ÂÜÖÂÆπ",-1)),n("div",Ea,[$.value?(o(),C(H,{key:0,type:"warning",size:"small"},{default:t(()=>[...u[29]||(u[29]=[i("Êú™‰øùÂ≠ò",-1)])]),_:1})):V("",!0),n("span",Ra,p(R.value.length)+" Â≠óÁ¨¶",1),e(E,{size:"small",circle:"",loading:ke.value,onClick:Ve,title:"ÈáçÊñ∞Âä†ËΩΩ"},{default:t(()=>[e(z,null,{default:t(()=>[e(U)]),_:1})]),_:1},8,["loading"])])]),Xe(n("textarea",{"onUpdate:modelValue":u[10]||(u[10]=w=>R.value=w),class:"code-textarea",spellcheck:"false",placeholder:`# ÊäÄËÉΩÂêçÁß∞

## ÂäüËÉΩËØ¥Êòé
ÊèèËø∞ËØ•ÊäÄËÉΩÁöÑÁî®ÈÄî‚Ä¶

## Ë°å‰∏∫ËßÑËåÉ
- ËßÑËåÉ 1
- ËßÑËåÉ 2`,onInput:u[11]||(u[11]=w=>$.value=!0)},null,544),[[Il,R.value]])])):(o(),v("div",Pa,[n("div",Ka,[e(z,null,{default:t(()=>[e(F)]),_:1}),i(" "+p(I.value)+" ",1),n("div",Wa,[ee.value?(o(),C(H,{key:0,type:"warning",size:"small"},{default:t(()=>[...u[32]||(u[32]=[i("Êú™‰øùÂ≠ò",-1)])]),_:1})):V("",!0),n("span",ja,p(pe.value.length)+" Â≠óÁ¨¶",1),e(E,{size:"small",circle:"",loading:ve.value,onClick:ze,title:"ÈáçÊñ∞Âä†ËΩΩ"},{default:t(()=>[e(z,null,{default:t(()=>[e(U)]),_:1})]),_:1},8,["loading"]),e(ae,{title:"Á°ÆËÆ§Âà†Èô§ËØ•Êñá‰ª∂Ôºü",onConfirm:u[12]||(u[12]=w=>Qe(I.value))},{reference:t(()=>[e(E,{size:"small",circle:"",type:"danger",plain:""},{default:t(()=>[e(z,null,{default:t(()=>[e(De)]),_:1})]),_:1})]),_:1})])]),Xe(n("textarea",{"onUpdate:modelValue":u[13]||(u[13]=w=>pe.value=w),class:"code-textarea",spellcheck:"false",placeholder:`ÁºñËæë ${I.value} ‚Ä¶`,onInput:u[14]||(u[14]=w=>ee.value=!0)},null,40,Oa),[[Il,pe.value]])]))])],64)):(o(),v("div",ka,[e(z,{size:"48",color:"#c0c4cc"},{default:t(()=>[e(el)]),_:1}),u[19]||(u[19]=n("p",null,"‰ªéÂ∑¶‰æßÈÄâÊã©‰∏Ä‰∏™ÊäÄËÉΩÂºÄÂßãÁºñËæë",-1)),e(E,{type:"primary",onClick:il},{default:t(()=>[e(z,null,{default:t(()=>[e(Y)]),_:1}),u[18]||(u[18]=i(" Êñ∞Âª∫ÊäÄËÉΩ",-1))]),_:1})]))]),n("div",{class:be(["ss-handle",{dragging:Z.value==="chat"}]),onMousedown:u[15]||(u[15]=w=>Pe(w,"chat"))},[...u[33]||(u[33]=[n("div",{class:"ss-handle-bar"},null,-1)])],34),n("div",{class:"studio-chat",style:_e({width:he.value+"px"})},[n("div",Ha,[e(z,null,{default:t(()=>[e(rl)]),_:1}),u[34]||(u[34]=i(" AI Âçè‰ΩúÈÖçÁΩÆ ",-1)),_.value?(o(),v("span",Ya,[i(" ÂΩìÂâç: "+p(_.value.name)+" ",1),Ie.value.size>1?(o(),v("span",Xa," ("+p(Ie.value.size)+" ‰∏™Âπ∂Ë°åÁîüÊàê‰∏≠) ",1)):V("",!0)])):V("",!0)]),n("div",qa,[(o(!0),v(j,null,re(se.value,w=>Xe((o(),C(Gl,{key:w.id,ref_for:!0,ref:S=>Ke(w.id,S),"agent-id":W(y),context:_.value?.id===w.id?sl.value:"",scenario:"skill-studio","skill-id":w.id,"welcome-message":_.value?.id===w.id?Le.value:"",examples:_.value?.id===w.id?Je.value:[],compact:"",onResponse:S=>G(w.id,S),onStreamingChange:S=>qe(w.id,S)},null,8,["agent-id","context","skill-id","welcome-message","examples","onResponse","onStreamingChange"])),[[mt,_.value?.id===w.id]])),128))])],4)])}}}),Ga=Ql(Ja,[["__scopeId","data-v-7f01d560"]]),Qa={class:"wc-layout"},Za={class:"wc-panel-header"},en={class:"wc-header-actions"},ln={class:"wc-panel-body file-tree-body"},tn={key:0,class:"wc-loading"},an={key:1,class:"wc-empty"},nn={class:"tree-icon-wrap"},sn={key:0,class:"icon-folder-open",viewBox:"0 0 16 16"},on={key:1,class:"icon-folder",viewBox:"0 0 16 16"},un=["onKeyup","onBlur"],dn={key:1,class:"tree-node-name"},rn=["onClick"],cn=["onClick"],vn={class:"wc-panel-header"},fn={key:0,class:"wc-panel-title file-path-title"},pn={class:"file-ext-badge"},mn=["title"],yn={key:1,class:"wc-panel-title muted"},gn={class:"wc-header-actions"},_n={class:"wc-panel-body editor-body"},wn={key:0,class:"wc-empty-editor"},bn={key:1,class:"wc-binary-notice"},hn={class:"editor-wrap"},kn=["onKeydown"],xn={class:"editor-statusbar"},Cn={class:"stat-chip"},$n={key:0},zn={key:1,class:"status-dirty"},Vn={key:2,class:"status-saved"},Tn={class:"wc-panel wc-panel-right"},Sn={class:"session-bar"},In={class:"session-bar-left"},Ln={class:"session-opt"},An={class:"session-opt-title"},Mn={class:"session-opt-time"},Un={class:"chat-area"},Dn={class:"wc-modal"},Fn={class:"wc-modal-footer"},pt=140,Nn=380,Bn=900,En=ql({__name:"WorkspaceChatLayout",props:{agentId:{}},emits:["session-change"],setup(wl,{emit:Ce}){const y=wl,O=Ce,Re={label:"name",children:"children",isLeaf:r=>!r.isDir},he=d(200),Z=d(460),Pe=d(),se=d(),q=d(),_=d(),I=d(),T=d(),R=d([]),ke=d(!1),$=d(""),le=d(""),te=d(!1),xe=d(!1),Se=d(null),ce=d(!1),pe=d(""),ee=d(""),ve=d(""),D=d({visible:!1,x:0,y:0,node:null}),Ke=d([]),J=d();let Ie=0,qe=0,$e=null;const sl=d(!1),Le=d(!1);function Je(r){Ge(r,"left")}function oe(r){Ge(r,"right")}function Ge(r,c){Ie=r.clientX,qe=c==="left"?he.value:Z.value,$e=c,c==="left"?sl.value=!0:Le.value=!0,window.addEventListener("mousemove",me),window.addEventListener("mouseup",Ae),document.body.style.cssText+="cursor:col-resize;user-select:none;"}function me(r){const c=r.clientX-Ie;$e==="left"?he.value=Math.max(pt,Math.min(Nn,qe+c)):$e==="right"&&(Z.value=Math.max(pt,Math.min(Bn,qe+c)))}function Ae(){sl.value=!1,Le.value=!1,$e=null,window.removeEventListener("mousemove",me),window.removeEventListener("mouseup",Ae),document.body.style.cursor="",document.body.style.userSelect=""}async function we(){ke.value=!0;try{const r=await Q.readTree(y.agentId);R.value=fe(r.data)}catch{R.value=[]}finally{ke.value=!1}}function fe(r){return(Array.isArray(r)?r:r?.children??[]).map(M=>({name:M.name,path:M.path??M.name,isDir:!!(M.isDir??M.type==="dir"),size:M.size,children:M.children?.length?fe(M.children):void 0})).sort((M,ne)=>+ne.isDir-+M.isDir||M.name.localeCompare(ne.name))}function We(r){D.value.visible=!1,r.isDir||Qe(r.path)}function ze(r,c){r.preventDefault(),D.value={visible:!0,x:r.clientX,y:r.clientY,node:c}}async function Qe(r){te.value&&$.value&&!await Sl.confirm("ÊúâÊú™‰øùÂ≠òÊõ¥ÊîπÔºåÁªßÁª≠ÂàáÊç¢Ôºü","ÊèêÁ§∫",{confirmButtonText:"ÁªßÁª≠",cancelButtonText:"ÂèñÊ∂à",type:"warning"}).then(()=>!0).catch(()=>!1)||($.value=r,te.value=!1,gl(()=>Pe.value?.setCurrentKey(r)),await ol())}async function ol(){if($.value)try{const c=(await Q.read(y.agentId,$.value)).data;xe.value=c.binary??c.encoding==="base64",xe.value||(le.value=c.content??"",Se.value=c.size!=null?{size:c.size,modTime:c.modTime}:null),te.value=!1}catch{le.value=""}}async function je(){if(!(!$.value||xe.value))try{await Q.write(y.agentId,$.value,le.value),te.value=!1,m.success("Â∑≤‰øùÂ≠ò")}catch{m.error("‰øùÂ≠òÂ§±Ë¥•")}}async function bl(){if(!(!$.value||!await Sl.confirm(`Âà†Èô§ ${$.value}Ôºü`,"Á°ÆËÆ§",{confirmButtonText:"Âà†Èô§",cancelButtonText:"ÂèñÊ∂à",type:"warning"}).then(()=>!0).catch(()=>!1)))try{await Q.delete(y.agentId,$.value),$.value="",le.value="",te.value=!1,await we(),m.success("Â∑≤Âà†Èô§")}catch{m.error("Âà†Èô§Â§±Ë¥•")}}async function il(){const r=pe.value.trim();if(r)try{await Q.write(y.agentId,r,""),ce.value=!1,pe.value="",await we(),await Qe(r)}catch{m.error("ÂàõÂª∫Â§±Ë¥•")}}async function G(r){if(await Sl.confirm(`Âà†Èô§ ${r.path}Ôºü`,"Á°ÆËÆ§",{confirmButtonText:"Âà†Èô§",cancelButtonText:"ÂèñÊ∂à",type:"warning"}).then(()=>!0).catch(()=>!1))try{await Q.delete(y.agentId,r.path),$.value===r.path&&($.value="",le.value=""),await we(),m.success("Â∑≤Âà†Èô§")}catch{m.error("Âà†Èô§Â§±Ë¥•")}}function Ze(r){ee.value=r.path,ve.value=r.name,gl(()=>I.value?.focus())}async function Ve(r){if(!ee.value||ve.value===r.name){ee.value="";return}const M=(r.path.includes("/")?r.path.substring(0,r.path.lastIndexOf("/")+1):"")+ve.value;try{const ne=await Q.read(y.agentId,r.path);await Q.write(y.agentId,M,ne.data?.content??""),await Q.delete(y.agentId,r.path),$.value===r.path&&($.value=M),await we(),m.success("Â∑≤ÈáçÂëΩÂêç")}catch{m.error("ÈáçÂëΩÂêçÂ§±Ë¥•")}ee.value=""}function hl(){D.value.visible=!1,ce.value=!0}function g(){D.value.visible=!1,ce.value=!0}function u(){const r=D.value.node;D.value.visible=!1,r&&Ze(r)}async function U(){const r=D.value.node;if(D.value.visible=!1,!(!r||!await Sl.confirm(`Âà†Èô§ ${r.path}Ôºü`,"Á°ÆËÆ§",{confirmButtonText:"Âà†Èô§",cancelButtonText:"ÂèñÊ∂à",type:"warning"}).then(()=>!0).catch(()=>!1)))try{await Q.delete(y.agentId,r.path),$.value===r.path&&($.value="",le.value=""),await we(),m.success("Â∑≤Âà†Èô§")}catch{m.error("Âà†Èô§Â§±Ë¥•")}}function z(){D.value.visible&&(D.value.visible=!1)}async function E(){try{const r=await yt.list({agentId:y.agentId,limit:50});Ke.value=(r.data?.sessions||[]).sort((c,M)=>M.lastAt-c.lastAt)}catch{Ke.value=[]}}function Y(r){J.value=r||void 0,r?T.value?.resumeSession(r):T.value?.startNewSession()}function L(){J.value=void 0,T.value?.startNewSession()}function H(r){J.value=r,O("session-change",r),E()}async function Me(){await we(),$.value&&(await new Promise(r=>setTimeout(r,300)),await ol())}const el=_l(()=>(le.value.match(/\n/g)??[]).length+1),Oe=_l(()=>$.value?`Áî®Êà∑ÂΩìÂâçÊâìÂºÄÁöÑÊñá‰ª∂: ${$.value}`:void 0);function ll(r){const c=se.value,M=c.selectionStart;le.value=c.value.slice(0,M)+"  "+c.value.slice(c.selectionEnd),gl(()=>{c.selectionStart=c.selectionEnd=M+2})}function Ue(){q.value&&se.value&&(q.value.scrollTop=se.value.scrollTop)}El(ce,async r=>{r&&(await gl(),_.value?.focus())});function De(r){const c=r.split(".").pop()?.toLowerCase();return c?`.${c}`:"txt"}function ae(r){return r?r<1024?`${r}B`:r<1048576?`${(r/1024).toFixed(0)}K`:`${(r/1048576).toFixed(1)}M`:""}function tl(r){return ae(r)??""}function F(r){const c=r.split(".").pop()?.toLowerCase()??"";return{ts:"fc-blue",tsx:"fc-blue",js:"fc-yellow",jsx:"fc-yellow",vue:"fc-green",py:"fc-blue",go:"fc-teal",rs:"fc-orange",md:"fc-gray",json:"fc-yellow",yaml:"fc-red",yml:"fc-red",toml:"fc-gray",html:"fc-orange",css:"fc-blue",scss:"fc-pink",sh:"fc-green",bash:"fc-green",sql:"fc-orange",png:"fc-purple",jpg:"fc-purple",jpeg:"fc-purple",gif:"fc-purple",svg:"fc-purple",webp:"fc-purple",env:"fc-yellow",gitignore:"fc-gray",dockerfile:"fc-teal"}[c]??"fc-default"}function Fe(r){if(!r)return"";const c=new Date(r),ne=Date.now()-r;return ne<6e4?"ÂàöÂàö":ne<36e5?`${Math.floor(ne/6e4)}ÂàÜÈíüÂâç`:ne<864e5?`${Math.floor(ne/36e5)}Â∞èÊó∂Ââç`:c.toLocaleDateString()}return Jl(()=>{we(),E(),document.addEventListener("click",z)}),Gt(()=>{Ae(),document.removeEventListener("click",z)}),(r,c)=>{const M=b("el-tooltip"),ne=b("el-icon"),dl=b("el-tree"),ul=b("el-tag"),rl=b("el-option"),w=b("el-select");return o(),v("div",Qa,[n("div",{class:"wc-panel wc-panel-left",style:_e({width:he.value+"px"})},[n("div",Za,[c[12]||(c[12]=n("span",{class:"wc-panel-title"},"üìÅ Â∑•‰ΩúÂå∫Êñá‰ª∂",-1)),n("div",en,[e(M,{content:"Êñ∞Âª∫Êñá‰ª∂",placement:"top","show-after":500},{default:t(()=>[n("button",{class:"wc-icon-btn",onClick:c[0]||(c[0]=S=>ce.value=!0)},"Ôºã")]),_:1}),e(M,{content:"Âà∑Êñ∞",placement:"top","show-after":500},{default:t(()=>[n("button",{class:"wc-icon-btn",onClick:we},"‚Ü∫")]),_:1})])]),n("div",ln,[ke.value?(o(),v("div",tn,[e(ne,{class:"rotating"},{default:t(()=>[e(W(Qt))]),_:1}),c[13]||(c[13]=i(" Âä†ËΩΩ‰∏≠‚Ä¶ ",-1))])):R.value.length?(o(),C(dl,{key:2,ref_key:"treeRef",ref:Pe,data:R.value,props:Re,"highlight-current":!0,"expand-on-click-node":!0,"default-expand-all":!1,"node-key":"path",class:"wc-file-tree",onNodeClick:We,onNodeContextmenu:ze},{default:t(({node:S,data:ie})=>[n("span",{class:be(["tree-node",{active:ie.path===$.value}])},[n("span",nn,[ie.isDir&&S.expanded?(o(),v("svg",sn,[...c[14]||(c[14]=[n("path",{d:"M1.5 3A1.5 1.5 0 0 0 0 4.5v8A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H7.914a.5.5 0 0 1-.354-.146L6.146 2.94A1.5 1.5 0 0 0 5.086 2.5H1.5z"},null,-1)])])):ie.isDir?(o(),v("svg",on,[...c[15]||(c[15]=[n("path",{d:"M.54 3.87.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.826a2 2 0 0 1-1.991-1.819l-.637-7a2 2 0 0 1 .342-1.31z"},null,-1)])])):(o(),v("svg",{key:2,class:be(["icon-file",F(ie.name)]),viewBox:"0 0 16 16"},[...c[16]||(c[16]=[n("path",{"fill-rule":"evenodd",d:"M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3z"},null,-1)])],2))]),ee.value===ie.path?Xe((o(),v("input",{key:0,"onUpdate:modelValue":c[1]||(c[1]=P=>ve.value=P),class:"tree-rename-input",onKeyup:[nl(P=>Ve(ie),["enter"]),c[2]||(c[2]=nl(P=>ee.value="",["escape"]))],onBlur:P=>Ve(ie),onClick:c[3]||(c[3]=al(()=>{},["stop"])),ref_key:"renameInputRef",ref:I},null,40,un)),[[Il,ve.value]]):(o(),v("span",dn,p(ie.name),1)),n("span",{class:"tree-node-actions",onClick:c[4]||(c[4]=al(()=>{},["stop"]))},[n("button",{class:"tree-act-btn",title:"ÈáçÂëΩÂêç",onClick:P=>Ze(ie)},[...c[17]||(c[17]=[n("svg",{viewBox:"0 0 16 16",width:"11",height:"11"},[n("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"})],-1)])],8,rn),n("button",{class:"tree-act-btn danger",title:"Âà†Èô§",onClick:P=>G(ie)},[...c[18]||(c[18]=[n("svg",{viewBox:"0 0 16 16",width:"11",height:"11"},[n("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),n("path",{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})],-1)])],8,cn)])],2)]),_:1},8,["data"])):(o(),v("div",an,"Â∑•‰ΩúÂå∫‰∏∫Á©∫"))]),(o(),C(rt,{to:"body"},[D.value.visible?(o(),v("div",{key:0,class:"ctx-menu",style:_e({left:D.value.x+"px",top:D.value.y+"px"}),onMouseleave:c[5]||(c[5]=S=>D.value.visible=!1)},[n("div",{class:"ctx-item",onClick:hl},"üìÑ Êñ∞Âª∫Êñá‰ª∂"),n("div",{class:"ctx-item",onClick:g},"üìÅ Êñ∞Âª∫Êñá‰ª∂Â§π"),D.value.node&&!D.value.node.isDir?(o(),v("div",{key:0,class:"ctx-item",onClick:u},"‚úé ÈáçÂëΩÂêç")):V("",!0),c[19]||(c[19]=n("div",{class:"ctx-divider"},null,-1)),n("div",{class:"ctx-item danger",onClick:U},"‚úï Âà†Èô§")],36)):V("",!0)]))],4),n("div",{class:be(["wc-handle",{dragging:sl.value}]),onMousedown:Je},[...c[20]||(c[20]=[n("div",{class:"wc-handle-bar"},null,-1)])],34),n("div",{class:"wc-panel wc-panel-mid",style:_e({width:Z.value+"px"})},[n("div",vn,[$.value?(o(),v("span",fn,[n("span",pn,p(De($.value)),1),n("span",{class:"file-path-text",title:$.value},p($.value),9,mn)])):(o(),v("span",yn,"ÈÄâÊã©Êñá‰ª∂Êü•Áúã")),n("div",gn,[te.value?(o(),C(ul,{key:0,size:"small",type:"warning",style:{"margin-right":"4px"}},{default:t(()=>[...c[21]||(c[21]=[i("Êú™‰øùÂ≠ò",-1)])]),_:1})):V("",!0),$.value&&te.value?(o(),v("button",{key:1,class:"wc-save-btn",onClick:je},"‰øùÂ≠ò")):V("",!0),$.value?(o(),v("button",{key:2,class:"wc-icon-btn",title:"Âà∑Êñ∞",onClick:ol},"‚Ü∫")):V("",!0),$.value?(o(),v("button",{key:3,class:"wc-icon-btn danger",title:"Âà†Èô§Êñá‰ª∂",onClick:bl},"‚úï")):V("",!0)])]),n("div",_n,[$.value?xe.value?(o(),v("div",bn,"‚õî ‰∫åËøõÂà∂Êñá‰ª∂ÔºåÊó†Ê≥ïÁºñËæë")):(o(),v(j,{key:2},[n("div",hn,[n("div",{class:"line-numbers",ref_key:"lineNumRef",ref:q},[(o(!0),v(j,null,re(el.value,S=>(o(),v("div",{key:S,class:"line-num"},p(S),1))),128))],512),Xe(n("textarea",{ref_key:"editorRef",ref:se,"onUpdate:modelValue":c[6]||(c[6]=S=>le.value=S),class:"code-editor",spellcheck:"false",autocorrect:"off",autocapitalize:"off",onInput:c[7]||(c[7]=S=>{te.value=!0,Ue()}),onScroll:Ue,onKeydown:[nl(al(ll,["prevent"]),["tab"]),nl(al(je,["ctrl","prevent"]),["s"]),nl(al(je,["meta","prevent"]),["s"])]},null,40,kn),[[Il,le.value]])]),n("div",xn,[n("span",Cn,p(De($.value)),1),n("span",null,p(el.value)+" Ë°å",1),n("span",null,p(le.value.length)+" Â≠óÁ¨¶",1),Se.value?(o(),v("span",$n,p(tl(Se.value.size)),1)):V("",!0),c[23]||(c[23]=n("span",{class:"stat-flex"},null,-1)),te.value?(o(),v("span",zn,"‚óè Êú™‰øùÂ≠ò")):(o(),v("span",Vn,"‚úì Â∑≤‰øùÂ≠ò"))])],64)):(o(),v("div",wn,[...c[22]||(c[22]=[n("div",{class:"wc-empty-icon"},"‚úèÔ∏è",-1),n("div",null,"‰ªéÂ∑¶‰æßÈÄâÊã©Êñá‰ª∂",-1),n("div",{class:"wc-empty-hint"},"ÊîØÊåÅÊãñÊãΩÊñá‰ª∂Âà∞Âè≥‰æßËÅäÂ§©Ê°Ü",-1)])]))])],4),n("div",{class:be(["wc-handle",{dragging:Le.value}]),onMousedown:oe},[...c[24]||(c[24]=[n("div",{class:"wc-handle-bar"},null,-1)])],34),n("div",Tn,[n("div",Sn,[n("div",In,[e(ne,{style:{color:"#64748b","font-size":"13px"}},{default:t(()=>[e(W(Zt))]),_:1}),e(w,{modelValue:J.value,"onUpdate:modelValue":c[8]||(c[8]=S=>J.value=S),placeholder:"Êñ∞ÂØπËØù",size:"small",clearable:"",class:"session-select",onChange:Y},{default:t(()=>[(o(!0),v(j,null,re(Ke.value,S=>(o(),C(rl,{key:S.id,value:S.id,label:S.title||"ÂØπËØù "+S.id.slice(0,8)},{default:t(()=>[n("div",Ln,[n("span",An,p(S.title||"Êó†Ê†áÈ¢ò"),1),n("span",Mn,p(Fe(S.lastAt)),1)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),n("button",{class:"session-new-btn",title:"Êñ∞Âª∫ÂØπËØù",onClick:L},"Ôºã Êñ∞ÂØπËØù")]),n("div",Un,[e(Gl,{"agent-id":wl.agentId,"session-id":J.value||void 0,context:Oe.value,height:"100%",ref_key:"chatRef",ref:T,onResponse:Me,onSessionChange:H},null,8,["agent-id","session-id","context"])])]),(o(),C(rt,{to:"body"},[ce.value?(o(),v("div",{key:0,class:"wc-modal-mask",onClick:c[11]||(c[11]=al(S=>ce.value=!1,["self"]))},[n("div",Dn,[c[25]||(c[25]=n("div",{class:"wc-modal-title"},"Êñ∞Âª∫Êñá‰ª∂",-1)),Xe(n("input",{"onUpdate:modelValue":c[9]||(c[9]=S=>pe.value=S),class:"wc-modal-input",placeholder:"Â¶Ç notes.md Êàñ scripts/run.sh",onKeyup:nl(il,["enter"]),ref_key:"newFileInput",ref:_},null,544),[[Il,pe.value]]),n("div",Fn,[n("button",{class:"wc-btn",onClick:c[10]||(c[10]=S=>ce.value=!1)},"ÂèñÊ∂à"),n("button",{class:"wc-btn primary",onClick:il},"ÂàõÂª∫")])])])):V("",!0)]))])}}}),Rn=Ql(En,[["__scopeId","data-v-945cea34"]]),Pn={class:"header-left"},Kn={class:"detail-title-block"},Wn={class:"detail-title"},jn={class:"chat-layout"},On={width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",style:{"flex-shrink":"0"}},Hn={class:"session-count-badge"},Yn={class:"session-sidebar-header"},Xn={class:"session-list"},qn=["onClick"],Jn={class:"session-item-header"},Gn={class:"session-item-time"},Qn={class:"session-item-title"},Zn={class:"session-item-meta"},es={key:0,class:"session-empty"},ls={class:"at-panel"},ts={key:0,class:"at-form"},as={class:"chat-area"},ns={style:{height:"100%"}},ss={key:0,class:"history-viewer"},os={key:0,class:"source-banner"},is={key:0},us={key:1},ds={class:"history-msg-list"},rs={class:"msg-avatar"},cs={class:"msg-body"},vs={class:"msg-meta"},fs={class:"msg-role"},ps={class:"msg-time"},ms={class:"msg-text",style:{background:"#f4f4f5","border-radius":"8px",padding:"8px 12px","font-size":"13px","line-height":"1.6","word-break":"break-word","white-space":"pre-wrap"}},ys={style:{display:"flex","flex-direction":"column",gap:"8px"}},gs={style:{display:"flex","align-items":"center",gap:"10px"}},_s={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},ws={style:{display:"flex","align-items":"center",gap:"6px"}},bs={style:{color:"#bbb","font-size":"12px"}},hs={style:{display:"flex","align-items":"center",gap:"8px"}},ks={style:{"font-weight":"600"}},xs={key:0,style:{"text-align":"center",color:"#c0c4cc",padding:"32px 0","font-size":"14px"}},Cs={style:{display:"flex","align-items":"center",gap:"8px"}},$s={style:{"font-size":"13px"}},zs={style:{"font-size":"13px",color:"#606266"}},Vs={key:0,style:{"text-align":"center",color:"#c0c4cc",padding:"40px 0"}},Ts={key:1,class:"relations-list"},Ss={class:"relation-info"},Is={class:"relation-name"},Ls={class:"relation-tags"},As={class:"relation-desc"},Ms={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Us={style:{display:"flex",gap:"8px","margin-top":"4px"}},Ds={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Fs={key:0,style:{"text-align":"center",color:"#c0c4cc",padding:"16px 0","font-size":"13px"}},Ns={style:{"font-size":"12px"}},Bs={style:{"font-size":"12px",color:"#606266"}},Es={class:"memory-toolbar",style:{"margin-bottom":"12px",display:"flex",gap:"8px"}},Rs={style:{display:"flex","align-items":"center",gap:"4px","font-size":"13px"}},Ps={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Ks={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"16px"}},Ws={class:"channel-card-header"},js={class:"channel-card-left"},Os={class:"channel-card-name"},Hs={key:0,class:"channel-bot-username"},Ys={class:"channel-card-actions"},Xs={key:0,class:"channel-card-body"},qs={class:"channel-info-row"},Js={class:"channel-info-value"},Gs={class:"channel-info-row"},Qs={class:"channel-info-value"},Zs={key:1,class:"channel-card-body"},eo={class:"channel-info-row"},lo={class:"channel-info-value"},to={style:{opacity:"0.6","font-size":"11px","margin-left":"3px"}},ao={class:"pending-section"},no=["onClick"],so={key:0,class:"pending-list"},oo={key:0,style:{"text-align":"center",padding:"12px"}},io={class:"pending-user-info"},uo={class:"pending-user-name"},ro={key:0,class:"pending-user-username"},co={class:"pending-user-id"},vo={class:"pending-user-actions"},fo={key:2,class:"pending-empty"},po={style:{width:"100%"}},mo={style:{display:"flex",gap:"6px","align-items":"center"}},yo={key:0,style:{"margin-top":"6px",display:"flex","align-items":"center",gap:"6px",color:"#909399","font-size":"13px"}},go={key:1,style:{"margin-top":"6px",color:"#67c23a","font-size":"13px"}},_o={key:2,style:{"margin-top":"6px",color:"#e6a23c","font-size":"13px"}},wo={key:3,style:{"margin-top":"6px",color:"#f56c6c","font-size":"13px"}},bo={key:4,style:{"margin-top":"4px"}},ho={class:"channel-url-preview"},ko={class:"channel-url-text"},xo={class:"channel-url-preview"},Co={class:"channel-url-text"},$o={style:{padding:"20px","max-width":"800px"}},zo={class:"env-add-row",style:{display:"flex",gap:"8px","margin-bottom":"16px","align-items":"flex-start"}},Vo={style:{"font-size":"13px"}},To=ql({__name:"AgentDetailView",setup(wl){const Ce=la(),y=Ce.params.id,O=d(null),Re=d("chat"),he=d(!1),Z=d(),Pe=d([]),se=d([]),q=d(null),_=d(null),I=d([]),T=d(!1),R=d(!1),ke=d();async function $(){R.value=!0;try{const[s,l]=await Promise.all([yt.list({agentId:y,limit:50}),ct.list(y).catch(()=>({data:[]}))]),f=(s.data.sessions||[]).filter(k=>!k.id.startsWith("subagent-")&&!k.id.startsWith("goal-")&&!k.id.startsWith("__")).map(k=>({id:k.id,type:"panel",label:k.title||"Êñ∞ÂØπËØù",messageCount:k.messageCount,lastAt:typeof k.lastAt=="string"?new Date(k.lastAt).getTime():k.lastAt||0,tokenEstimate:k.tokenEstimate,_panel:k})),A=(l.data||[]).map(k=>({id:k.channelId,type:"channel",channelType:k.channelType,label:k.channelId,messageCount:k.messageCount,lastAt:typeof k.lastAt=="string"?new Date(k.lastAt).getTime():k.lastAt||0,_channel:k}));se.value=[...f,...A].sort((k,ye)=>ye.lastAt-k.lastAt),Pe.value=s.data.sessions||[]}catch{}finally{R.value=!1}}function le(s){return q.value?q.value.type===s.type&&q.value.id===s.id:!1}async function te(s){if(q.value=s,s.type==="panel")_.value="chat",ke.value=s.id,await new Promise(l=>setTimeout(l,50)),Z.value?.resumeSession(s.id);else{_.value="history",I.value=[],T.value=!0;try{const l=await ct.messages(y,s.id,{limit:100,offset:0});I.value=l.data.messages||[]}catch{}finally{T.value=!1}}}function xe(){q.value=null,_.value=null,ke.value=void 0,Z.value?.startNewSession()}function Se(s){ke.value=s,localStorage.setItem(`zyhive_session_${y}`,s),setTimeout($,500)}function ce(s){return s?(typeof s=="string"?new Date(s):new Date(s)).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}function pe(s){if(!s)return"";const l=Date.now()-s;return l<6e4?"ÂàöÂàö":l<36e5?`${Math.floor(l/6e4)}ÂàÜÂâç`:l<864e5?`${Math.floor(l/36e5)}Â∞èÊó∂Ââç`:`${Math.floor(l/864e5)}Â§©Ââç`}const ee=d(!1),ve=d(""),D=d(""),Ke=d(!1),J=d([]);function Ie(){ee.value=!ee.value,ee.value&&!J.value.length&&qe()}async function qe(){try{const s=await zl.list();J.value=s.data.filter(l=>l.id!==y)}catch{J.value=[]}}function $e(s){const l=J.value.find(f=>f.id===s);l&&Z.value?.fillInput(`@${l.name}: `)}async function sl(){const s=ve.value,l=D.value.trim();if(!s||!l)return;const A=J.value.find(ye=>ye.id===s)?.name??s;Ke.value=!0;const k={role:"user",text:`‚Üí ËΩ¨ÂèëÁªô ${A}Ôºö
${l}`};Z.value?.appendMessage(k);try{const N=(await zl.message(s,l,y)).data.response,Be={role:"assistant",text:`‚Üê **${A}** ÂõûÂ§çÔºö

${N}`};Z.value?.appendMessage(Be),D.value="",ve.value="",ee.value=!1,m.success(`${A} Â∑≤ÂõûÂ§ç`)}catch(ye){const N={role:"system",text:`[Â§±Ë¥•] ËΩ¨ÂèëÂ§±Ë¥•Ôºö${ye.response?.data?.error??ye.message??"ÁΩëÁªúÈîôËØØ"}`};Z.value?.appendMessage(N),m.error("ËΩ¨ÂèëÂ§±Ë¥•")}finally{Ke.value=!1}}const Le=d(""),Je=d(""),oe=d([]),Ge=d(!1),me=d(""),Ae=d(!1),we=_l(()=>{const s=oe.value.find(l=>l.id===me.value);return s?s.supportsTools===!1:!1}),fe=d([]),We=d(""),ze=d(""),Qe=d(!1);function ol(){const s=O.value?.env||{};fe.value=Object.entries(s).map(([l,f])=>({key:l,value:f}))}function je(){const s=We.value.trim();if(!s)return;const l=fe.value.findIndex(f=>f.key===s);l>=0?fe.value[l].value=ze.value:fe.value.push({key:s,value:ze.value}),We.value="",ze.value=""}function bl(s){fe.value.splice(s,1)}async function il(){Qe.value=!0;try{const s={};for(const{key:f,value:A}of fe.value)f.trim()&&(s[f.trim()]=A);const l=await zl.update(y,{env:s});O.value=l.data,m.success("ÁéØÂ¢ÉÂèòÈáèÂ∑≤‰øùÂ≠ò")}catch{m.error("‰øùÂ≠òÂ§±Ë¥•")}finally{Qe.value=!1}}const G=d({enabled:!1,schedule:"daily",keepTurns:3,focusHint:"",cronJobId:""}),Ze=d(!1),Ve=d(!1);async function hl(){try{const s=await Nl.getConfig(y);G.value=s.data,E()}catch{}}async function g(){Ze.value=!0;try{const s=await Nl.setConfig(y,G.value);G.value=s.data,m.success(G.value.enabled?"Ëá™Âä®ËÆ∞ÂøÜÂ∑≤ÂºÄÂêØ":"Ëá™Âä®ËÆ∞ÂøÜÂ∑≤ÂÖ≥Èó≠")}catch{m.error("‰øùÂ≠òÂ§±Ë¥•")}finally{Ze.value=!1}}async function u(){Ve.value=!0;try{await Nl.consolidate(y),m.success("ËÆ∞ÂøÜÊï¥ÁêÜÂ∑≤Âú®ÂêéÂè∞ÂêØÂä®ÔºàÁ∫¶ÈúÄ10~30ÁßíÔºâÔºåÁ®çÂêéËá™Âä®Âà∑Êñ∞Êó•Âøó"),setTimeout(E,1e4)}catch{m.error("Êï¥ÁêÜÂ§±Ë¥•")}finally{Ve.value=!1}}const U=d([]),z=d(!1);async function E(){z.value=!0;try{const s=await Nl.runLog(y);U.value=s.data||[]}catch{U.value=[]}finally{z.value=!1}}const Y=d([]),L=d(""),H=d(""),Me=d(!1),el=d([]),Oe=d(!1),ll=d(""),Ue=d(!1),De=d(""),ae=d([]),tl=d(!1),F=d({agentId:"",agentName:"",relationType:"Âπ≥Á∫ßÂçè‰Ωú",strength:"Â∏∏Áî®",desc:""});async function Fe(){try{const s=await vt.get(y);ae.value=s.data.parsed||[]}catch{ae.value=[]}}function r(s){const l=J.value.find(f=>f.id===s);F.value.agentName=l?l.name:s}async function c(){if(!F.value.agentId)return;if(ae.value.find(l=>l.agentId===F.value.agentId)){m.warning("ËØ•ÊàêÂëòÂÖ≥Á≥ªÂ∑≤Â≠òÂú®ÔºåËØ∑ÂÖàÂà†Èô§ÂÜçÈáçÊñ∞Ê∑ªÂä†");return}ae.value.push({...F.value}),F.value={agentId:"",agentName:"",relationType:"Âπ≥Á∫ßÂçè‰Ωú",strength:"Â∏∏Áî®",desc:""},await dl()}async function M(s){ae.value.splice(s,1),await dl()}function ne(){if(ae.value.length===0)return"";const s=`| ÊàêÂëòID | ÊàêÂëòÂêçÁß∞ | ÂÖ≥Á≥ªÁ±ªÂûã | ÂÖ≥Á≥ªÁ®ãÂ∫¶ | ËØ¥Êòé |
|--------|--------|--------|--------|------|`,l=ae.value.map(f=>`| ${f.agentId} | ${f.agentName} | ${f.relationType} | ${f.strength} | ${f.desc||""} |`).join(`
`);return s+`
`+l}async function dl(){tl.value=!0;try{await vt.put(y,ne()),m.success("ÂÖ≥Á≥ªÂ∑≤‰øùÂ≠ò")}catch{m.error("‰øùÂ≠òÂ§±Ë¥•")}finally{tl.value=!1}}function ul(s){const l=["#409EFF","#67C23A","#E6A23C","#F56C6C","#909399","#B45309","#7C3AED","#0891B2"];let f=0;for(let A=0;A<s.length;A++)f=s.charCodeAt(A)+((f<<5)-f);return l[Math.abs(f)%l.length]??"#409EFF"}function rl(s){return s==="‰∏äÁ∫ß"?"danger":s==="‰∏ãÁ∫ß"?"":s==="Âπ≥Á∫ßÂçè‰Ωú"?"success":"info"}function w(s){return s==="Ê†∏ÂøÉ"?"danger":s==="Â∏∏Áî®"?"warning":"info"}const S=d([]),ie=d(!1),P=d({name:"",expr:"0 9 * * *",tz:"Asia/Shanghai",message:"",enabled:!0});function gt(s){return s==="running"?"success":s==="stopped"?"danger":"info"}function _t(s){return s==="running"?"ËøêË°å‰∏≠":s==="stopped"?"Â∑≤ÂÅúÊ≠¢":"Á©∫Èó≤"}function wt(s){return s?s<1024?s+" B":s<1048576?(s/1024).toFixed(1)+" KB":(s/1048576).toFixed(1)+" MB":"0 B"}function Zl(s){return s?new Date(s).toLocaleString():""}const He=d([]),Rl=d(!1),cl=d(!1),Ne=d(""),Ll=d(""),Pl=d(!1),Kl=d(""),h=d({type:"telegram",name:"",enabled:!0,botToken:"",allowedFrom:"",webPassword:"",webWelcome:"",webTitle:""}),K=d({loading:!1,status:""});let Wl=null;function jl(s){return/^\*+$/.test(s)}async function et(){const s=h.value.botToken;if(!(!s||jl(s))){K.value={loading:!0,status:""};try{const f=(await Te.checkToken(y,s)).data;f.duplicate?K.value={loading:!1,status:"duplicate",usedBy:f.usedBy,usedByCh:f.usedByCh}:f.valid?(K.value={loading:!1,status:"ok",botName:f.botName},!h.value.name&&f.botName&&(h.value.name=f.botName)):K.value={loading:!1,status:"error",error:f.error||"Token Êó†Êïà"}}catch{K.value={loading:!1,status:"error",error:"ÁΩëÁªúÈîôËØØÔºåËØ∑ÈáçËØï"}}}}El(()=>h.value.type,s=>{Ne.value||(Ll.value=Ol(s))}),El(()=>h.value.botToken,s=>{K.value={loading:!1,status:""},Wl&&clearTimeout(Wl),!(!s||jl(s)||s.length<20||!s.includes(":"))&&(Wl=setTimeout(et,800))});function vl(s,l){return l?`${window.location.origin}/chat/${s}/${l}`:`${window.location.origin}/chat/${s}`}function lt(s){navigator.clipboard.writeText(s).then(()=>m.success("ÈìæÊé•Â∑≤Â§çÂà∂"))}async function fl(){Rl.value=!0;try{const s=await Te.list(y);He.value=s.data||[]}catch{He.value=[]}finally{Rl.value=!1}}function Ol(s){return s+"-"+Date.now().toString(36)}function bt(){Ne.value="";const s=O.value?.name||"";Ll.value=Ol("telegram"),h.value={type:"telegram",name:s,enabled:!0,botToken:"",allowedFrom:"",webPassword:"",webWelcome:"",webTitle:""},K.value={loading:!1,status:""},cl.value=!0}function ht(s){Ne.value=s.id,h.value={type:s.type,name:s.name,enabled:s.enabled,botToken:s.config?.botToken||"",allowedFrom:s.config?.allowedFrom||"",webPassword:"",webWelcome:s.config?.welcomeMsg||"",webTitle:s.config?.title||""},K.value={loading:!1,status:""},cl.value=!0}async function kt(){if(!h.value.name||!h.value.type){m.warning("ËØ∑Â°´ÂÜôÂêçÁß∞ÂíåÁ±ªÂûã");return}if(K.value.status==="duplicate"){m.error(`Bot Token Â∑≤Ë¢´ÊàêÂëò„Äå${K.value.usedBy}„Äç‰ΩøÁî®ÔºåËØ∑Êõ¥Êç¢`);return}Pl.value=!0;try{const s={};if(h.value.type==="telegram"?(h.value.botToken&&(s.botToken=h.value.botToken),h.value.allowedFrom&&(s.allowedFrom=h.value.allowedFrom)):h.value.type==="web"&&(h.value.webPassword&&(s.password=h.value.webPassword),h.value.webWelcome&&(s.welcomeMsg=h.value.webWelcome),h.value.webTitle&&(s.title=h.value.webTitle)),Ne.value){const l=He.value.map(f=>f.id!==Ne.value?f:{...f,name:h.value.name,type:h.value.type,enabled:h.value.enabled,config:{...f.config,...s}});await Te.set(y,l)}else{const l={id:Ll.value||Ol(h.value.type),name:h.value.name,type:h.value.type,enabled:h.value.enabled,config:s,status:"untested"};await Te.set(y,[...He.value,l])}m.success(h.value.type==="web"?"‰øùÂ≠òÊàêÂäüÔºåWeb ËÅäÂ§©È°µÁ´ãÂç≥ÁîüÊïà":"‰øùÂ≠òÊàêÂäüÔºåÈáçÂêØÂêéÊñ∞Ê∏†ÈÅìÁîüÊïà"),cl.value=!1,await fl()}catch(s){m.error(s.response?.data?.error||"‰øùÂ≠òÂ§±Ë¥•")}finally{Pl.value=!1}}async function xt(){try{await Te.set(y,He.value)}catch(s){m.error(s.response?.data?.error||"‰øùÂ≠òÂ§±Ë¥•"),await fl()}}async function Ct(s){const l=He.value.filter(f=>f.id!==s.id);try{await Te.set(y,l),He.value=l,m.success("Â∑≤Âà†Èô§")}catch{m.error("Âà†Èô§Â§±Ë¥•")}}async function $t(s){Kl.value=s.id;try{const l=await Te.test(y,s.id);l.data.valid?m.success(l.data.botName?`ÊµãËØïÊàêÂäü (@${l.data.botName})`:"ÊµãËØïÊàêÂäü"):m.error(l.data.error||"ÊµãËØïÂ§±Ë¥•"),await fl()}catch{m.error("ÊµãËØïËØ∑Ê±ÇÂ§±Ë¥•")}finally{Kl.value=""}}const pl=d({}),Hl=d({}),kl=d(""),Yl=d("");async function Al(s){Hl.value[s]=!0;try{const l=await Te.listPending(y,s);pl.value[s]=l.data||[]}catch{pl.value[s]=[]}finally{Hl.value[s]=!1}}function zt(s){kl.value===s?kl.value="":(kl.value=s,Al(s))}async function Vt(s,l){Yl.value=`${s}-${l}`;try{await Te.allowUser(y,s,l),m.success(`Áî®Êà∑ ${l} Â∑≤Âä†ÂÖ•ÁôΩÂêçÂçï`),await Al(s),await fl()}catch{m.error("Êìç‰ΩúÂ§±Ë¥•")}finally{Yl.value=""}}async function Tt(s,l){try{await Te.dismissUser(y,s,l),m.success("Â∑≤ÂøΩÁï•"),await Al(s)}catch{m.error("Êìç‰ΩúÂ§±Ë¥•")}}async function tt(s,l){try{await Sl.confirm(`Á°ÆÂÆöÂ∞ÜÁî®Êà∑ ${l} ‰ªéÁôΩÂêçÂçï‰∏≠ÁßªÈô§ÔºüÁßªÈô§ÂêéËØ•Áî®Êà∑Â∞ÜÊó†Ê≥ï‰ΩøÁî®Ê≠§ Bot„ÄÇ`,"ÁßªÈô§ÁôΩÂêçÂçï",{confirmButtonText:"Á°ÆËÆ§ÁßªÈô§",cancelButtonText:"ÂèñÊ∂à",type:"warning"})}catch{return}try{await Te.removeAllowed(y,s,l),m.success(`Áî®Êà∑ ${l} Â∑≤‰ªéÁôΩÂêçÂçïÁßªÈô§`),await fl()}catch{m.error("Êìç‰ΩúÂ§±Ë¥•")}}Jl(async()=>{try{const k=await zl.get(y);O.value=k.data}catch{m.error("Âä†ËΩΩ Agent Â§±Ë¥•")}St(),It(),Fe(),qe(),hl(),Ml(),fl(),ol(),await $();const s=Ce.query.tab;s&&(Re.value=s);const l=Ce.query.resumeSession,f=l?null:localStorage.getItem(`zyhive_session_${y}`),A=l||f||null;if(A){const k=se.value.find(ye=>ye.type==="panel"&&ye.id===A);k?await te(k):(ke.value=A,_.value="chat",await new Promise(ye=>setTimeout(ye,100)),Z.value?.resumeSession(A))}});async function St(){try{const[s,l]=await Promise.all([Q.read(y,"IDENTITY.md"),Q.read(y,"SOUL.md")]);Le.value=s.data?.content||"",Je.value=l.data?.content||""}catch{}xl()}async function at(s,l){try{await Q.write(y,s,l),m.success(`${s} Â∑≤‰øùÂ≠ò`)}catch{m.error(`‰øùÂ≠ò ${s} Â§±Ë¥•`)}}async function It(){try{const s=await ea.list();if(oe.value=s.data||[],O.value?.modelId)me.value=O.value.modelId;else{const l=oe.value.find(f=>f.provider+"/"+f.model===O.value?.model||f.id===O.value?.model);me.value=l?.id||""}}catch{oe.value=[]}finally{Ge.value=!0}}async function Lt(){if(me.value){Ae.value=!0;try{const s=await zl.update(y,{modelId:me.value});O.value=s.data,m.success("Ê®°ÂûãÂ∑≤Êõ¥Êñ∞")}catch{m.error("Êõ¥Êñ∞Â§±Ë¥•")}finally{Ae.value=!1}}}async function xl(){try{const s=await Vl.tree(y);Y.value=s.data||[]}catch{Y.value=[]}}async function At(s){if(!s.isDir){L.value=s.path,el.value=s.path.split("/");try{const l=await Vl.readFile(y,s.path);H.value=l.data?.content||""}catch{H.value="(Êó†Ê≥ïËØªÂèñ)"}}}async function Mt(){if(L.value){Me.value=!0;try{await Vl.writeFile(y,L.value,H.value),m.success("ËÆ∞ÂøÜÊñá‰ª∂Â∑≤‰øùÂ≠ò"),xl()}catch{m.error("‰øùÂ≠òÂ§±Ë¥•")}finally{Me.value=!1}}}async function Ut(){const s=ll.value.trim();if(!s){m.warning("ËØ∑ËæìÂÖ•Ë∑ØÂæÑ");return}try{await Vl.writeFile(y,s,`# ${s.split("/").pop()?.replace(".md","")||"New File"}

`),m.success("Êñá‰ª∂Â∑≤ÂàõÂª∫"),Oe.value=!1,ll.value="",xl(),L.value=s,el.value=s.split("/"),H.value=`# ${s.split("/").pop()?.replace(".md","")||"New File"}

`}catch{m.error("ÂàõÂª∫Â§±Ë¥•")}}async function Dt(){const s=De.value.trim();if(!s){m.warning("ËØ∑ËæìÂÖ•ÂÜÖÂÆπ");return}try{await Vl.dailyLog(y,s),m.success("Êó•ÂøóÂ∑≤Ê∑ªÂä†"),Ue.value=!1,De.value="",xl()}catch{m.error("Ê∑ªÂä†Â§±Ë¥•")}}async function Ml(){try{const s=await Tl.list(y);S.value=s.data||[]}catch{}}async function Ft(){try{await Tl.create({name:P.value.name,enabled:P.value.enabled,agentId:y,schedule:{kind:"cron",expr:P.value.expr,tz:P.value.tz},payload:{kind:"agentTurn",message:P.value.message},delivery:{mode:"announce"}}),m.success("‰ªªÂä°ÂàõÂª∫ÊàêÂäü"),ie.value=!1,Ml()}catch(s){m.error(s.response?.data?.error||"ÂàõÂª∫Â§±Ë¥•")}}async function Nt(s){try{await Tl.update(s.id,s)}catch{m.error("Êõ¥Êñ∞Â§±Ë¥•")}}async function nt(s){try{await Tl.run(s.id),m.success("Â∑≤Ëß¶ÂèëËøêË°å"),setTimeout(Ml,2e3)}catch{m.error("ËøêË°åÂ§±Ë¥•")}}async function Bt(s){try{await Tl.delete(s.id),m.success("Â∑≤Âà†Èô§"),Ml()}catch{m.error("Âà†Èô§Â§±Ë¥•")}}return(s,l)=>{const f=b("el-button"),A=b("el-text"),k=b("el-tag"),ye=b("el-header"),N=b("el-option"),Be=b("el-select"),X=b("el-input"),Et=b("el-avatar"),Ul=b("el-empty"),Ye=b("el-tab-pane"),Rt=b("el-alert"),B=b("el-form-item"),ml=b("el-form"),Ee=b("el-card"),ge=b("el-col"),yl=b("el-row"),st=b("el-badge"),ue=b("el-table-column"),Dl=b("el-table"),Cl=b("el-switch"),Pt=b("el-input-number"),de=b("el-icon"),Kt=b("el-tree"),ot=b("el-breadcrumb-item"),Wt=b("el-breadcrumb"),Fl=b("el-dialog"),jt=b("el-link"),Ot=b("CircleCheck"),Ht=b("Warning"),Yt=b("CircleClose"),it=b("InfoFilled"),ut=b("Link"),Xt=b("el-tabs"),qt=b("el-main"),Jt=b("el-container"),dt=ia("loading");return o(),C(Jt,{class:"agent-detail"},{default:t(()=>[e(ye,{class:"detail-header"},{default:t(()=>[n("div",Pn,[e(f,{icon:W(ta),onClick:l[0]||(l[0]=a=>s.$router.push("/agents")),circle:"",size:"small"},null,8,["icon"]),n("div",Kn,[n("h2",Wn,p(O.value?.name||"..."),1),e(A,{type:"info",class:"detail-model-mobile"},{default:t(()=>[i(p(O.value?.model),1)]),_:1})]),e(k,{type:gt(O.value?.status),size:"small"},{default:t(()=>[i(p(_t(O.value?.status)),1)]),_:1},8,["type"])]),e(A,{type:"info",class:"detail-model-desktop"},{default:t(()=>[i(p(O.value?.model),1)]),_:1})]),_:1}),e(qt,null,{default:t(()=>[e(Xt,{modelValue:Re.value,"onUpdate:modelValue":l[47]||(l[47]=a=>Re.value=a),type:"border-card"},{default:t(()=>[e(Ye,{label:"ÂØπËØù",name:"chat"},{default:t(()=>[n("div",jn,[n("button",{class:"mobile-session-toggle",onClick:l[1]||(l[1]=a=>he.value=!he.value)},[(o(),v("svg",On,[...l[48]||(l[48]=[n("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"},null,-1)])])),l[50]||(l[50]=i(" ÂéÜÂè≤ÂØπËØù ",-1)),n("span",Hn,p(Pe.value.length),1),(o(),v("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",style:_e([{"margin-left":"auto"},{transform:he.value?"rotate(180deg)":""}])},[...l[49]||(l[49]=[n("path",{d:"M7 10l5 5 5-5z"},null,-1)])],4))]),n("div",{class:be(["session-sidebar",{"mobile-session-open":he.value}])},[n("div",Yn,[l[52]||(l[52]=n("span",{class:"sidebar-title"},"ÊâÄÊúâÂØπËØù",-1)),e(f,{size:"small",type:"primary",plain:"",onClick:xe,icon:W(Bl)},{default:t(()=>[...l[51]||(l[51]=[i("Êñ∞Âª∫",-1)])]),_:1},8,["icon"])]),Xe((o(),v("div",Xn,[(o(!0),v(j,null,re(se.value,a=>(o(),v("div",{key:a.type+":"+a.id,class:be(["session-item",{active:le(a)}]),onClick:x=>te(a)},[n("div",Jn,[a.channelType==="telegram"?(o(),C(k,{key:0,type:"success",size:"small",effect:"plain",class:"session-source-tag"},{default:t(()=>[...l[53]||(l[53]=[i("TG",-1)])]),_:1})):a.type==="channel"?(o(),C(k,{key:1,type:"warning",size:"small",effect:"plain",class:"session-source-tag"},{default:t(()=>[...l[54]||(l[54]=[i("WebÊ∏†ÈÅì",-1)])]),_:1})):(o(),C(k,{key:2,type:"primary",size:"small",effect:"plain",class:"session-source-tag"},{default:t(()=>[...l[55]||(l[55]=[i("Èù¢Êùø",-1)])]),_:1})),n("span",Gn,p(pe(a.lastAt)),1)]),n("div",Qn,p(a.label),1),n("div",Zn,[n("span",null,p(a.messageCount)+" Êù°",1),a.tokenEstimate&&a.tokenEstimate>6e4?(o(),C(k,{key:0,size:"small",type:"warning",effect:"plain",style:{"font-size":"10px",padding:"0 4px"}},{default:t(()=>[i(" ~"+p(Math.round(a.tokenEstimate/1e3))+"k",1)]),_:2},1024)):V("",!0)])],10,qn))),128)),!R.value&&!se.value.length?(o(),v("div",es," ËøòÊ≤°ÊúâÂØπËØùËÆ∞ÂΩï ")):V("",!0)])),[[dt,R.value]]),n("div",ls,[e(f,{size:"small",plain:"",class:"at-toggle-btn",onClick:Ie},{default:t(()=>[...l[56]||(l[56]=[n("span",{class:"at-icon"},"@",-1),i(" ÂÖ∂‰ªñÊàêÂëò ",-1)])]),_:1}),ee.value?(o(),v("div",ts,[e(Be,{modelValue:ve.value,"onUpdate:modelValue":l[2]||(l[2]=a=>ve.value=a),placeholder:"ÈÄâÊã©ÊàêÂëò",size:"small",style:{width:"100%","margin-bottom":"6px"},onChange:$e},{default:t(()=>[(o(!0),v(j,null,re(J.value,a=>(o(),C(N,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(X,{modelValue:D.value,"onUpdate:modelValue":l[3]||(l[3]=a=>D.value=a),type:"textarea",rows:3,placeholder:"ËæìÂÖ•Ë¶ÅËΩ¨ÂèëÁöÑÊ∂àÊÅØ‚Ä¶",size:"small",style:{"margin-bottom":"6px"}},null,8,["modelValue"]),e(f,{type:"primary",size:"small",style:{width:"100%"},loading:Ke.value,disabled:!ve.value||!D.value.trim(),onClick:sl},{default:t(()=>[...l[57]||(l[57]=[i(" ËΩ¨Âèë ",-1)])]),_:1},8,["loading","disabled"])])):V("",!0)])],2),n("div",as,[Xe(n("div",ns,[e(Gl,{ref_key:"aiChatRef",ref:Z,"agent-id":W(y),scenario:"agent-detail","welcome-message":`‰Ω†Â•ΩÔºÅÊàëÊòØ **${O.value?.name||"AI"}**ÔºåÊúâ‰ªÄ‰πàÂèØ‰ª•Â∏Æ‰Ω†ÁöÑÔºü`,height:"calc(100vh - 145px)","show-thinking":!0,"no-model":Ge.value&&oe.value.length===0,onSessionChange:Se},null,8,["agent-id","welcome-message","no-model"])],512),[[mt,_.value!=="history"]]),_.value==="history"?(o(),v("div",ss,[q.value?(o(),v("div",os,[q.value.channelType==="telegram"?(o(),v("span",is," Êù•Ëá™ Telegram ¬∑ "+p(q.value.id)+" ¬∑ Âè™ËØª ",1)):q.value.type==="channel"?(o(),v("span",us," Êù•Ëá™ÁΩëÈ°µÊ∏†ÈÅì ¬∑ "+p(q.value.id)+" ¬∑ Âè™ËØª ",1)):V("",!0)])):V("",!0),Xe((o(),v("div",ds,[(o(!0),v(j,null,re(I.value,(a,x)=>(o(),v("div",{key:x,class:be(["message-item",a.role==="user"?"msg-user":"msg-assistant"])},[n("div",rs,[e(Et,{size:28,style:_e({background:a.role==="user"?"#409eff":"#67c23a",fontSize:"12px"})},{default:t(()=>[i(p(a.role==="user"?"Áî®":"AI"),1)]),_:2},1032,["style"])]),n("div",cs,[n("div",vs,[n("span",fs,p(a.role==="user"?a.sender||"Áî®Êà∑":"AI"),1),n("span",ps,p(a.ts?ce(new Date(a.ts).getTime()):""),1)]),n("div",ms,p(a.content),1)])],2))),128)),!T.value&&!I.value.length?(o(),C(Ul,{key:0,description:"ÊöÇÊó†Ê∂àÊÅØËÆ∞ÂΩï"})):V("",!0)])),[[dt,T.value]])])):V("",!0)])])]),_:1}),e(Ye,{label:"Â∑•‰ΩúÂå∫",name:"workspace"},{default:t(()=>[e(Rn,{"agent-id":W(y),style:{height:"calc(100vh - 145px)"}},null,8,["agent-id"])]),_:1}),e(Ye,{label:"Ë∫´‰ªΩ & ÁÅµÈ≠Ç",name:"identity"},{default:t(()=>[e(Ee,{style:{"margin-bottom":"16px"}},{header:t(()=>[...l[58]||(l[58]=[n("span",{style:{"font-weight":"600"}},"Âü∫Êú¨ËÆæÁΩÆ",-1)])]),default:t(()=>[e(ml,{"label-width":"80px",size:"default"},{default:t(()=>[e(B,{label:"‰ΩøÁî®Ê®°Âûã"},{default:t(()=>[n("div",ys,[n("div",gs,[e(Be,{modelValue:me.value,"onUpdate:modelValue":l[4]||(l[4]=a=>me.value=a),placeholder:"ÈÄâÊã©Ê®°Âûã",style:{width:"300px"}},{default:t(()=>[(o(!0),v(j,null,re(oe.value,a=>(o(),C(N,{key:a.id,label:a.name||a.model,value:a.id},{default:t(()=>[n("div",_s,[n("span",{style:_e(a.supportsTools===!1?"color:#999":"")},p(a.name||a.model),5),n("div",ws,[a.supportsTools===!1?(o(),C(k,{key:0,size:"small",type:"warning",style:{"font-size":"10px",padding:"0 4px",height:"16px","line-height":"16px"}},{default:t(()=>[...l[59]||(l[59]=[i("Êó†Â∑•ÂÖ∑",-1)])]),_:1})):V("",!0),n("span",bs,p(a.provider),1)])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),e(f,{type:"primary",loading:Ae.value,onClick:Lt,disabled:!me.value},{default:t(()=>[...l[60]||(l[60]=[i("‰øùÂ≠ò",-1)])]),_:1},8,["loading","disabled"])]),we.value?(o(),C(Rt,{key:0,type:"warning",closable:!1,"show-icon":"",style:{padding:"6px 12px"}},{title:t(()=>[...l[61]||(l[61]=[n("span",{style:{"font-size":"13px"}},[i(" ÂΩìÂâçÊ®°Âûã "),n("b",null,"‰∏çÊîØÊåÅÂ∑•ÂÖ∑Ë∞ÉÁî®"),i("ÔºåÊñá‰ª∂ËØªÂÜô„ÄÅ‰ª£Á†ÅÊâßË°åÁ≠âÂäüËÉΩÂ∞ÜÊó†Ê≥ï‰ΩøÁî®„ÄÇÂ¶ÇÈúÄÂÆåÊï¥ËÉΩÂäõÔºåËØ∑ÂàáÊç¢Âà∞ÊîØÊåÅÂ∑•ÂÖ∑ÁöÑÊ®°Âûã„ÄÇ ")],-1)])]),_:1})):V("",!0)])]),_:1})]),_:1})]),_:1}),e(yl,{gutter:20},{default:t(()=>[e(ge,{xs:24,sm:12},{default:t(()=>[e(Ee,{header:"IDENTITY.md",style:{"margin-bottom":"16px"}},{default:t(()=>[e(X,{modelValue:Le.value,"onUpdate:modelValue":l[5]||(l[5]=a=>Le.value=a),type:"textarea",rows:15,onBlur:l[6]||(l[6]=a=>at("IDENTITY.md",Le.value))},null,8,["modelValue"])]),_:1})]),_:1}),e(ge,{xs:24,sm:12},{default:t(()=>[e(Ee,{header:"SOUL.md"},{default:t(()=>[e(X,{modelValue:Je.value,"onUpdate:modelValue":l[7]||(l[7]=a=>Je.value=a),type:"textarea",rows:15,onBlur:l[8]||(l[8]=a=>at("SOUL.md",Je.value))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ye,{label:"ÂÖ≥Á≥ª",name:"relations"},{default:t(()=>[e(yl,{gutter:20},{default:t(()=>[e(ge,{span:14},{default:t(()=>[e(Ee,{style:{"margin-bottom":"16px"}},{header:t(()=>[...l[62]||(l[62]=[n("span",{style:{"font-weight":"600"}},"Ê∑ªÂä†ÂÖ≥Á≥ª",-1)])]),default:t(()=>[e(ml,{model:F.value,"label-position":"top",size:"default"},{default:t(()=>[e(yl,{gutter:12},{default:t(()=>[e(ge,{span:10},{default:t(()=>[e(B,{label:"ÂÖ≥ËÅîÊàêÂëò"},{default:t(()=>[e(Be,{modelValue:F.value.agentId,"onUpdate:modelValue":l[9]||(l[9]=a=>F.value.agentId=a),placeholder:"ÈÄâÊã©Á≥ªÁªüÊàêÂëò",filterable:"",style:{width:"100%"},onChange:r},{default:t(()=>[(o(!0),v(j,null,re(J.value,a=>(o(),C(N,{key:a.id,label:a.name,value:a.id},{default:t(()=>[n("div",hs,[n("div",{style:_e([{width:"24px",height:"24px","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","font-size":"11px",color:"#fff","flex-shrink":"0"},{background:ul(a.id)}])},p(a.name.charAt(0)),5),n("span",null,p(a.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(ge,{span:7},{default:t(()=>[e(B,{label:"ÂÖ≥Á≥ªÁ±ªÂûã"},{default:t(()=>[e(Be,{modelValue:F.value.relationType,"onUpdate:modelValue":l[10]||(l[10]=a=>F.value.relationType=a),style:{width:"100%"}},{default:t(()=>[e(N,{label:"‰∏äÁ∫ß",value:"‰∏äÁ∫ß"}),e(N,{label:"‰∏ãÁ∫ß",value:"‰∏ãÁ∫ß"}),e(N,{label:"Âπ≥Á∫ßÂçè‰Ωú",value:"Âπ≥Á∫ßÂçè‰Ωú"}),e(N,{label:"ÊîØÊåÅ",value:"ÊîØÊåÅ"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(ge,{span:7},{default:t(()=>[e(B,{label:"Âçè‰ΩúÁ®ãÂ∫¶"},{default:t(()=>[e(Be,{modelValue:F.value.strength,"onUpdate:modelValue":l[11]||(l[11]=a=>F.value.strength=a),style:{width:"100%"}},{default:t(()=>[e(N,{label:"Ê†∏ÂøÉ",value:"Ê†∏ÂøÉ"}),e(N,{label:"Â∏∏Áî®",value:"Â∏∏Áî®"}),e(N,{label:"ÂÅ∂Â∞î",value:"ÂÅ∂Â∞î"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(yl,{gutter:12},{default:t(()=>[e(ge,{span:18},{default:t(()=>[e(B,{label:"ËØ¥ÊòéÔºàÈÄâÂ°´Ôºâ"},{default:t(()=>[e(X,{modelValue:F.value.desc,"onUpdate:modelValue":l[12]||(l[12]=a=>F.value.desc=a),placeholder:"ÁÆÄË¶ÅÊèèËø∞ËøôÊÆµÂÖ≥Á≥ª..."},null,8,["modelValue"])]),_:1})]),_:1}),e(ge,{span:6},{default:t(()=>[e(B,{label:" "},{default:t(()=>[e(f,{type:"primary",style:{width:"100%"},disabled:!F.value.agentId||!F.value.relationType||!F.value.strength,loading:tl.value,onClick:c},{default:t(()=>[...l[63]||(l[63]=[i(" Ê∑ªÂä† ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Ee,null,{header:t(()=>[n("span",ks,[l[64]||(l[64]=i("Â∑≤ÊúâÂÖ≥Á≥ª ",-1)),e(st,{value:ae.value.length,type:"info",style:{"margin-left":"4px"}},null,8,["value"])])]),default:t(()=>[ae.value.length===0?(o(),v("div",xs," ÊöÇÊó†ÂÖ≥Á≥ªÔºåËØ∑Âú®‰∏äÊñπÊ∑ªÂä† ")):(o(),C(Dl,{key:1,data:ae.value,size:"small",style:{width:"100%"}},{default:t(()=>[e(ue,{label:"ÊàêÂëò","min-width":"120"},{default:t(({row:a})=>[n("div",Cs,[n("div",{style:_e([{width:"28px",height:"28px","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","font-size":"12px",color:"#fff","flex-shrink":"0"},{background:ul(a.agentId)}])},p(a.agentName.charAt(0)),5),n("span",$s,p(a.agentName),1)])]),_:1}),e(ue,{label:"Á±ªÂûã",width:"100"},{default:t(({row:a})=>[e(k,{type:rl(a.relationType),size:"small"},{default:t(()=>[i(p(a.relationType),1)]),_:2},1032,["type"])]),_:1}),e(ue,{label:"Á®ãÂ∫¶",width:"80"},{default:t(({row:a})=>[e(k,{type:w(a.strength),size:"small",effect:"plain"},{default:t(()=>[i(p(a.strength),1)]),_:2},1032,["type"])]),_:1}),e(ue,{label:"ËØ¥Êòé","min-width":"120","show-overflow-tooltip":""},{default:t(({row:a})=>[n("span",zs,p(a.desc||"‚Äî"),1)]),_:1}),e(ue,{label:"Êìç‰Ωú",width:"70",fixed:"right"},{default:t(({$index:a})=>[e(f,{type:"danger",link:"",size:"small",onClick:x=>M(a)},{default:t(()=>[...l[65]||(l[65]=[i("Âà†Èô§",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]))]),_:1})]),_:1}),e(ge,{span:10},{default:t(()=>[e(Ee,{header:"ÂÖ≥Á≥ªÈ¢ÑËßà"},{default:t(()=>[ae.value.length===0?(o(),v("div",Vs," ÊöÇÊó†ÂÖ≥Á≥ªÊï∞ÊçÆ ")):(o(),v("div",Ts,[(o(!0),v(j,null,re(ae.value,a=>(o(),v("div",{key:a.agentId,class:"relation-card"},[n("div",{class:"relation-avatar",style:_e({background:ul(a.agentId)})},p(a.agentName.charAt(0).toUpperCase()),5),n("div",Ss,[n("div",Is,p(a.agentName),1),n("div",Ls,[e(k,{type:rl(a.relationType),size:"small"},{default:t(()=>[i(p(a.relationType),1)]),_:2},1032,["type"]),e(k,{type:w(a.strength),size:"small",effect:"plain"},{default:t(()=>[i(p(a.strength),1)]),_:2},1032,["type"])]),n("div",As,p(a.desc),1)])]))),128))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(Ye,{label:"ËÆ∞ÂøÜ",name:"memory"},{default:t(()=>[e(Ee,{style:{"margin-bottom":"16px"},shadow:"never"},{header:t(()=>[n("div",Ms,[l[66]||(l[66]=n("span",{style:{"font-weight":"600"}},"Ëá™Âä®ËÆ∞ÂøÜ",-1)),e(Cl,{modelValue:G.value.enabled,"onUpdate:modelValue":l[13]||(l[13]=a=>G.value.enabled=a),"active-text":"Â∑≤ÂºÄÂêØ","inactive-text":"Â∑≤ÂÖ≥Èó≠",onChange:g},null,8,["modelValue"])])]),default:t(()=>[e(ml,{model:G.value,"label-position":"top",size:"small",disabled:!G.value.enabled},{default:t(()=>[e(yl,{gutter:16},{default:t(()=>[e(ge,{span:6},{default:t(()=>[e(B,{label:"Êï¥ÁêÜÈ¢ëÁéá"},{default:t(()=>[e(Be,{modelValue:G.value.schedule,"onUpdate:modelValue":l[14]||(l[14]=a=>G.value.schedule=a),style:{width:"100%"}},{default:t(()=>[e(N,{label:"ÊØèÂ∞èÊó∂",value:"hourly"}),e(N,{label:"ÊØè6Â∞èÊó∂",value:"every6h"}),e(N,{label:"ÊØèÂ§©",value:"daily"}),e(N,{label:"ÊØèÂë®",value:"weekly"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(ge,{span:5},{default:t(()=>[e(B,{label:"ÊØè‰∏™‰ºöËØù‰øùÁïôËΩÆÊï∞"},{default:t(()=>[e(Pt,{modelValue:G.value.keepTurns,"onUpdate:modelValue":l[15]||(l[15]=a=>G.value.keepTurns=a),min:1,max:20,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(ge,{span:13},{default:t(()=>[e(B,{label:"ËÆ∞ÂΩïÈáçÁÇπÔºàÁïôÁ©∫ÂàôËá™Âä®Ôºâ"},{default:t(()=>[e(X,{modelValue:G.value.focusHint,"onUpdate:modelValue":l[16]||(l[16]=a=>G.value.focusHint=a),placeholder:"‰æãÂ¶ÇÔºöËÆ∞ÂΩïÊï∞Â≠¶Ëß£È¢òÊ≠•È™§ÂíåÁî®Êà∑Â∏∏ËßÅÈîôËØØ"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n("div",Us,[e(f,{type:"primary",size:"small",loading:Ze.value,onClick:g},{default:t(()=>[...l[67]||(l[67]=[i(" ‰øùÂ≠òËÆæÁΩÆ ",-1)])]),_:1},8,["loading"]),e(f,{size:"small",loading:Ve.value,onClick:u},{default:t(()=>[...l[68]||(l[68]=[i(" Á´ãÂç≥Êï¥ÁêÜ ",-1)])]),_:1},8,["loading"]),e(A,{type:"info",size:"small",style:{"align-self":"center","margin-left":"4px"}},{default:t(()=>[i(" Êï¥ÁêÜÂêéÔºöLLMÊèêÁÇºÊëòË¶ÅÂÜôÂÖ• MEMORY.mdÔºåÊØè‰∏™‰ºöËØùÂè™‰øùÁïôÊúÄËøë "+p(G.value.keepTurns)+" ËΩÆÂØπËØù ",1)]),_:1})])]),_:1},8,["model","disabled"])]),_:1}),e(Ee,{style:{"margin-bottom":"16px"},shadow:"never"},{header:t(()=>[n("div",Ds,[l[70]||(l[70]=n("span",{style:{"font-weight":"600"}},"Êï¥ÁêÜÊó•Âøó",-1)),e(f,{size:"small",text:"",onClick:E,loading:z.value},{default:t(()=>[...l[69]||(l[69]=[i("Âà∑Êñ∞",-1)])]),_:1},8,["loading"])])]),default:t(()=>[U.value.length===0&&!z.value?(o(),v("div",Fs," ÊöÇÊó†ËøêË°åËÆ∞ÂΩïÔºåÁÇπÂáª„ÄåÁ´ãÂç≥Êï¥ÁêÜ„ÄçËß¶ÂèëÁ¨¨‰∏ÄÊ¨° ")):(o(),C(Dl,{key:1,data:U.value.slice(0,20),size:"small"},{default:t(()=>[e(ue,{label:"Êó∂Èó¥",width:"160"},{default:t(({row:a})=>[n("span",Ns,p(Zl(a.timestamp)),1)]),_:1}),e(ue,{label:"Áä∂ÊÄÅ",width:"72"},{default:t(({row:a})=>[e(k,{type:a.status==="ok"?"success":"danger",size:"small"},{default:t(()=>[i(p(a.status),1)]),_:2},1032,["type"])]),_:1}),e(ue,{label:"ÁªìÊûú","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[n("span",Bs,p(a.message||"‚Äî"),1)]),_:1})]),_:1},8,["data"]))]),_:1}),n("div",Es,[e(f,{type:"primary",size:"small",onClick:l[17]||(l[17]=a=>Oe.value=!0)},{default:t(()=>[e(de,null,{default:t(()=>[e(W(Bl))]),_:1}),l[71]||(l[71]=i(" Êñ∞Âª∫Êñá‰ª∂ ",-1))]),_:1}),e(f,{size:"small",onClick:l[18]||(l[18]=a=>Ue.value=!0)},{default:t(()=>[e(de,null,{default:t(()=>[e(W(aa))]),_:1}),l[72]||(l[72]=i(" Ê∑ªÂä†Êó•Âøó ",-1))]),_:1}),e(f,{size:"small",onClick:xl},{default:t(()=>[e(de,null,{default:t(()=>[e(W(ft))]),_:1}),l[73]||(l[73]=i(" Âà∑Êñ∞ ",-1))]),_:1})]),e(yl,{gutter:16},{default:t(()=>[e(ge,{span:7},{default:t(()=>[e(Ee,{header:"ËÆ∞ÂøÜÁõÆÂΩï",shadow:"hover"},{default:t(()=>[e(Kt,{data:Y.value,props:{label:"name",children:"children",isLeaf:a=>!a.isDir},onNodeClick:At,"highlight-current":"","default-expand-all":"","expand-on-click-node":!1},{default:t(({data:a})=>[n("span",Rs,[a.isDir?(o(),C(de,{key:0,style:{color:"#E6A23C"}},{default:t(()=>[e(W(na))]),_:1})):(o(),C(de,{key:1,style:{color:"#409EFF"}},{default:t(()=>[e(W(sa))]),_:1})),n("span",null,p(a.name),1),!a.isDir&&a.size?(o(),C(A,{key:2,type:"info",size:"small",style:{"margin-left":"auto"}},{default:t(()=>[i(p(wt(a.size)),1)]),_:2},1024)):V("",!0)])]),_:1},8,["data","props"]),Y.value.length===0?(o(),C(Ul,{key:0,description:"ËÆ∞ÂøÜÊ†ë‰∏∫Á©∫","image-size":40})):V("",!0)]),_:1})]),_:1}),e(ge,{span:17},{default:t(()=>[e(Ee,{shadow:"hover"},{header:t(()=>[n("div",Ps,[e(Wt,{separator:"/"},{default:t(()=>[e(ot,null,{default:t(()=>[...l[74]||(l[74]=[i("memory",-1)])]),_:1}),(o(!0),v(j,null,re(el.value,(a,x)=>(o(),C(ot,{key:x},{default:t(()=>[i(p(a),1)]),_:2},1024))),128))]),_:1}),L.value?(o(),C(f,{key:0,type:"primary",size:"small",onClick:Mt,loading:Me.value},{default:t(()=>[...l[75]||(l[75]=[i("‰øùÂ≠ò",-1)])]),_:1},8,["loading"])):V("",!0)])]),default:t(()=>[L.value?(o(),C(X,{key:0,modelValue:H.value,"onUpdate:modelValue":l[19]||(l[19]=a=>H.value=a),type:"textarea",rows:22,style:{"font-family":"monospace"}},null,8,["modelValue"])):(o(),C(Ul,{key:1,description:"ÁÇπÂáªÂ∑¶‰æßÊñá‰ª∂Êü•ÁúãÂíåÁºñËæë","image-size":60}))]),_:1})]),_:1})]),_:1}),e(Fl,{modelValue:Oe.value,"onUpdate:modelValue":l[22]||(l[22]=a=>Oe.value=a),title:"Êñ∞Âª∫ËÆ∞ÂøÜÊñá‰ª∂",width:"480px"},{footer:t(()=>[e(f,{onClick:l[21]||(l[21]=a=>Oe.value=!1)},{default:t(()=>[...l[77]||(l[77]=[i("ÂèñÊ∂à",-1)])]),_:1}),e(f,{type:"primary",onClick:Ut},{default:t(()=>[...l[78]||(l[78]=[i("ÂàõÂª∫",-1)])]),_:1})]),default:t(()=>[e(ml,{"label-width":"80px"},{default:t(()=>[e(B,{label:"Ë∑ØÂæÑ"},{default:t(()=>[e(X,{modelValue:ll.value,"onUpdate:modelValue":l[20]||(l[20]=a=>ll.value=a),placeholder:"‰æãÂ¶Ç: projects/my-project.md Êàñ topics/cooking.md"},null,8,["modelValue"]),e(A,{type:"info",size:"small",style:{"margin-top":"4px"}},{default:t(()=>[...l[76]||(l[76]=[i("Áõ∏ÂØπ‰∫é memory/ ÁõÆÂΩï",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Fl,{modelValue:Ue.value,"onUpdate:modelValue":l[25]||(l[25]=a=>Ue.value=a),title:"Ê∑ªÂä†‰ªäÊó•Êó•Âøó",width:"600px"},{footer:t(()=>[e(f,{onClick:l[24]||(l[24]=a=>Ue.value=!1)},{default:t(()=>[...l[79]||(l[79]=[i("ÂèñÊ∂à",-1)])]),_:1}),e(f,{type:"primary",onClick:Dt},{default:t(()=>[...l[80]||(l[80]=[i("Êèê‰∫§",-1)])]),_:1})]),default:t(()=>[e(X,{modelValue:De.value,"onUpdate:modelValue":l[23]||(l[23]=a=>De.value=a),type:"textarea",rows:10,placeholder:"ËÆ∞ÂΩï‰ªäÂ§©ÁöÑÈáçË¶Å‰∫ãÈ°π„ÄÅÂ≠¶‰π†ÂøÉÂæó„ÄÅÂæÖÂäû..."},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Ye,{label:"ÊäÄËÉΩ",name:"skills"},{default:t(()=>[e(Ga,{"agent-id":W(y),style:{height:"calc(100vh - 145px)"}},null,8,["agent-id"])]),_:1}),e(Ye,{label:"ÂÆöÊó∂‰ªªÂä°",name:"cron"},{default:t(()=>[e(f,{type:"primary",onClick:l[26]||(l[26]=a=>ie.value=!0),style:{"margin-bottom":"16px"}},{default:t(()=>[e(de,null,{default:t(()=>[e(W(Bl))]),_:1}),l[81]||(l[81]=i(" Êñ∞Âª∫‰ªªÂä° ",-1))]),_:1}),e(Dl,{data:S.value,stripe:""},{default:t(()=>[e(ue,{prop:"name",label:"ÂêçÁß∞"}),e(ue,{label:"Ë∞ÉÂ∫¶"},{default:t(({row:a})=>[i(p(a.schedule?.expr)+" ("+p(a.schedule?.tz)+")",1)]),_:1}),e(ue,{label:"ÊúÄËøëËøêË°å",width:"180"},{default:t(({row:a})=>[a.state?.lastRunAtMs?(o(),v(j,{key:0},[e(k,{type:a.state?.lastStatus==="ok"?"success":"danger",size:"small"},{default:t(()=>[i(p(a.state?.lastStatus),1)]),_:2},1032,["type"]),e(A,{type:"info",size:"small",style:{"margin-left":"4px"}},{default:t(()=>[i(p(Zl(a.state?.lastRunAtMs)),1)]),_:2},1024)],64)):(o(),C(A,{key:1,type:"info",size:"small"},{default:t(()=>[...l[82]||(l[82]=[i("Êú™ËøêË°å",-1)])]),_:1}))]),_:1}),e(ue,{label:"ÂêØÁî®",width:"80"},{default:t(({row:a})=>[e(Cl,{modelValue:a.enabled,"onUpdate:modelValue":x=>a.enabled=x,onChange:x=>Nt(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(ue,{label:"Êìç‰Ωú",width:"220"},{default:t(({row:a})=>[a.payload?.message==="__MEMORY_CONSOLIDATE__"?(o(),v(j,{key:0},[e(k,{type:"info",size:"small",style:{"margin-right":"8px"}},{default:t(()=>[...l[83]||(l[83]=[i("ËÆ∞ÂøÜÁÆ°ÁêÜ",-1)])]),_:1}),e(f,{size:"small",onClick:x=>nt(a)},{default:t(()=>[...l[84]||(l[84]=[i("Á´ãÂç≥ËøêË°å",-1)])]),_:1},8,["onClick"])],64)):(o(),v(j,{key:1},[e(f,{size:"small",onClick:x=>nt(a)},{default:t(()=>[...l[85]||(l[85]=[i("Á´ãÂç≥ËøêË°å",-1)])]),_:1},8,["onClick"]),e(f,{size:"small",type:"danger",onClick:x=>Bt(a)},{default:t(()=>[...l[86]||(l[86]=[i("Âà†Èô§",-1)])]),_:1},8,["onClick"])],64))]),_:1})]),_:1},8,["data"]),e(Fl,{modelValue:ie.value,"onUpdate:modelValue":l[33]||(l[33]=a=>ie.value=a),title:"Êñ∞Âª∫ÂÆöÊó∂‰ªªÂä°",width:"520px"},{footer:t(()=>[e(f,{onClick:l[32]||(l[32]=a=>ie.value=!1)},{default:t(()=>[...l[87]||(l[87]=[i("ÂèñÊ∂à",-1)])]),_:1}),e(f,{type:"primary",onClick:Ft},{default:t(()=>[...l[88]||(l[88]=[i("ÂàõÂª∫",-1)])]),_:1})]),default:t(()=>[e(ml,{model:P.value,"label-width":"100px"},{default:t(()=>[e(B,{label:"ÂêçÁß∞"},{default:t(()=>[e(X,{modelValue:P.value.name,"onUpdate:modelValue":l[27]||(l[27]=a=>P.value.name=a)},null,8,["modelValue"])]),_:1}),e(B,{label:"Cron Ë°®ËææÂºè"},{default:t(()=>[e(X,{modelValue:P.value.expr,"onUpdate:modelValue":l[28]||(l[28]=a=>P.value.expr=a),placeholder:"30 3 * * *"},null,8,["modelValue"])]),_:1}),e(B,{label:"Êó∂Âå∫"},{default:t(()=>[e(Be,{modelValue:P.value.tz,"onUpdate:modelValue":l[29]||(l[29]=a=>P.value.tz=a)},{default:t(()=>[e(N,{label:"Asia/Shanghai",value:"Asia/Shanghai"}),e(N,{label:"UTC",value:"UTC"}),e(N,{label:"America/New_York",value:"America/New_York"})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"Ê∂àÊÅØ"},{default:t(()=>[e(X,{modelValue:P.value.message,"onUpdate:modelValue":l[30]||(l[30]=a=>P.value.message=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),e(B,{label:"ÂêØÁî®"},{default:t(()=>[e(Cl,{modelValue:P.value.enabled,"onUpdate:modelValue":l[31]||(l[31]=a=>P.value.enabled=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1}),e(Ye,{label:"Ê∏†ÈÅì",name:"channels"},{default:t(()=>[n("div",Ks,[e(A,{type:"info",size:"small"},{default:t(()=>[...l[89]||(l[89]=[i("ÊØè‰∏™ AI ÊàêÂëòÁã¨Á´ãÈÖçÁΩÆËá™Â∑±ÁöÑÊ∂àÊÅØÈÄöÈÅìÔºàÂ¶Ç Telegram Bot TokenÔºâ",-1)])]),_:1}),e(f,{type:"primary",size:"small",onClick:bt},{default:t(()=>[e(de,null,{default:t(()=>[e(W(Bl))]),_:1}),l[90]||(l[90]=i(" Ê∑ªÂä†Ê∂àÊÅØÊ∏†ÈÅì ",-1))]),_:1})]),(o(!0),v(j,null,re(He.value,a=>(o(),v("div",{key:a.id,class:"channel-card"},[n("div",Ws,[n("div",js,[e(k,{size:"small",style:{"margin-right":"8px"}},{default:t(()=>[i(p(a.type),1)]),_:2},1024),n("span",Os,p(a.name),1),a.config?.botName?(o(),v("span",Hs,"@"+p(a.config.botName),1)):V("",!0),e(k,{type:a.status==="ok"?"success":a.status==="error"?"danger":"info",size:"small",effect:"plain",style:{"margin-left":"8px"}},{default:t(()=>[i(p(a.status==="ok"?"‚úì Ê≠£Â∏∏":a.status==="error"?"‚úó ÈîôËØØ":"Êú™ÊµãËØï"),1)]),_:2},1032,["type"])]),n("div",Ys,[e(Cl,{modelValue:a.enabled,"onUpdate:modelValue":x=>a.enabled=x,size:"small",onChange:xt,style:{"margin-right":"8px"}},null,8,["modelValue","onUpdate:modelValue"]),e(f,{size:"small",onClick:x=>$t(a),loading:Kl.value===a.id},{default:t(()=>[...l[91]||(l[91]=[i("ÊµãËØïËøûÊé•",-1)])]),_:1},8,["onClick","loading"]),e(f,{size:"small",onClick:x=>ht(a)},{default:t(()=>[...l[92]||(l[92]=[i("ÁºñËæë",-1)])]),_:1},8,["onClick"]),e(f,{size:"small",type:"danger",plain:"",onClick:x=>Ct(a)},{default:t(()=>[...l[93]||(l[93]=[i("Âà†Èô§",-1)])]),_:1},8,["onClick"])])]),a.type==="web"?(o(),v("div",Xs,[n("div",qs,[l[95]||(l[95]=n("span",{class:"channel-info-label"},"ÂÖ¨ÂºÄÂú∞ÂùÄ",-1)),n("span",Js,[e(jt,{href:vl(W(y),a.id),target:"_blank",type:"primary",style:{"font-size":"13px"}},{default:t(()=>[i(p(vl(W(y),a.id)),1)]),_:2},1032,["href"]),e(f,{size:"small",link:"",style:{"margin-left":"8px"},onClick:x=>lt(vl(W(y),a.id))},{default:t(()=>[...l[94]||(l[94]=[i("Â§çÂà∂",-1)])]),_:1},8,["onClick"])])]),n("div",Gs,[l[96]||(l[96]=n("span",{class:"channel-info-label"},"ËÆøÈóÆÂØÜÁ†Å",-1)),n("span",Qs,[e(k,{size:"small",type:a.config?.password?"warning":"info",effect:"plain"},{default:t(()=>[i(p(a.config?.password?"Â∑≤ËÆæÁΩÆ":"Êó†ÂØÜÁ†Å"),1)]),_:2},1032,["type"])])])])):V("",!0),a.type==="telegram"?(o(),v("div",Zs,[n("div",eo,[l[98]||(l[98]=n("span",{class:"channel-info-label"},"ÁôΩÂêçÂçïÁî®Êà∑",-1)),n("span",lo,[a.allowedFromUsers?.length?(o(!0),v(j,{key:0},re(a.allowedFromUsers,x=>(o(),C(k,{key:x.id,size:"small",closable:"","disable-transitions":!0,style:{"margin-right":"4px","margin-bottom":"4px"},onClose:Xl=>tt(a.id,x.id)},{default:t(()=>[i(p(x.username?"@"+x.username:x.firstName||String(x.id))+" ",1),n("span",to,"("+p(x.id)+")",1)]),_:2},1032,["onClose"]))),128)):a.config?.allowedFrom?(o(!0),v(j,{key:1},re(a.config.allowedFrom.split(","),x=>(o(),C(k,{key:x,size:"small",closable:"","disable-transitions":!0,style:{"margin-right":"4px","margin-bottom":"4px"},onClose:Xl=>tt(a.id,Number(x.trim()))},{default:t(()=>[i(p(x.trim()),1)]),_:2},1032,["onClose"]))),128)):(o(),C(A,{key:2,type:"warning",size:"small"},{default:t(()=>[...l[97]||(l[97]=[i("Êú™ËÆæÁΩÆÔºàÈÖçÂØπÊ®°ÂºèÔºåÂêëÁî®Êà∑ËøîÂõûÂÖ∂ IDÔºâ",-1)])]),_:1}))])]),n("div",ao,[n("div",{class:"pending-section-header",onClick:x=>zt(a.id)},[l[100]||(l[100]=n("span",null,"ÂæÖÂÆ°Ê†∏Áî®Êà∑",-1)),e(st,{value:(pl.value[a.id]||[]).length,hidden:!(pl.value[a.id]||[]).length,type:"warning",style:{"margin-left":"6px"}},null,8,["value","hidden"]),e(f,{size:"small",link:"",onClick:al(x=>Al(a.id),["stop"]),style:{"margin-left":"8px"}},{default:t(()=>[...l[99]||(l[99]=[i("Âà∑Êñ∞",-1)])]),_:1},8,["onClick"]),e(de,{style:_e([{"margin-left":"4px",transition:"transform 0.2s"},{transform:kl.value===a.id?"rotate(180deg)":""}])},{default:t(()=>[e(W(oa))]),_:1},8,["style"])],8,no),kl.value===a.id?(o(),v("div",so,[Hl.value[a.id]?(o(),v("div",oo,[e(A,{type:"info",size:"small"},{default:t(()=>[...l[101]||(l[101]=[i("Âä†ËΩΩ‰∏≠...",-1)])]),_:1})])):(pl.value[a.id]||[]).length?(o(!0),v(j,{key:1},re(pl.value[a.id],x=>(o(),v("div",{key:x.id,class:"pending-user-row"},[n("div",io,[n("span",uo,p(x.firstName||"Êú™Áü•"),1),x.username?(o(),v("span",ro,"@"+p(x.username),1)):V("",!0),n("span",co,"ID: "+p(x.id),1),e(A,{type:"info",size:"small",style:{"margin-left":"8px"}},{default:t(()=>[i(p(pe(x.lastSeen)),1)]),_:2},1024)]),n("div",vo,[e(f,{size:"small",type:"success",plain:"",onClick:Xl=>Vt(a.id,x.id),loading:Yl.value===`${a.id}-${x.id}`},{default:t(()=>[...l[102]||(l[102]=[i("Âä†ÂÖ•ÁôΩÂêçÂçï",-1)])]),_:1},8,["onClick","loading"]),e(f,{size:"small",type:"danger",plain:"",onClick:Xl=>Tt(a.id,x.id)},{default:t(()=>[...l[103]||(l[103]=[i("ÂøΩÁï•",-1)])]),_:1},8,["onClick"])])]))),128)):(o(),v("div",fo," ÊöÇÊó†ÂæÖÂÆ°Ê†∏Áî®Êà∑„ÄÇËÆ©Áî®Êà∑Âêë Bot ÂèëÈÄÅ /start Âç≥ÂèØÂá∫Áé∞Âú®Ê≠§Â§Ñ„ÄÇ "))])):V("",!0)])])):V("",!0)]))),128)),!Rl.value&&!He.value.length?(o(),C(Ul,{key:0,description:"ÊöÇÊó†Ê∂àÊÅØÊ∏†ÈÅìÔºåÁÇπÂáª„ÄåÊ∑ªÂä†Ê∂àÊÅØÊ∏†ÈÅì„ÄçÂºÄÂßãÈÖçÁΩÆ","image-size":80,style:{"margin-top":"40px"}})):V("",!0),e(Fl,{modelValue:cl.value,"onUpdate:modelValue":l[44]||(l[44]=a=>cl.value=a),title:Ne.value?"ÁºñËæëÊ∂àÊÅØÊ∏†ÈÅì":"Ê∑ªÂä†Ê∂àÊÅØÊ∏†ÈÅì",width:"540px"},{footer:t(()=>[e(f,{onClick:l[43]||(l[43]=a=>cl.value=!1)},{default:t(()=>[...l[113]||(l[113]=[i("ÂèñÊ∂à",-1)])]),_:1}),e(f,{type:"primary",onClick:kt,loading:Pl.value},{default:t(()=>[...l[114]||(l[114]=[i("‰øùÂ≠ò",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(ml,{model:h.value,"label-width":"120px"},{default:t(()=>[e(B,{label:"Á±ªÂûã",required:""},{default:t(()=>[e(Be,{modelValue:h.value.type,"onUpdate:modelValue":l[34]||(l[34]=a=>h.value.type=a),style:{width:"100%"}},{default:t(()=>[e(N,{label:"Telegram",value:"telegram"}),e(N,{label:"Web ËÅäÂ§©È°µ",value:"web"}),e(N,{label:"iMessage",value:"imessage"}),e(N,{label:"WhatsApp",value:"whatsapp"})]),_:1},8,["modelValue"])]),_:1}),e(B,{label:"ÂêçÁß∞",required:""},{default:t(()=>[e(X,{modelValue:h.value.name,"onUpdate:modelValue":l[35]||(l[35]=a=>h.value.name=a),placeholder:"Â¶ÇÔºöÂÆ¢Êúç Bot"},null,8,["modelValue"])]),_:1}),h.value.type==="telegram"?(o(),v(j,{key:0},[e(B,{label:"Bot Token",required:""},{default:t(()=>[n("div",po,[n("div",mo,[e(X,{modelValue:h.value.botToken,"onUpdate:modelValue":l[36]||(l[36]=a=>h.value.botToken=a),type:"password","show-password":"",placeholder:"‰ªé @BotFather Ëé∑Âèñ",style:{flex:"1"},status:K.value.status==="error"?"error":K.value.status==="ok"?"success":""},null,8,["modelValue","status"]),e(f,{size:"default",loading:K.value.loading,type:K.value.status==="ok"?"success":K.value.status==="error"?"danger":"default",onClick:et,disabled:!h.value.botToken||jl(h.value.botToken)},{default:t(()=>[...l[104]||(l[104]=[i("È™åËØÅ",-1)])]),_:1},8,["loading","type","disabled"])]),K.value.loading?(o(),v("div",yo,[e(de,{class:"is-loading"},{default:t(()=>[e(W(ft))]),_:1}),l[105]||(l[105]=i(" Ê≠£Âú®È™åËØÅ Token‚Ä¶ ",-1))])):K.value.status==="ok"?(o(),v("div",go,[e(de,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:t(()=>[e(Ot)]),_:1}),l[106]||(l[106]=i("Token ÊúâÊïàÔºåBot ÂêçÁß∞Ôºö",-1)),n("b",null,"@"+p(K.value.botName),1)])):K.value.status==="duplicate"?(o(),v("div",_o,[e(de,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:t(()=>[e(Ht)]),_:1}),l[107]||(l[107]=i("Ê≠§ Token Â∑≤Ë¢´ÊàêÂëò„Äå",-1)),n("b",null,p(K.value.usedBy),1),i("„ÄçÁöÑÊ∏†ÈÅì„Äå"+p(K.value.usedByCh)+"„Äç‰ΩøÁî® ",1)])):K.value.status==="error"?(o(),v("div",wo,[e(de,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:t(()=>[e(Yt)]),_:1}),i(p(K.value.error),1)])):(o(),v("div",bo,[e(A,{type:"info",size:"small"},{default:t(()=>[e(de,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:t(()=>[e(it)]),_:1}),l[108]||(l[108]=i("ËæìÂÖ•ÂÆåÊàêÂêéËá™Âä®È™åËØÅÔºå‰πüÂèØÁÇπÂè≥‰æß„ÄåÈ™åËØÅ„ÄçÊåâÈíÆÊâãÂä®Ëß¶Âèë",-1))]),_:1})]))])]),_:1}),e(B,{label:"ÁôΩÂêçÂçïÁî®Êà∑"},{default:t(()=>[e(X,{modelValue:h.value.allowedFrom,"onUpdate:modelValue":l[37]||(l[37]=a=>h.value.allowedFrom=a),placeholder:"Â°´ÂÖ• Telegram Áî®Êà∑ IDÔºåÂ§ö‰∏™Áî®ÈÄóÂè∑ÂàÜÈöî"},null,8,["modelValue"]),e(A,{type:"info",size:"small",style:{display:"block","margin-top":"4px"}},{default:t(()=>[e(de,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:t(()=>[e(it)]),_:1}),l[109]||(l[109]=i("ÁïôÁ©∫Êó∂ Bot ËøõÂÖ•ÈÖçÂØπÊ®°Âºè‚Äî‚ÄîÂêëÁî®Êà∑ËøîÂõûÂÖ∂ IDÔºåÂºïÂØºËÅîÁ≥ªÁÆ°ÁêÜÂëòÊ∑ªÂä†ÁôΩÂêçÂçï ",-1))]),_:1})]),_:1})],64)):V("",!0),h.value.type==="web"?(o(),v(j,{key:1},[Ne.value?(o(),C(B,{key:0,label:"ËÆøÈóÆÈìæÊé•"},{default:t(()=>[n("div",ho,[e(de,{style:{"flex-shrink":"0",color:"#909399"}},{default:t(()=>[e(ut)]),_:1}),n("span",ko,p(vl(W(y),Ne.value)),1),e(f,{size:"small",link:"",onClick:l[38]||(l[38]=a=>lt(vl(W(y),Ne.value)))},{default:t(()=>[...l[110]||(l[110]=[i("Â§çÂà∂",-1)])]),_:1})])]),_:1})):V("",!0),Ne.value?V("",!0):(o(),C(B,{key:1,label:"ËÆøÈóÆÈìæÊé•"},{default:t(()=>[n("div",xo,[e(de,{style:{"flex-shrink":"0",color:"#909399"}},{default:t(()=>[e(ut)]),_:1}),n("span",Co,p(vl(W(y),Ll.value)),1),e(k,{size:"small",type:"info",effect:"plain"},{default:t(()=>[...l[111]||(l[111]=[i("‰øùÂ≠òÂêéÁîüÊïà",-1)])]),_:1})]),e(A,{type:"info",size:"small",style:{display:"block","margin-top":"4px"}},{default:t(()=>[...l[112]||(l[112]=[i(" ÊØè‰∏™ Web Ê∏†ÈÅìÊúâÁã¨Á´ãÈìæÊé•ÔºåÂèØÂêåÊó∂ÂºÄÊîæÂ§ö‰∏™ÂÖ•Âè£ ",-1)])]),_:1})]),_:1})),e(B,{label:"ËÆøÈóÆÂØÜÁ†Å"},{default:t(()=>[e(X,{modelValue:h.value.webPassword,"onUpdate:modelValue":l[39]||(l[39]=a=>h.value.webPassword=a),type:"password","show-password":"",placeholder:"ÁïôÁ©∫ÂàôÊó†ÈúÄÂØÜÁ†Å"},null,8,["modelValue"])]),_:1}),e(B,{label:"Ê¨¢ËøéËØ≠"},{default:t(()=>[e(X,{modelValue:h.value.webWelcome,"onUpdate:modelValue":l[40]||(l[40]=a=>h.value.webWelcome=a),placeholder:"‰Ω†Â•ΩÔºÅÊúâ‰ªÄ‰πàÂèØ‰ª•Â∏Æ‰Ω†ÁöÑÔºü"},null,8,["modelValue"])]),_:1}),e(B,{label:"È°µÈù¢Ê†áÈ¢ò"},{default:t(()=>[e(X,{modelValue:h.value.webTitle,"onUpdate:modelValue":l[41]||(l[41]=a=>h.value.webTitle=a),placeholder:"AI Âä©Êâã"},null,8,["modelValue"])]),_:1})],64)):V("",!0),e(B,{label:"ÂêØÁî®"},{default:t(()=>[e(Cl,{modelValue:h.value.enabled,"onUpdate:modelValue":l[42]||(l[42]=a=>h.value.enabled=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1}),e(Ye,{label:"ÁéØÂ¢ÉÂèòÈáè",name:"env"},{default:t(()=>[n("div",$o,[l[118]||(l[118]=n("div",{style:{"margin-bottom":"16px"}},[n("h3",{style:{margin:"0 0 8px 0","font-size":"15px"}},[i("ÁéØÂ¢ÉÂèòÈáè "),n("span",{style:{"font-size":"12px",color:"#888","font-weight":"400"}},"Ôºà‰ªÖÊ≠§ÊàêÂëòÂèØËßÅÔºâ")]),n("p",{style:{margin:"0 0 6px",color:"#666","font-size":"13px"}},[i(" ÈÖçÁΩÆÊ≠§ AI ÊàêÂëò"),n("strong",null,"ÁßÅÊúâ"),i("ÁöÑÁéØÂ¢ÉÂèòÈáèÔºàÂ¶Ç‰∏ìÂ±ûÁöÑ GitHub Token„ÄÅÂæÆ‰ø° AppSecret Á≠âÔºâ„ÄÇ"),n("br"),i(" ÂèòÈáè‰ºöÊ≥®ÂÖ•Âà∞ bash Â∑•ÂÖ∑ÁöÑÊâßË°åÁéØÂ¢É‰∏≠Ôºå"),n("strong",null,"‰∏çÂèóÁ≥ªÁªüÈªòËÆ§ËøáÊª§ÂΩ±Âìç"),i("Ôºå‰∏î"),n("strong",null,"‰ªÖÂØπÊú¨ÊàêÂëòÂèØËßÅ"),i("„ÄÇ ")]),n("p",{style:{margin:"0",color:"#94a3b8","font-size":"12px",background:"#1e293b",padding:"6px 10px","border-radius":"6px",display:"inline-block"}},[i(" üí° AI ÊàêÂëòÂèØ‰ª•ÈÄöËøá "),n("code",{style:{color:"#38bdf8"}},"self_set_env"),i(" Â∑•ÂÖ∑Ëá™Ë°åÊ∑ªÂä†ÁéØÂ¢ÉÂèòÈáèÔºåÊó†ÈúÄÊâãÂä®Âú®Ê≠§È°µÈù¢Êìç‰Ωú„ÄÇ"),n("br"),i(" ÂÖ®Â±ÄÂÖ±‰∫´ÁöÑ API KeyÔºàÂ¶Ç Brave SearchÔºâËØ∑Âú®Â∑¶‰æß„Äå"),n("strong",null,"ËÉΩÂäõ"),i("„ÄçÊùøÂùóÈÖçÁΩÆ„ÄÇ ")])],-1)),n("div",zo,[e(X,{modelValue:We.value,"onUpdate:modelValue":l[45]||(l[45]=a=>We.value=a),placeholder:"KEYÔºàÂ¶Ç GITHUB_TOKENÔºâ",style:{width:"220px","font-family":"monospace"},size:"small",onKeyup:nl(je,["enter"])},null,8,["modelValue"]),e(X,{modelValue:ze.value,"onUpdate:modelValue":l[46]||(l[46]=a=>ze.value=a),placeholder:"VALUE",style:{flex:"1","font-family":"monospace"},size:"small",type:"password","show-password":"",onKeyup:nl(je,["enter"])},null,8,["modelValue"]),e(f,{size:"small",type:"primary",onClick:je,disabled:!We.value.trim()},{default:t(()=>[...l[115]||(l[115]=[i(" Ê∑ªÂä† ",-1)])]),_:1},8,["disabled"])]),e(Dl,{data:fe.value,size:"small",style:{width:"100%","margin-bottom":"16px"},"empty-text":"ÊöÇÊó†ÁéØÂ¢ÉÂèòÈáè"},{default:t(()=>[e(ue,{label:"KEY","min-width":"200"},{default:t(({row:a})=>[n("code",Vo,p(a.key),1)]),_:1}),e(ue,{label:"VALUE","min-width":"200"},{default:t(({row:a})=>[e(X,{modelValue:a.value,"onUpdate:modelValue":x=>a.value=x,type:"password","show-password":"",size:"small",style:{"font-family":"monospace"},placeholder:"ÔºàÊú™ËÆæÁΩÆÔºâ"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(ue,{label:"Êìç‰Ωú",width:"80",fixed:"right"},{default:t(({$index:a})=>[e(f,{size:"small",type:"danger",link:"",onClick:x=>bl(a)},{default:t(()=>[...l[116]||(l[116]=[i("Âà†Èô§",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),e(f,{type:"primary",size:"small",loading:Qe.value,onClick:il},{default:t(()=>[...l[117]||(l[117]=[i(" ‰øùÂ≠òÁéØÂ¢ÉÂèòÈáè ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ao=Ql(To,[["__scopeId","data-v-903196d9"]]);export{Ao as default};
