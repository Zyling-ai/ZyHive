import{d as He,o as Re,z as qe,P as Pe,af as C,c as p,e as d,b as l,w as n,f as i,l as b,r as z,h as r,i as s,m as q,ag as je,K as se,F as I,p as T,t as _,n as $,g as A,y as oe,ah as Oe,U as Ze,x as _e,I as P,E as V,A as ye}from"./index-BOBEwT8C.js";import{_ as Ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";const We={class:"goals-page"},Je={class:"page-header"},Qe={style:{margin:"0"}},Xe={style:{display:"flex",gap:"8px","align-items":"center"}},et={class:"filter-bar"},tt={key:0},lt={key:1,class:"gantt-container"},at={class:"gantt-header"},nt={class:"gantt-timeline-col"},st={class:"gantt-months"},ot={class:"gantt-grid-lines"},dt={class:"gantt-header",style:{position:"relative",height:"0"}},it={class:"gantt-timeline-col",style:{position:"relative"}},ut={class:"gantt-label-col"},rt={class:"gantt-label-inner"},mt={class:"gantt-agent-avatars"},ct={key:0,class:"gantt-avatar gantt-avatar-more"},pt={class:"gantt-title-text"},ft={class:"gantt-timeline-col"},gt=["onClick","title"],vt={key:0,class:"gantt-bar-label"},_t={key:0,class:"bar-breathe-dot"},yt={style:{opacity:"0.7","font-size":"10px"}},bt={class:"gantt-status-col"},ht={key:0,style:{color:"#c0c4cc","font-size":"12px"}},wt={style:{display:"flex","align-items":"center",gap:"6px"}},Vt={style:{"font-size":"12px",color:"#606266"}},kt={style:{width:"100%"}},xt={style:{"text-align":"right","margin-top":"16px"}},At={style:{"text-align":"right","margin-bottom":"12px"}},Ct={style:{"font-family":"monospace","font-size":"12px"}},zt={key:0,style:{"text-align":"center",padding:"20px"}},It={style:{display:"flex","align-items":"center",gap:"8px","margin-bottom":"6px"}},Tt={style:{"font-size":"13px","font-weight":"500"}},Ut=He({__name:"GoalsView",setup(Dt){const X=z([]),Y=z([]),j=z(""),ee=z("gantt"),S=z(!1),O=z("basic"),m=z(null),Z=z(!1),J=z([]),te=z(!1),Q=z("0 9 * * 1"),o=_e({title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]}),f=_e({name:"",agentId:"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"请检查目标「{goal.title}」的进展情况（当前进度 {goal.progress}），距截止日期 {goal.endAt} 还有一段时间，请总结近期进展并建议下一步行动。",enabled:!0}),F=P(()=>{const a={};for(const e of Y.value)a[e.id]=e.name;return a}),L=P(()=>{const a={};for(const e of Y.value)a[e.id]=e.avatarColor||"#409eff";return a}),K=P(()=>j.value?X.value.filter(a=>a.agentIds.includes(j.value)):X.value),B=P(()=>{const a=K.value.filter(y=>M(y.startAt)&&M(y.endAt));if(!a.length){const y=new Date;return{start:new Date(y.getFullYear(),y.getMonth(),1),end:new Date(y.getFullYear(),y.getMonth()+3,1)}}const e=a.map(y=>new Date(y.startAt).getTime()),v=a.map(y=>new Date(y.endAt).getTime()),c=Math.min(...e),k=Math.max(...v),U=(k-c)*.05;return{start:new Date(c-U),end:new Date(k+U)}}),de=P(()=>$e(B.value.start,B.value.end)),ie=P(()=>{const{start:a,end:e}=B.value,v=Date.now();if(v<a.getTime()||v>e.getTime())return null;const c=e.getTime()-a.getTime();return`${(v-a.getTime())/c*100}%`});Re(async()=>{const[a]=await Promise.all([qe.list().catch(()=>({data:[]}))]);Y.value=a.data||[],await E()}),Pe(O,async a=>{a==="records"&&m.value&&await be(m.value.id)});async function E(){try{const a=await C.list(j.value||void 0);X.value=a.data||[]}catch{}}async function be(a){te.value=!0;try{const e=await C.listCheckRecords(a);J.value=(e.data||[]).slice().reverse()}catch{J.value=[]}finally{te.value=!1}}function he(){m.value=null,O.value="basic",Object.assign(o,{title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]}),S.value=!0}function ue(a){m.value=a,O.value="basic",Object.assign(o,{title:a.title,description:a.description||"",type:a.type,agentIds:[...a.agentIds||[]],status:a.status,progress:a.progress,startAt:M(a.startAt)?a.startAt:"",endAt:M(a.endAt)?a.endAt:"",milestones:(a.milestones||[]).map(e=>({...e}))}),S.value=!0}async function we(){if(!o.title.trim()){V.warning("请填写目标标题");return}const a={title:o.title,description:o.description||void 0,type:o.type,agentIds:o.agentIds,status:o.status,progress:o.progress,startAt:o.startAt||void 0,endAt:o.endAt||void 0,milestones:o.milestones.map(e=>({...e,id:e.id||"ms-"+Math.random().toString(36).slice(2,10)}))};try{m.value?(await C.update(m.value.id,a),V.success("保存成功")):(await C.create(a),V.success("创建成功")),S.value=!1,await E()}catch(e){V.error(e.response?.data?.error||"操作失败")}}async function Ve(a){try{await ye.confirm(`确定删除目标「${a.title}」？`,"删除确认",{type:"warning"}),await C.delete(a.id),V.success("已删除"),await E()}catch(e){e!=="cancel"&&V.error("删除失败")}}function ke(){o.milestones.push({id:"ms-"+Math.random().toString(36).slice(2,10),title:"",dueAt:"",done:!1,agentIds:[]})}function xe(){Object.assign(f,{name:"",agentId:Y.value[0]?.id||"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"请检查目标「{goal.title}」的进展情况（当前进度 {goal.progress}），距截止日期 {goal.endAt} 还有一段时间，请总结近期进展并建议下一步行动。",enabled:!0}),Q.value="0 9 * * 1",Z.value=!0}function Ae(a){a!=="custom"&&(f.schedule=a)}async function Ce(){if(!f.name.trim()){V.warning("请填写检查名称");return}if(!f.agentId){V.warning("请选择执行成员");return}if(!f.schedule.trim()){V.warning("请设置检查频率");return}if(m.value)try{await C.addCheck(m.value.id,{name:f.name,agentId:f.agentId,schedule:f.schedule,tz:f.tz,prompt:f.prompt,enabled:f.enabled}),V.success("添加成功"),Z.value=!1;const a=await C.get(m.value.id);m.value=a.data,await E()}catch(a){V.error(a.response?.data?.error||"添加失败")}}async function ze(a){if(m.value)try{await C.updateCheck(m.value.id,a.id,{enabled:a.enabled})}catch{V.error("更新失败")}}async function Ie(a){if(m.value)try{await C.runCheck(m.value.id,a.id),V.success("已触发检查")}catch(e){V.error(e.response?.data?.error||"触发失败")}}async function Te(a){if(m.value)try{await ye.confirm(`确定删除检查计划「${a.name}」？`,"删除确认",{type:"warning"}),await C.removeCheck(m.value.id,a.id),V.success("已删除");const e=await C.get(m.value.id);m.value=e.data,await E()}catch(e){e!=="cancel"&&V.error("删除失败")}}function M(a){if(!a)return!1;const e=new Date(a);return!isNaN(e.getTime())&&e.getFullYear()>1970}function re(a){return M(a.startAt)&&M(a.endAt)}function Ue(a){const{start:e,end:v}=B.value,c=v.getTime()-e.getTime(),k=new Date(a.startAt).getTime(),g=new Date(a.endAt).getTime();return Math.max(1,(g-k)/c*100)}function De(a){const{start:e,end:v}=B.value,c=v.getTime()-e.getTime(),k=new Date(a.startAt).getTime(),g=new Date(a.endAt).getTime(),U=Math.max(0,(k-e.getTime())/c*100),y=Math.max(1,(g-k)/c*100);let N="#409eff";const D=a.agentIds?.[0];D&&L.value[D]&&(N=L.value[D]);let G=N;if(a.type==="team"&&a.agentIds?.length>1){const h=a.agentIds[1],le=h&&L.value[h]?L.value[h]:"#67c23a";G=`linear-gradient(90deg, ${N}, ${le})`}return{left:`${U}%`,width:`${y}%`,background:G}}function Me(a){const{start:e,end:v}=B.value;if(!M(a.dueAt))return"-100%";const c=v.getTime()-e.getTime();return`${(new Date(a.dueAt).getTime()-e.getTime())/c*100}%`}function $e(a,e){const v=[],c=new Date(a.getFullYear(),a.getMonth(),1),k=e.getTime()-a.getTime();for(;c<=e;){const g=(c.getTime()-a.getTime())/k*100;g>=0&&g<=100&&v.push({label:`${c.getFullYear()}/${c.getMonth()+1}`,left:`${g}%`}),c.setMonth(c.getMonth()+1)}return v}function me(a){return{draft:"草稿",active:"进行中",completed:"已完成",cancelled:"已取消"}[a]||a}function ce(a){return{draft:"info",active:"",completed:"success",cancelled:"danger"}[a]||"info"}function pe(a){return M(a)?new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"—"}function Ye(a){if(!a)return"";const e=new Date(a);return isNaN(e.getTime())?"":e.toLocaleString("zh-CN")}return(a,e)=>{const v=r("el-icon"),c=r("el-radio-button"),k=r("el-radio-group"),g=r("el-button"),U=r("el-text"),y=r("el-empty"),N=r("el-tooltip"),D=r("el-tag"),G=r("el-card"),h=r("el-table-column"),le=r("el-progress"),fe=r("el-table"),H=r("el-input"),w=r("el-form-item"),x=r("el-option"),W=r("el-select"),ae=r("el-date-picker"),Ne=r("el-slider"),Se=r("el-checkbox"),ge=r("el-form"),ne=r("el-tab-pane"),ve=r("el-switch"),Fe=r("el-timeline-item"),Le=r("el-timeline"),Be=r("el-tabs"),Ee=r("el-drawer"),Ge=r("el-dialog");return s(),p("div",We,[d("div",Je,[d("h2",Qe,[l(v,{style:{"vertical-align":"-2px","margin-right":"6px"}},{default:n(()=>[l(q(je))]),_:1}),e[22]||(e[22]=i("目标规划 ",-1))]),d("div",Xe,[l(k,{modelValue:ee.value,"onUpdate:modelValue":e[0]||(e[0]=t=>ee.value=t),size:"small"},{default:n(()=>[l(c,{value:"gantt"},{default:n(()=>[...e[23]||(e[23]=[i("甘特图",-1)])]),_:1}),l(c,{value:"list"},{default:n(()=>[...e[24]||(e[24]=[i("列表",-1)])]),_:1})]),_:1},8,["modelValue"]),l(g,{type:"primary",onClick:he},{default:n(()=>[l(v,null,{default:n(()=>[l(q(se))]),_:1}),e[25]||(e[25]=i(" 新建目标 ",-1))]),_:1})])]),d("div",et,[l(U,{type:"info",size:"small",style:{"margin-right":"4px"}},{default:n(()=>[...e[26]||(e[26]=[i("筛选成员：",-1)])]),_:1}),l(k,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=t=>j.value=t),size:"small",onChange:E},{default:n(()=>[l(c,{value:""},{default:n(()=>[...e[27]||(e[27]=[i("全部",-1)])]),_:1}),(s(!0),p(I,null,T(Y.value,t=>(s(),b(c,{key:t.id,value:t.id},{default:n(()=>[i(_(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),ee.value==="gantt"?(s(),b(G,{key:0,shadow:"hover",class:"gantt-card"},{default:n(()=>[K.value.length===0?(s(),p("div",tt,[l(y,{description:"暂无目标，点击「新建目标」开始规划"})])):(s(),p("div",lt,[d("div",at,[e[28]||(e[28]=d("div",{class:"gantt-label-col"},null,-1)),d("div",nt,[d("div",st,[(s(!0),p(I,null,T(de.value,t=>(s(),p("div",{key:t.label,class:"gantt-month-label",style:$({left:t.left})},_(t.label),5))),128))]),d("div",ot,[(s(!0),p(I,null,T(de.value,t=>(s(),p("div",{key:"line-"+t.label,class:"gantt-grid-line",style:$({left:t.left})},null,4))),128))])])]),d("div",dt,[e[29]||(e[29]=d("div",{class:"gantt-label-col"},null,-1)),d("div",it,[ie.value!==null?(s(),p("div",{key:0,class:"gantt-today-line",style:$({left:ie.value})},null,4)):A("",!0)])]),(s(!0),p(I,null,T(K.value,t=>(s(),p("div",{key:t.id,class:"gantt-row"},[d("div",ut,[d("div",rt,[d("div",mt,[(s(!0),p(I,null,T(t.agentIds.slice(0,3),u=>(s(),b(N,{key:u,content:F.value[u]||u,placement:"top"},{default:n(()=>[d("div",{class:"gantt-avatar",style:$({background:L.value[u]||"#409eff"})},_((F.value[u]||u).slice(0,1)),5)]),_:2},1032,["content"]))),128)),t.agentIds.length>3?(s(),p("div",ct," +"+_(t.agentIds.length-3),1)):A("",!0)]),l(N,{content:t.title,placement:"top","show-after":300},{default:n(()=>[d("span",pt,_(t.title),1)]),_:2},1032,["content"])])]),d("div",ft,[re(t)?(s(),p("div",{key:0,class:"gantt-bar",style:$(De(t)),onClick:u=>ue(t),title:t.title},[d("div",{class:"gantt-bar-progress",style:$({width:t.progress+"%"})},null,4),Ue(t)>8?(s(),p("span",vt,[t.status==="active"?(s(),p("span",_t)):A("",!0),i(" "+_(t.title)+" ",1),d("span",yt,_(t.progress)+"%",1)])):A("",!0)],12,gt)):A("",!0),re(t)?(s(!0),p(I,{key:1},T(t.milestones,u=>(s(),b(N,{key:u.id,content:`${u.title}${u.done?" ✓":""}`,placement:"top"},{default:n(()=>[d("div",{class:oe(["gantt-milestone",{"gantt-milestone-done":u.done}]),style:$({left:Me(u)})},null,6)]),_:2},1032,["content"]))),128)):A("",!0)]),d("div",bt,[l(D,{type:ce(t.status),size:"small",class:oe({"status-active":t.status==="active"})},{default:n(()=>[i(_(me(t.status)),1)]),_:2},1032,["type","class"])])]))),128))]))]),_:1})):(s(),b(G,{key:1,shadow:"hover"},{default:n(()=>[l(fe,{data:K.value,stripe:""},{default:n(()=>[l(h,{prop:"title",label:"目标","min-width":"160"}),l(h,{label:"类型",width:"80"},{default:n(({row:t})=>[l(D,{size:"small",type:t.type==="team"?"warning":"info"},{default:n(()=>[i(_(t.type==="team"?"团队":"个人"),1)]),_:2},1032,["type"])]),_:1}),l(h,{label:"参与成员","min-width":"140"},{default:n(({row:t})=>[(s(!0),p(I,null,T(t.agentIds,u=>(s(),b(D,{key:u,size:"small",style:{margin:"1px"}},{default:n(()=>[i(_(F.value[u]||u),1)]),_:2},1024))),128)),t.agentIds.length?A("",!0):(s(),p("span",ht,"—"))]),_:1}),l(h,{label:"状态",width:"90"},{default:n(({row:t})=>[l(D,{type:ce(t.status),size:"small",class:oe({"status-active":t.status==="active"})},{default:n(()=>[i(_(me(t.status)),1)]),_:2},1032,["type","class"])]),_:1}),l(h,{label:"进度",width:"120"},{default:n(({row:t})=>[d("div",wt,[l(le,{percentage:t.progress,"stroke-width":6,style:{flex:"1","min-width":"60px"}},null,8,["percentage"])])]),_:1}),l(h,{label:"时间范围","min-width":"180"},{default:n(({row:t})=>[d("span",Vt,_(pe(t.startAt))+" ~ "+_(pe(t.endAt)),1)]),_:1}),l(h,{label:"操作",width:"120"},{default:n(({row:t})=>[l(g,{size:"small",onClick:u=>ue(t)},{default:n(()=>[...e[30]||(e[30]=[i("编辑",-1)])]),_:1},8,["onClick"]),l(g,{size:"small",type:"danger",onClick:u=>Ve(t)},{default:n(()=>[...e[31]||(e[31]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),K.value.length===0?(s(),b(y,{key:0,description:"暂无目标"})):A("",!0)]),_:1})),l(Ee,{modelValue:S.value,"onUpdate:modelValue":e[12]||(e[12]=t=>S.value=t),title:m.value?"编辑目标":"新建目标",size:"580px","destroy-on-close":""},{default:n(()=>[l(Be,{modelValue:O.value,"onUpdate:modelValue":e[11]||(e[11]=t=>O.value=t)},{default:n(()=>[l(ne,{label:"基本信息",name:"basic"},{default:n(()=>[l(ge,{model:o,"label-width":"100px"},{default:n(()=>[l(w,{label:"标题",required:""},{default:n(()=>[l(H,{modelValue:o.title,"onUpdate:modelValue":e[2]||(e[2]=t=>o.title=t),placeholder:"目标标题"},null,8,["modelValue"])]),_:1}),l(w,{label:"描述"},{default:n(()=>[l(H,{modelValue:o.description,"onUpdate:modelValue":e[3]||(e[3]=t=>o.description=t),type:"textarea",rows:2,placeholder:"（可选）"},null,8,["modelValue"])]),_:1}),l(w,{label:"类型"},{default:n(()=>[l(k,{modelValue:o.type,"onUpdate:modelValue":e[4]||(e[4]=t=>o.type=t)},{default:n(()=>[l(c,{value:"personal"},{default:n(()=>[...e[32]||(e[32]=[i("个人",-1)])]),_:1}),l(c,{value:"team"},{default:n(()=>[...e[33]||(e[33]=[i("团队",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"参与成员"},{default:n(()=>[l(W,{modelValue:o.agentIds,"onUpdate:modelValue":e[5]||(e[5]=t=>o.agentIds=t),multiple:"",placeholder:"选择成员",style:{width:"100%"}},{default:n(()=>[(s(!0),p(I,null,T(Y.value,t=>(s(),b(x,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"状态"},{default:n(()=>[l(W,{modelValue:o.status,"onUpdate:modelValue":e[6]||(e[6]=t=>o.status=t),style:{width:"100%"}},{default:n(()=>[l(x,{label:"草稿",value:"draft"}),l(x,{label:"进行中",value:"active"}),l(x,{label:"已完成",value:"completed"}),l(x,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"开始时间"},{default:n(()=>[l(ae,{modelValue:o.startAt,"onUpdate:modelValue":e[7]||(e[7]=t=>o.startAt=t),type:"datetime",placeholder:"选择开始时间",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),l(w,{label:"结束时间"},{default:n(()=>[l(ae,{modelValue:o.endAt,"onUpdate:modelValue":e[8]||(e[8]=t=>o.endAt=t),type:"datetime",placeholder:"选择结束时间",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),m.value?(s(),b(w,{key:0,label:"进度"},{default:n(()=>[l(Ne,{modelValue:o.progress,"onUpdate:modelValue":e[9]||(e[9]=t=>o.progress=t),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1})):A("",!0),l(w,{label:"里程碑"},{default:n(()=>[d("div",kt,[(s(!0),p(I,null,T(o.milestones,(t,u)=>(s(),p("div",{key:u,class:"milestone-row"},[l(Se,{modelValue:t.done,"onUpdate:modelValue":R=>t.done=R},null,8,["modelValue","onUpdate:modelValue"]),l(H,{modelValue:t.title,"onUpdate:modelValue":R=>t.title=R,placeholder:"里程碑标题",size:"small",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),l(ae,{modelValue:t.dueAt,"onUpdate:modelValue":R=>t.dueAt=R,type:"date",placeholder:"截止日",size:"small",style:{width:"130px"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue","onUpdate:modelValue"]),l(g,{type:"danger",size:"small",circle:"",onClick:R=>o.milestones.splice(u,1)},{default:n(()=>[l(v,null,{default:n(()=>[l(q(Oe))]),_:1})]),_:1},8,["onClick"])]))),128)),l(g,{size:"small",onClick:ke,style:{"margin-top":"4px"}},{default:n(()=>[l(v,null,{default:n(()=>[l(q(se))]),_:1}),e[34]||(e[34]=i(" 添加里程碑 ",-1))]),_:1})])]),_:1})]),_:1},8,["model"]),d("div",xt,[l(g,{onClick:e[10]||(e[10]=t=>S.value=!1)},{default:n(()=>[...e[35]||(e[35]=[i("取消",-1)])]),_:1}),l(g,{type:"primary",onClick:we},{default:n(()=>[i(_(m.value?"保存":"创建"),1)]),_:1})])]),_:1}),m.value?(s(),b(ne,{key:0,label:"定期检查",name:"checks"},{default:n(()=>[d("div",At,[l(g,{type:"primary",size:"small",onClick:xe},{default:n(()=>[l(v,null,{default:n(()=>[l(q(se))]),_:1}),e[36]||(e[36]=i(" 添加检查 ",-1))]),_:1})]),l(fe,{data:m.value.checks,size:"small",stripe:""},{default:n(()=>[l(h,{prop:"name",label:"名称","min-width":"120"}),l(h,{label:"频率","min-width":"140"},{default:n(({row:t})=>[d("span",Ct,_(t.schedule),1),l(U,{type:"info",size:"small",style:{"margin-left":"4px"}},{default:n(()=>[i("("+_(t.tz||"Asia/Shanghai")+")",1)]),_:2},1024)]),_:1}),l(h,{label:"执行成员",width:"100"},{default:n(({row:t})=>[d("span",null,_(F.value[t.agentId]||t.agentId),1)]),_:1}),l(h,{label:"启用",width:"70"},{default:n(({row:t})=>[l(ve,{modelValue:t.enabled,"onUpdate:modelValue":u=>t.enabled=u,size:"small",onChange:u=>ze(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(h,{label:"操作",width:"140"},{default:n(({row:t})=>[l(g,{size:"small",onClick:u=>Ie(t)},{default:n(()=>[...e[37]||(e[37]=[i("立即运行",-1)])]),_:1},8,["onClick"]),l(g,{size:"small",type:"danger",onClick:u=>Te(t)},{default:n(()=>[...e[38]||(e[38]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),m.value.checks.length?A("",!0):(s(),b(y,{key:0,description:"暂无检查计划"}))]),_:1})):A("",!0),m.value?(s(),b(ne,{key:1,label:"检查记录",name:"records"},{default:n(()=>[te.value?(s(),p("div",zt,[l(v,{class:"is-loading"},{default:n(()=>[l(q(Ze))]),_:1})])):J.value.length?(s(),b(Le,{key:1},{default:n(()=>[(s(!0),p(I,null,T(J.value,t=>(s(),b(Fe,{key:t.id,timestamp:Ye(t.runAt),type:t.status==="ok"?"success":"danger",placement:"top"},{default:n(()=>[l(G,{shadow:"never",style:{padding:"0"}},{default:n(()=>[d("div",It,[d("div",{class:"gantt-avatar",style:$({background:L.value[t.agentId]||"#409eff"})},_((F.value[t.agentId]||t.agentId||"?").slice(0,1)),5),d("span",Tt,_(F.value[t.agentId]||t.agentId),1),l(D,{type:t.status==="ok"?"success":"danger",size:"small"},{default:n(()=>[i(_(t.status),1)]),_:2},1032,["type"])]),l(U,{style:{"font-size":"12px","white-space":"pre-wrap"}},{default:n(()=>[i(_(t.output||"（无输出）"),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["timestamp","type"]))),128))]),_:1})):(s(),b(y,{key:2,description:"暂无检查记录"}))]),_:1})):A("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"]),l(Ge,{modelValue:Z.value,"onUpdate:modelValue":e[21]||(e[21]=t=>Z.value=t),title:"添加定期检查",width:"500px"},{footer:n(()=>[l(g,{onClick:e[20]||(e[20]=t=>Z.value=!1)},{default:n(()=>[...e[40]||(e[40]=[i("取消",-1)])]),_:1}),l(g,{type:"primary",onClick:Ce},{default:n(()=>[...e[41]||(e[41]=[i("添加",-1)])]),_:1})]),default:n(()=>[l(ge,{model:f,"label-width":"100px"},{default:n(()=>[l(w,{label:"名称",required:""},{default:n(()=>[l(H,{modelValue:f.name,"onUpdate:modelValue":e[13]||(e[13]=t=>f.name=t),placeholder:"如：每周进度检查"},null,8,["modelValue"])]),_:1}),l(w,{label:"执行成员",required:""},{default:n(()=>[l(W,{modelValue:f.agentId,"onUpdate:modelValue":e[14]||(e[14]=t=>f.agentId=t),style:{width:"100%"}},{default:n(()=>[(s(!0),p(I,null,T(Y.value,t=>(s(),b(x,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"检查频率"},{default:n(()=>[l(W,{modelValue:Q.value,"onUpdate:modelValue":e[15]||(e[15]=t=>Q.value=t),style:{width:"100%"},onChange:Ae},{default:n(()=>[l(x,{label:"每天上午9点",value:"0 9 * * *"}),l(x,{label:"每周一上午9点",value:"0 9 * * 1"}),l(x,{label:"每周五下午5点",value:"0 17 * * 5"}),l(x,{label:"每月1日上午9点",value:"0 9 1 * *"}),l(x,{label:"自定义",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),Q.value==="custom"?(s(),b(w,{key:0,label:"Cron 表达式"},{default:n(()=>[l(H,{modelValue:f.schedule,"onUpdate:modelValue":e[16]||(e[16]=t=>f.schedule=t),placeholder:"0 9 * * 1"},null,8,["modelValue"])]),_:1})):A("",!0),l(w,{label:"时区"},{default:n(()=>[l(W,{modelValue:f.tz,"onUpdate:modelValue":e[17]||(e[17]=t=>f.tz=t),style:{width:"100%"}},{default:n(()=>[l(x,{label:"Asia/Shanghai",value:"Asia/Shanghai"}),l(x,{label:"UTC",value:"UTC"}),l(x,{label:"America/New_York",value:"America/New_York"})]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"检查提示词"},{default:n(()=>[l(H,{modelValue:f.prompt,"onUpdate:modelValue":e[18]||(e[18]=t=>f.prompt=t),type:"textarea",rows:4,placeholder:"可用变量：{goal.title} {goal.progress} {goal.endAt}"},null,8,["modelValue"]),l(U,{type:"info",size:"small",style:{display:"block","margin-top":"4px"}},{default:n(()=>[...e[39]||(e[39]=[i(" 可用变量：{goal.title} {goal.progress} {goal.endAt} {goal.startAt} {goal.status} ",-1)])]),_:1})]),_:1}),l(w,{label:"启用"},{default:n(()=>[l(ve,{modelValue:f.enabled,"onUpdate:modelValue":e[19]||(e[19]=t=>f.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Yt=Ke(Ut,[["__scopeId","data-v-73ec3e6b"]]);export{Yt as default};
