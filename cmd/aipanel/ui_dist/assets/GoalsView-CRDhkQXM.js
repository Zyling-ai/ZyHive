import{d as lt,o as at,z as st,P as nt,aa as M,c,e as n,b as l,w as s,g as $,F as b,p as C,n as z,y as q,f as _,t as y,l as T,r as k,I as N,h as f,i as d,m as V,a1 as ot,K as X,ab as le,ac as Te,ad as me,U as dt,a8 as it,x as ze,E as A,A as ut}from"./index-B0OC2w2j.js";import{A as rt}from"./AiChat-BMiAtqDQ.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ct={class:"goals-studio"},pt={class:"sidebar-top"},vt={class:"sidebar-acts"},ft={class:"gs-filter"},gt={class:"goal-list"},_t={key:0,class:"list-empty"},yt=["onClick"],bt={class:"gi-top"},ht={class:"gi-title"},Vt={class:"gi-progress-wrap"},wt={class:"gi-progress-num"},kt={class:"gi-bottom"},At={class:"gi-avatars"},Ct={key:0,class:"gi-avatar-more"},It={class:"gi-dates"},Tt={class:"gs-editor"},zt={key:0,class:"editor-gantt-overview"},xt={class:"overview-header"},Ut={class:"overview-title"},Mt={key:0,class:"gantt-empty"},$t={key:1,class:"gantt-wrap"},Dt={class:"gantt-header"},Yt={class:"gantt-timeline-col"},St={class:"gantt-months"},Nt={class:"gantt-body"},Ht={class:"gantt-overlay","aria-hidden":"true"},Lt={class:"gantt-timeline-col",style:{position:"relative"}},Et=["onClick"],Ft={class:"gantt-label-col"},Bt={class:"gantt-label-inner"},Gt={class:"gantt-agent-avatars"},Ot={class:"gantt-goal-name"},Zt={class:"gantt-timeline-col"},jt={key:0,class:"gantt-bar-label"},Rt=["title"],Pt={key:1,class:"gantt-no-date"},qt={class:"editor-toolbar"},Xt={class:"editor-breadcrumb"},Jt={class:"toolbar-acts"},Wt={class:"editor-form"},Kt={style:{width:"100%"}},Qt={class:"editor-toolbar"},el={class:"editor-breadcrumb"},tl={class:"crumb-name"},ll={class:"toolbar-acts"},al={class:"editor-form"},sl={style:{width:"100%"}},nl={class:"tab-panel"},ol={class:"tab-panel-head"},dl={class:"code-cell"},il={class:"tab-panel"},ul={key:0,style:{"text-align":"center",padding:"20px"}},rl={class:"record-card"},ml={class:"record-header"},cl={class:"rec-name"},pl={class:"rec-output"},vl={class:"chat-panel-head"},fl={class:"chat-wrap"},gl=lt({__name:"GoalsView",setup(_l){const ae=k(260),se=k(360),G=k("");let ce=0,ne=0;function pe(a,e){G.value=e,ce=a.clientX,ne=e==="side"?ae.value:se.value,document.addEventListener("mousemove",ve),document.addEventListener("mouseup",fe),a.preventDefault()}function ve(a){const e=a.clientX-ce;G.value==="side"?ae.value=Math.max(200,Math.min(400,ne+e)):se.value=Math.max(280,Math.min(560,ne-e))}function fe(){G.value="",document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",fe)}const J=k([]),x=k([]),W=k(""),K=k(""),i=k(null),H=k(!1),Q=k(!1),O=k("basic"),Z=k(!1),ee=k([]),oe=k(!1),te=k("0 9 * * 1"),Y=k(""),o=ze({title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]}),h=ze({name:"",agentId:"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€çš„è¿›å±•æƒ…å†µï¼ˆå½“å‰è¿›åº¦ {goal.progress}ï¼‰ï¼Œè·æˆªæ­¢æ—¥æœŸ {goal.endAt} è¿˜æœ‰ä¸€æ®µæ—¶é—´ï¼Œè¯·æ€»ç»“è¿‘æœŸè¿›å±•å¹¶å»ºè®®ä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚",enabled:!0}),j=N(()=>{const a={};return x.value.forEach(e=>{a[e.id]=e.name}),a}),L=N(()=>{const a={};return x.value.forEach(e=>{a[e.id]=e.avatarColor||"#409eff"}),a}),R=N(()=>{let a=[...J.value];return W.value&&(a=a.filter(e=>e.status===W.value)),K.value&&(a=a.filter(e=>(e.agentIds||[]).includes(K.value))),a}),E=N(()=>{const a=R.value.filter(w=>D(w.startAt)&&D(w.endAt));if(!a.length){const w=new Date;return{start:new Date(w.getFullYear(),w.getMonth(),1),end:new Date(w.getFullYear(),w.getMonth()+3,1)}}const e=a.map(w=>new Date(w.startAt).getTime()),u=a.map(w=>new Date(w.endAt).getTime()),r=Math.min(...e),m=Math.max(...u),g=(m-r)*.05;return{start:new Date(r-g),end:new Date(m+g)}}),ge=N(()=>Ze(E.value.start,E.value.end)),_e=N(()=>{const{start:a,end:e}=E.value,u=Date.now();return u<a.getTime()||u>e.getTime()?null:`${(u-a.getTime())/(e.getTime()-a.getTime())*100}%`}),xe=N(()=>{const a=localStorage.getItem("aipanel_token")||"TOKEN",e=`${window.location.protocol}//${window.location.host}`,u=x.value.map(m=>`- ${m.id}: ${m.name}`).join(`
`),r=i.value?`
### å½“å‰é€‰ä¸­ç›®æ ‡
ID: ${i.value.id}
æ ‡é¢˜: ${i.value.title}
çŠ¶æ€: ${i.value.status}
è¿›åº¦: ${i.value.progress}%
å¼€å§‹: ${i.value.startAt||"æœªè®¾ç½®"}
ç»“æŸ: ${i.value.endAt||"æœªè®¾ç½®"}`:"";return`## ç›®æ ‡è§„åˆ’åŠ©æ‰‹

ä½ æ˜¯å›¢é˜Ÿçš„ç›®æ ‡è§„åˆ’åŠ©æ‰‹ã€‚

### ðŸŽ¯ æ ¸å¿ƒèƒ½åŠ›ï¼šå¡«å†™è¡¨å•ï¼ˆä¼˜å…ˆä½¿ç”¨ï¼‰

å½“ç”¨æˆ·æè¿°ç›®æ ‡ä¿¡æ¯æ—¶ï¼Œ**ç›´æŽ¥è¾“å‡º JSON å¡«å……è¡¨å•**ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

\`\`\`json
{"action":"fill_goal","data":{"title":"ç›®æ ‡æ ‡é¢˜","description":"æè¿°ï¼ˆå¯é€‰ï¼‰","type":"team","agentIds":["agentId1"],"status":"active","startAt":"2026-03-01T00:00:00Z","endAt":"2026-06-30T00:00:00Z","progress":0,"milestones":[{"title":"é‡Œç¨‹ç¢‘1","dueAt":"2026-04-01T00:00:00Z","done":false}]}}
\`\`\`

- type: "personal"ï¼ˆä¸ªäººï¼‰æˆ– "team"ï¼ˆå›¢é˜Ÿï¼‰
- status: "draft" / "active" / "completed" / "cancelled"
- agentIds: å‚ä¸Žæˆå‘˜çš„ ID åˆ—è¡¨
- æ—¶é—´æ ¼å¼ï¼šISO 8601ï¼ˆå¦‚ "2026-03-01T00:00:00Z"ï¼‰
- è¾“å‡º JSON åŽï¼Œé¡µé¢ä¼šè‡ªåŠ¨å¡«å……è¡¨å•ï¼Œç”¨æˆ·ç¡®è®¤åŽä¿å­˜

### API æ“ä½œï¼ˆå¦‚éœ€ç›´æŽ¥æ›´æ–°å·²æœ‰ç›®æ ‡ï¼‰

**æ›´æ–°è¿›åº¦ï¼š**
\`\`\`bash
curl -s -X PATCH ${e}/api/goals/{id}/progress -H "Authorization: Bearer ${a}" -H "Content-Type: application/json" -d '{"progress":50}'
\`\`\`

**æ·»åŠ å®šæœŸæ£€æŸ¥ï¼š**
\`\`\`bash
curl -s -X POST ${e}/api/goals/{id}/checks -H "Authorization: Bearer ${a}" -H "Content-Type: application/json" -d '{"name":"æ¯å‘¨æ£€æŸ¥","schedule":"0 9 * * 1","agentId":"agentId","tz":"Asia/Shanghai","prompt":"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€æœ¬å‘¨è¿›å±•","enabled":true}'
\`\`\`

### å½“å‰å›¢é˜Ÿæˆå‘˜
${u}
${r}

**å·¥ä½œæµç¨‹ï¼š**
1. ç”¨æˆ·æè¿°ç›®æ ‡ â†’ ä½ è¾“å‡º fill_goal JSON â†’ é¡µé¢è‡ªåŠ¨å¡«è¡¨
2. ç”¨æˆ·ç¡®è®¤å†…å®¹åŽè‡ªè¡Œç‚¹å‡»ã€Œåˆ›å»ºã€æˆ–ã€Œä¿å­˜ã€æŒ‰é’®
3. å¦‚éœ€æ›´æ–°å·²å­˜åœ¨ç›®æ ‡çš„è¿›åº¦/æ£€æŸ¥ï¼Œä½¿ç”¨ API æ“ä½œ`.trim()});at(async()=>{const a=await st.list().catch(()=>({data:[]}));x.value=(a.data||[]).filter(e=>!e.system),Y.value=x.value[0]?.id||"",await S()}),nt(O,async a=>{a==="records"&&i.value&&await Ue(i.value.id)});async function S(){try{const a=await M.list();if(J.value=a.data||[],i.value){const e=J.value.find(u=>u.id===i.value.id);e&&(i.value=e)}}catch{}}async function Ue(a){oe.value=!0;try{const e=await M.listCheckRecords(a);ee.value=(e.data||[]).slice().reverse()}catch{ee.value=[]}finally{oe.value=!1}}function de(a){i.value=a,H.value=!1,O.value="basic",Object.assign(o,{title:a.title,description:a.description||"",type:a.type,agentIds:[...a.agentIds||[]],status:a.status,progress:a.progress,startAt:D(a.startAt)?a.startAt:"",endAt:D(a.endAt)?a.endAt:"",milestones:(a.milestones||[]).map(e=>({...e}))})}function ie(){i.value=null,H.value=!0,O.value="basic",Object.assign(o,{title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]})}async function ye(){if(!o.title.trim()){A.warning("è¯·å¡«å†™ç›®æ ‡æ ‡é¢˜");return}Q.value=!0;const a={title:o.title,description:o.description||void 0,type:o.type,agentIds:o.agentIds,status:o.status,progress:o.progress,startAt:o.startAt||void 0,endAt:o.endAt||void 0,milestones:o.milestones.map(e=>({...e,id:e.id||"ms-"+Math.random().toString(36).slice(2,10)}))};try{if(i.value)await M.update(i.value.id,a),A.success("ä¿å­˜æˆåŠŸ"),await S();else{const e=await M.create(a);A.success("åˆ›å»ºæˆåŠŸ"),H.value=!1,await S();const u=J.value.find(r=>r.id===e.data.id)||e.data;de(u)}}catch(e){A.error(e.response?.data?.error||"æ“ä½œå¤±è´¥")}finally{Q.value=!1}}async function Me(){if(i.value)try{await M.delete(i.value.id),A.success("å·²åˆ é™¤"),i.value=null,await S()}catch{A.error("åˆ é™¤å¤±è´¥")}}function be(){o.milestones.push({id:"ms-"+Math.random().toString(36).slice(2,10),title:"",dueAt:"",done:!1,agentIds:[]})}function $e(){Object.assign(h,{name:"",agentId:x.value[0]?.id||"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€çš„è¿›å±•æƒ…å†µï¼ˆå½“å‰è¿›åº¦ {goal.progress}ï¼‰ï¼Œè·æˆªæ­¢æ—¥æœŸ {goal.endAt} è¿˜æœ‰ä¸€æ®µæ—¶é—´ï¼Œè¯·æ€»ç»“è¿‘æœŸè¿›å±•å¹¶å»ºè®®ä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚",enabled:!0}),te.value="0 9 * * 1",Z.value=!0}function De(a){a!=="custom"&&(h.schedule=a)}async function Ye(){if(!h.name.trim()){A.warning("è¯·å¡«å†™æ£€æŸ¥åç§°");return}if(!h.agentId){A.warning("è¯·é€‰æ‹©æ‰§è¡Œæˆå‘˜");return}if(i.value)try{await M.addCheck(i.value.id,{...h}),A.success("æ·»åŠ æˆåŠŸ"),Z.value=!1;const a=await M.get(i.value.id);i.value=a.data,await S()}catch(a){A.error(a.response?.data?.error||"æ·»åŠ å¤±è´¥")}}async function Se(a){if(i.value)try{await M.updateCheck(i.value.id,a.id,{enabled:a.enabled})}catch{A.error("æ›´æ–°å¤±è´¥")}}async function Ne(a){if(i.value)try{await M.runCheck(i.value.id,a.id),A.success("å·²è§¦å‘æ£€æŸ¥")}catch(e){A.error(e.response?.data?.error||"è§¦å‘å¤±è´¥")}}async function He(a){if(i.value)try{await ut.confirm(`ç¡®å®šåˆ é™¤æ£€æŸ¥è®¡åˆ’ã€Œ${a.name}ã€ï¼Ÿ`,"åˆ é™¤ç¡®è®¤",{type:"warning"}),await M.removeCheck(i.value.id,a.id),A.success("å·²åˆ é™¤");const e=await M.get(i.value.id);i.value=e.data,await S()}catch(e){e!=="cancel"&&A.error("åˆ é™¤å¤±è´¥")}}const he=N(()=>Y.value?i.value?`goal-${i.value.id}-${Y.value}`:`goals-new-${Y.value}`:"");function Le(a){setTimeout(()=>S(),2e3);const e=m=>{try{const g=JSON.parse(m);if(g.action==="fill_goal"&&g.data)return Ee(g.data),!0}catch{}return!1},u=a.match(/```(?:json)?\s*(\{[\s\S]*?\})\s*```/);if(u?.[1]&&e(u[1]))return;const r=a.match(/(\{"action"\s*:\s*"fill_goal"[\s\S]*?\})/);r?.[1]&&e(r[1])}function Ee(a){!H.value&&!i.value&&ie(),a.title&&(o.title=a.title),a.description&&(o.description=a.description),a.type&&(o.type=a.type),a.status&&(o.status=a.status),typeof a.progress=="number"&&(o.progress=a.progress),a.agentIds&&Array.isArray(a.agentIds)&&(o.agentIds=a.agentIds),a.startAt&&(o.startAt=a.startAt),a.endAt&&(o.endAt=a.endAt),a.milestones&&Array.isArray(a.milestones)&&(o.milestones=a.milestones.map(e=>({id:e.id||"ms-"+Math.random().toString(36).slice(2,10),title:e.title||"",dueAt:e.dueAt||"",done:!!e.done,agentIds:e.agentIds||[]}))),A.success("AI å·²å¡«å†™è¡¨å•ï¼Œç¡®è®¤åŽç‚¹å‡»ä¿å­˜")}function D(a){if(!a)return!1;const e=new Date(a);return!isNaN(e.getTime())&&e.getFullYear()>1970}function Fe(a){return D(a.startAt)&&D(a.endAt)}function Be(a){const{start:e,end:u}=E.value,r=u.getTime()-e.getTime();return Math.max(1,(new Date(a.endAt).getTime()-new Date(a.startAt).getTime())/r*100)}function Ge(a){const{start:e,end:u}=E.value,r=u.getTime()-e.getTime(),m=new Date(a.startAt).getTime(),g=new Date(a.endAt).getTime(),w=Math.max(0,(m-e.getTime())/r*100),U=Math.max(1,(g-m)/r*100),p=a.agentIds?.[0]&&L.value[a.agentIds[0]]?L.value[a.agentIds[0]]:"#409eff",F=a.agentIds?.[1]&&L.value[a.agentIds[1]]?L.value[a.agentIds[1]]:p;return{left:`${w}%`,width:`${U}%`,background:a.agentIds?.length>1?`linear-gradient(90deg,${p},${F})`:p}}function Oe(a){const{start:e,end:u}=E.value;return D(a.dueAt)?`${(new Date(a.dueAt).getTime()-e.getTime())/(u.getTime()-e.getTime())*100}%`:"-100%"}function Ze(a,e){const u=[],r=new Date(a.getFullYear(),a.getMonth(),1),m=e.getTime()-a.getTime();for(;r<=e;){const g=(r.getTime()-a.getTime())/m*100;g>=0&&g<=100&&u.push({label:`${r.getFullYear()}/${r.getMonth()+1}`,left:`${g}%`}),r.setMonth(r.getMonth()+1)}return u}function je(a){return a.status==="completed"?"#67c23a":a.progress>=80?"#409eff":a.progress>=40?"#e6a23c":"#909399"}function Re(a){return{draft:"è‰ç¨¿",active:"è¿›è¡Œä¸­",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"}[a]??a}function Pe(a){return{draft:"info",active:"",completed:"success",cancelled:"danger"}[a]??"info"}function Ve(a){return D(a)?new Date(a).toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}):"â€”"}function qe(a){if(!a)return"";const e=new Date(a);return isNaN(e.getTime())?"":e.toLocaleString("zh-CN")}return(a,e)=>{const u=f("el-icon"),r=f("el-button"),m=f("el-option"),g=f("el-select"),w=f("el-tag"),U=f("el-input"),p=f("el-form-item"),F=f("el-radio-button"),we=f("el-radio-group"),B=f("el-date-picker"),ke=f("el-slider"),Ae=f("el-checkbox"),ue=f("el-form"),Xe=f("el-popconfirm"),re=f("el-tab-pane"),P=f("el-table-column"),Je=f("el-text"),Ce=f("el-switch"),We=f("el-table"),Ie=f("el-empty"),Ke=f("el-timeline-item"),Qe=f("el-timeline"),et=f("el-tabs"),tt=f("el-dialog");return d(),c("div",ct,[n("div",{class:"gs-sidebar",style:z({width:ae.value+"px"})},[n("div",pt,[e[32]||(e[32]=n("span",{class:"sidebar-title"},"ç›®æ ‡è§„åˆ’",-1)),n("div",vt,[l(r,{size:"small",circle:"",onClick:S},{default:s(()=>[l(u,null,{default:s(()=>[l(V(ot))]),_:1})]),_:1}),l(r,{size:"small",type:"primary",circle:"",onClick:ie},{default:s(()=>[l(u,null,{default:s(()=>[l(V(X))]),_:1})]),_:1})])]),n("div",ft,[l(g,{modelValue:W.value,"onUpdate:modelValue":e[0]||(e[0]=t=>W.value=t),placeholder:"æ‰€æœ‰çŠ¶æ€",clearable:"",size:"small",class:"filter-sel"},{default:s(()=>[l(m,{label:"è‰ç¨¿",value:"draft"}),l(m,{label:"è¿›è¡Œä¸­",value:"active"}),l(m,{label:"å·²å®Œæˆ",value:"completed"}),l(m,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"]),l(g,{modelValue:K.value,"onUpdate:modelValue":e[1]||(e[1]=t=>K.value=t),placeholder:"æ‰€æœ‰æˆå‘˜",clearable:"",size:"small",class:"filter-sel"},{default:s(()=>[(d(!0),c(b,null,C(x.value,t=>(d(),T(m,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",gt,[R.value.length===0?(d(),c("div",_t,"æš‚æ— ç›®æ ‡")):$("",!0),(d(!0),c(b,null,C(R.value,t=>(d(),c("div",{key:t.id,class:q(["goal-item",{active:i.value?.id===t.id}]),onClick:v=>de(t)},[n("div",bt,[n("span",ht,y(t.title),1),l(w,{type:Pe(t.status),size:"small",effect:"plain"},{default:s(()=>[_(y(Re(t.status)),1)]),_:2},1032,["type"])]),n("div",Vt,[n("div",{class:"gi-progress-bar",style:z({width:t.progress+"%",background:je(t)})},null,4),n("span",wt,y(t.progress)+"%",1)]),n("div",kt,[n("div",At,[(d(!0),c(b,null,C((t.agentIds||[]).slice(0,3),v=>(d(),c("div",{key:v,class:"gi-avatar",style:z({background:L.value[v]||"#6366f1"})},y((j.value[v]||v)[0]),5))),128)),(t.agentIds||[]).length>3?(d(),c("span",Ct,"+"+y(t.agentIds.length-3),1)):$("",!0)]),n("span",It,y(Ve(t.startAt))+" â€” "+y(Ve(t.endAt)),1)])],10,yt))),128))])],4),n("div",{class:q(["gs-handle",{dragging:G.value==="side"}]),onMousedown:e[2]||(e[2]=t=>pe(t,"side"))},[...e[33]||(e[33]=[n("div",{class:"gs-handle-bar"},null,-1)])],34),n("div",Tt,[!i.value&&!H.value?(d(),c("div",zt,[n("div",xt,[n("span",Ut,[l(u,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:s(()=>[l(V(le))]),_:1}),e[34]||(e[34]=_(" ç›®æ ‡æ€»è§ˆ Â· ç”˜ç‰¹å›¾ ",-1))]),l(r,{type:"primary",size:"small",onClick:ie},{default:s(()=>[l(u,null,{default:s(()=>[l(V(X))]),_:1}),e[35]||(e[35]=_(" æ–°å»ºç›®æ ‡ ",-1))]),_:1})]),R.value.length===0?(d(),c("div",Mt,[l(u,{size:"48",color:"#c0c4cc"},{default:s(()=>[l(V(le))]),_:1}),e[36]||(e[36]=n("p",null,"æš‚æ— ç›®æ ‡ï¼Œç‚¹å‡»æ–°å»ºå¼€å§‹è§„åˆ’",-1))])):(d(),c("div",$t,[n("div",Dt,[e[37]||(e[37]=n("div",{class:"gantt-label-col"},null,-1)),n("div",Yt,[n("div",St,[(d(!0),c(b,null,C(ge.value,t=>(d(),c("div",{key:t.label,class:"gantt-month-label",style:z({left:t.left})},y(t.label),5))),128))])])]),n("div",Nt,[n("div",Ht,[e[38]||(e[38]=n("div",{class:"gantt-label-col"},null,-1)),n("div",Lt,[(d(!0),c(b,null,C(ge.value,t=>(d(),c("div",{key:"gv-"+t.label,class:"gantt-grid-line",style:z({left:t.left})},null,4))),128)),_e.value!==null?(d(),c("div",{key:0,class:"gantt-today-line",style:z({left:_e.value})},null,4)):$("",!0)])]),(d(!0),c(b,null,C(R.value,t=>(d(),c("div",{key:t.id,class:"gantt-row",onClick:v=>de(t)},[n("div",Ft,[n("div",Bt,[n("div",Gt,[(d(!0),c(b,null,C((t.agentIds||[]).slice(0,2),v=>(d(),c("div",{key:v,class:"gantt-avatar",style:z({background:L.value[v]||"#409eff"})},y((j.value[v]||v).slice(0,1)),5))),128))]),n("span",Ot,y(t.title),1),n("span",{class:q(["gantt-pct","s-"+t.status])},y(t.progress)+"%",3)])]),n("div",Zt,[Fe(t)?(d(),c(b,{key:0},[n("div",{class:"gantt-bar",style:z(Ge(t))},[n("div",{class:"gantt-bar-progress",style:z({width:t.progress+"%"})},null,4),Be(t)>8?(d(),c("span",jt,y(t.title),1)):$("",!0)],4),(d(!0),c(b,null,C(t.milestones||[],v=>(d(),c(b,{key:v.id},[D(v.dueAt)?(d(),c("div",{key:0,class:q(["gantt-milestone",{done:v.done}]),style:z({left:Oe(v)}),title:v.title},null,14,Rt)):$("",!0)],64))),128))],64)):(d(),c("div",Pt,"æœªè®¾ç½®æ—¶é—´èŒƒå›´"))])],8,Et))),128))])]))])):H.value?(d(),c(b,{key:1},[n("div",qt,[n("div",Xt,[l(u,{style:{color:"#909399"}},{default:s(()=>[l(V(le))]),_:1}),e[39]||(e[39]=n("span",{class:"crumb-sep"},"æ–°å»º",-1)),e[40]||(e[40]=n("span",{class:"crumb-name"},"ç›®æ ‡",-1))]),n("div",Jt,[l(r,{size:"small",onClick:e[3]||(e[3]=t=>H.value=!1)},{default:s(()=>[...e[41]||(e[41]=[_("å–æ¶ˆ",-1)])]),_:1}),l(r,{size:"small",type:"primary",loading:Q.value,onClick:ye},{default:s(()=>[l(u,null,{default:s(()=>[l(V(Te))]),_:1}),e[42]||(e[42]=_(" åˆ›å»º ",-1))]),_:1},8,["loading"])])]),n("div",Wt,[l(ue,{model:o,"label-width":"90px",size:"small",class:"goal-inner-form"},{default:s(()=>[l(p,{label:"æ ‡é¢˜",required:""},{default:s(()=>[l(U,{modelValue:o.title,"onUpdate:modelValue":e[4]||(e[4]=t=>o.title=t),placeholder:"ç›®æ ‡æ ‡é¢˜"},null,8,["modelValue"])]),_:1}),l(p,{label:"æè¿°"},{default:s(()=>[l(U,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=t=>o.description=t),type:"textarea",rows:2,placeholder:"ï¼ˆå¯é€‰ï¼‰"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç±»åž‹"},{default:s(()=>[l(we,{modelValue:o.type,"onUpdate:modelValue":e[6]||(e[6]=t=>o.type=t)},{default:s(()=>[l(F,{value:"personal"},{default:s(()=>[...e[43]||(e[43]=[_("ä¸ªäºº",-1)])]),_:1}),l(F,{value:"team"},{default:s(()=>[...e[44]||(e[44]=[_("å›¢é˜Ÿ",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å‚ä¸Žæˆå‘˜"},{default:s(()=>[l(g,{modelValue:o.agentIds,"onUpdate:modelValue":e[7]||(e[7]=t=>o.agentIds=t),multiple:"",placeholder:"é€‰æ‹©æˆå‘˜",style:{width:"100%"}},{default:s(()=>[(d(!0),c(b,null,C(x.value,t=>(d(),T(m,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"çŠ¶æ€"},{default:s(()=>[l(g,{modelValue:o.status,"onUpdate:modelValue":e[8]||(e[8]=t=>o.status=t),style:{width:"100%"}},{default:s(()=>[l(m,{label:"è‰ç¨¿",value:"draft"}),l(m,{label:"è¿›è¡Œä¸­",value:"active"}),l(m,{label:"å·²å®Œæˆ",value:"completed"}),l(m,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å¼€å§‹æ—¶é—´"},{default:s(()=>[l(B,{modelValue:o.startAt,"onUpdate:modelValue":e[9]||(e[9]=t=>o.startAt=t),type:"datetime",placeholder:"é€‰æ‹©å¼€å§‹æ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç»“æŸæ—¶é—´"},{default:s(()=>[l(B,{modelValue:o.endAt,"onUpdate:modelValue":e[10]||(e[10]=t=>o.endAt=t),type:"datetime",placeholder:"é€‰æ‹©ç»“æŸæ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),i.value?(d(),T(p,{key:0,label:"è¿›åº¦"},{default:s(()=>[l(ke,{modelValue:o.progress,"onUpdate:modelValue":e[11]||(e[11]=t=>o.progress=t),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1})):$("",!0),l(p,{label:"é‡Œç¨‹ç¢‘"},{default:s(()=>[n("div",Kt,[(d(!0),c(b,null,C(o.milestones,(t,v)=>(d(),c("div",{key:v,class:"milestone-row"},[l(Ae,{modelValue:t.done,"onUpdate:modelValue":I=>t.done=I},null,8,["modelValue","onUpdate:modelValue"]),l(U,{modelValue:t.title,"onUpdate:modelValue":I=>t.title=I,placeholder:"é‡Œç¨‹ç¢‘æ ‡é¢˜",size:"small",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),l(B,{modelValue:t.dueAt,"onUpdate:modelValue":I=>t.dueAt=I,type:"date",placeholder:"æˆªæ­¢æ—¥",size:"small",style:{width:"130px"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue","onUpdate:modelValue"]),l(r,{type:"danger",size:"small",circle:"",onClick:I=>o.milestones.splice(v,1)},{default:s(()=>[l(u,null,{default:s(()=>[l(V(me))]),_:1})]),_:1},8,["onClick"])]))),128)),l(r,{size:"small",onClick:be,style:{"margin-top":"4px"}},{default:s(()=>[l(u,null,{default:s(()=>[l(V(X))]),_:1}),e[45]||(e[45]=_(" æ·»åŠ é‡Œç¨‹ç¢‘ ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])])],64)):i.value?(d(),c(b,{key:2},[n("div",Qt,[n("div",el,[l(u,{style:{color:"#909399"}},{default:s(()=>[l(V(le))]),_:1}),e[46]||(e[46]=n("span",{class:"crumb-sep"},"ç›®æ ‡",-1)),n("span",tl,y(i.value.title),1)]),n("div",ll,[l(r,{size:"small",type:"primary",loading:Q.value,onClick:ye},{default:s(()=>[l(u,null,{default:s(()=>[l(V(Te))]),_:1}),e[47]||(e[47]=_(" ä¿å­˜ ",-1))]),_:1},8,["loading"]),l(Xe,{title:`ç¡®è®¤åˆ é™¤ã€Œ${i.value.title}ã€ï¼Ÿ`,onConfirm:Me},{reference:s(()=>[l(r,{size:"small",type:"danger",plain:""},{default:s(()=>[l(u,null,{default:s(()=>[l(V(me))]),_:1})]),_:1})]),_:1},8,["title"])])]),l(et,{modelValue:O.value,"onUpdate:modelValue":e[20]||(e[20]=t=>O.value=t),class:"editor-tabs"},{default:s(()=>[l(re,{label:"åŸºæœ¬ä¿¡æ¯",name:"basic"},{default:s(()=>[n("div",al,[l(ue,{model:o,"label-width":"90px",size:"small",class:"goal-inner-form"},{default:s(()=>[l(p,{label:"æ ‡é¢˜",required:""},{default:s(()=>[l(U,{modelValue:o.title,"onUpdate:modelValue":e[12]||(e[12]=t=>o.title=t),placeholder:"ç›®æ ‡æ ‡é¢˜"},null,8,["modelValue"])]),_:1}),l(p,{label:"æè¿°"},{default:s(()=>[l(U,{modelValue:o.description,"onUpdate:modelValue":e[13]||(e[13]=t=>o.description=t),type:"textarea",rows:2,placeholder:"ï¼ˆå¯é€‰ï¼‰"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç±»åž‹"},{default:s(()=>[l(we,{modelValue:o.type,"onUpdate:modelValue":e[14]||(e[14]=t=>o.type=t)},{default:s(()=>[l(F,{value:"personal"},{default:s(()=>[...e[48]||(e[48]=[_("ä¸ªäºº",-1)])]),_:1}),l(F,{value:"team"},{default:s(()=>[...e[49]||(e[49]=[_("å›¢é˜Ÿ",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å‚ä¸Žæˆå‘˜"},{default:s(()=>[l(g,{modelValue:o.agentIds,"onUpdate:modelValue":e[15]||(e[15]=t=>o.agentIds=t),multiple:"",placeholder:"é€‰æ‹©æˆå‘˜",style:{width:"100%"}},{default:s(()=>[(d(!0),c(b,null,C(x.value,t=>(d(),T(m,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"çŠ¶æ€"},{default:s(()=>[l(g,{modelValue:o.status,"onUpdate:modelValue":e[16]||(e[16]=t=>o.status=t),style:{width:"100%"}},{default:s(()=>[l(m,{label:"è‰ç¨¿",value:"draft"}),l(m,{label:"è¿›è¡Œä¸­",value:"active"}),l(m,{label:"å·²å®Œæˆ",value:"completed"}),l(m,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å¼€å§‹æ—¶é—´"},{default:s(()=>[l(B,{modelValue:o.startAt,"onUpdate:modelValue":e[17]||(e[17]=t=>o.startAt=t),type:"datetime",placeholder:"é€‰æ‹©å¼€å§‹æ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç»“æŸæ—¶é—´"},{default:s(()=>[l(B,{modelValue:o.endAt,"onUpdate:modelValue":e[18]||(e[18]=t=>o.endAt=t),type:"datetime",placeholder:"é€‰æ‹©ç»“æŸæ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),i.value?(d(),T(p,{key:0,label:"è¿›åº¦"},{default:s(()=>[l(ke,{modelValue:o.progress,"onUpdate:modelValue":e[19]||(e[19]=t=>o.progress=t),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1})):$("",!0),l(p,{label:"é‡Œç¨‹ç¢‘"},{default:s(()=>[n("div",sl,[(d(!0),c(b,null,C(o.milestones,(t,v)=>(d(),c("div",{key:v,class:"milestone-row"},[l(Ae,{modelValue:t.done,"onUpdate:modelValue":I=>t.done=I},null,8,["modelValue","onUpdate:modelValue"]),l(U,{modelValue:t.title,"onUpdate:modelValue":I=>t.title=I,placeholder:"é‡Œç¨‹ç¢‘æ ‡é¢˜",size:"small",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),l(B,{modelValue:t.dueAt,"onUpdate:modelValue":I=>t.dueAt=I,type:"date",placeholder:"æˆªæ­¢æ—¥",size:"small",style:{width:"130px"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue","onUpdate:modelValue"]),l(r,{type:"danger",size:"small",circle:"",onClick:I=>o.milestones.splice(v,1)},{default:s(()=>[l(u,null,{default:s(()=>[l(V(me))]),_:1})]),_:1},8,["onClick"])]))),128)),l(r,{size:"small",onClick:be,style:{"margin-top":"4px"}},{default:s(()=>[l(u,null,{default:s(()=>[l(V(X))]),_:1}),e[50]||(e[50]=_(" æ·»åŠ é‡Œç¨‹ç¢‘ ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1}),l(re,{label:"å®šæœŸæ£€æŸ¥",name:"checks"},{default:s(()=>[n("div",nl,[n("div",ol,[l(r,{type:"primary",size:"small",onClick:$e},{default:s(()=>[l(u,null,{default:s(()=>[l(V(X))]),_:1}),e[51]||(e[51]=_(" æ·»åŠ æ£€æŸ¥ ",-1))]),_:1})]),l(We,{data:i.value.checks,size:"small",stripe:"",class:"checks-table"},{default:s(()=>[l(P,{prop:"name",label:"åç§°","min-width":"120"}),l(P,{label:"é¢‘çŽ‡","min-width":"140"},{default:s(({row:t})=>[n("code",dl,y(t.schedule),1),l(Je,{type:"info",size:"small",style:{"margin-left":"4px"}},{default:s(()=>[_(y(t.tz||"Asia/Shanghai"),1)]),_:2},1024)]),_:1}),l(P,{label:"æˆå‘˜",width:"90"},{default:s(({row:t})=>[_(y(j.value[t.agentId]||t.agentId),1)]),_:1}),l(P,{label:"å¯ç”¨",width:"60"},{default:s(({row:t})=>[l(Ce,{modelValue:t.enabled,"onUpdate:modelValue":v=>t.enabled=v,size:"small",onChange:v=>Se(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(P,{label:"æ“ä½œ",width:"130"},{default:s(({row:t})=>[l(r,{size:"small",link:"",onClick:v=>Ne(t)},{default:s(()=>[...e[52]||(e[52]=[_("ç«‹å³è¿è¡Œ",-1)])]),_:1},8,["onClick"]),l(r,{size:"small",link:"",type:"danger",onClick:v=>He(t)},{default:s(()=>[...e[53]||(e[53]=[_("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),i.value.checks?.length?$("",!0):(d(),T(Ie,{key:0,description:"æš‚æ— æ£€æŸ¥è®¡åˆ’","image-size":60}))])]),_:1}),l(re,{label:"æ£€æŸ¥è®°å½•",name:"records"},{default:s(()=>[n("div",il,[oe.value?(d(),c("div",ul,[l(u,{class:"is-loading",size:"24"},{default:s(()=>[l(V(dt))]),_:1})])):ee.value.length?(d(),T(Qe,{key:1,class:"records-timeline"},{default:s(()=>[(d(!0),c(b,null,C(ee.value,t=>(d(),T(Ke,{key:t.id,timestamp:qe(t.runAt),type:t.status==="ok"?"success":"danger",placement:"top"},{default:s(()=>[n("div",rl,[n("div",ml,[n("div",{class:"rec-avatar",style:z({background:L.value[t.agentId]||"#409eff"})},y((j.value[t.agentId]||"?")[0]),5),n("span",cl,y(j.value[t.agentId]||t.agentId),1),l(w,{type:t.status==="ok"?"success":"danger",size:"small"},{default:s(()=>[_(y(t.status),1)]),_:2},1032,["type"])]),n("div",pl,y(t.output||"ï¼ˆæ— è¾“å‡ºï¼‰"),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})):(d(),T(Ie,{key:2,description:"æš‚æ— æ£€æŸ¥è®°å½•","image-size":60}))])]),_:1})]),_:1},8,["modelValue"])],64)):$("",!0)]),n("div",{class:q(["gs-handle",{dragging:G.value==="chat"}]),onMousedown:e[21]||(e[21]=t=>pe(t,"chat"))},[...e[54]||(e[54]=[n("div",{class:"gs-handle-bar"},null,-1)])],34),n("div",{class:"gs-chat",style:z({width:se.value+"px"})},[n("div",vl,[l(u,null,{default:s(()=>[l(V(it))]),_:1}),e[55]||(e[55]=n("span",null,"AI ç›®æ ‡åŠ©æ‰‹",-1)),l(g,{modelValue:Y.value,"onUpdate:modelValue":e[22]||(e[22]=t=>Y.value=t),size:"small",style:{"margin-left":"auto",width:"110px"},placeholder:"é€‰æ‹©æˆå‘˜"},{default:s(()=>[(d(!0),c(b,null,C(x.value,t=>(d(),T(m,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",fl,[Y.value?(d(),T(rt,{key:he.value,"agent-id":Y.value,"session-id":he.value,context:xe.value,"welcome-message":i.value?`æ­£åœ¨æŸ¥çœ‹ç›®æ ‡ã€Œ${i.value.title}ã€ï¼Œæˆ‘å¯ä»¥å¸®ä½ ä¿®æ”¹ç›®æ ‡ä¿¡æ¯ã€æ·»åŠ é‡Œç¨‹ç¢‘æˆ–è®¾ç½®å®šæœŸæ£€æŸ¥ã€‚`:"ä½ å¥½ï¼æˆ‘å¯ä»¥å¸®ä½ åˆ›å»ºç›®æ ‡ï¼Œè¯´ä¸€ä¸‹éœ€æ±‚å³å¯ï¼Œæˆ‘ä¼šè‡ªåŠ¨å¡«å†™è¡¨å•ã€‚",examples:i.value?["å¸®æˆ‘æŠŠè¿›åº¦æ›´æ–°åˆ° 60%","æ·»åŠ 3ä¸ªé‡Œç¨‹ç¢‘","æ¯å‘¨ä¸€æ£€æŸ¥è¿™ä¸ªç›®æ ‡"]:["å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå›¢é˜Ÿç›®æ ‡ï¼šQ2ç”¨æˆ·å¢žé•¿ï¼Œ3æœˆ1æ—¥åˆ°6æœˆ30æ—¥","ä¸ªäººç›®æ ‡ï¼šå­¦ä¹  Go è¯­è¨€ï¼Œæœ¬æœˆå®Œæˆ"],height:"100%",onResponse:Le},null,8,["agent-id","session-id","context","welcome-message","examples"])):$("",!0)])],4),l(tt,{modelValue:Z.value,"onUpdate:modelValue":e[31]||(e[31]=t=>Z.value=t),title:"æ·»åŠ å®šæœŸæ£€æŸ¥",width:"480px"},{footer:s(()=>[l(r,{onClick:e[30]||(e[30]=t=>Z.value=!1)},{default:s(()=>[...e[57]||(e[57]=[_("å–æ¶ˆ",-1)])]),_:1}),l(r,{type:"primary",onClick:Ye},{default:s(()=>[...e[58]||(e[58]=[_("æ·»åŠ ",-1)])]),_:1})]),default:s(()=>[l(ue,{model:h,"label-width":"90px",size:"small"},{default:s(()=>[l(p,{label:"åç§°",required:""},{default:s(()=>[l(U,{modelValue:h.name,"onUpdate:modelValue":e[23]||(e[23]=t=>h.name=t),placeholder:"å¦‚ï¼šæ¯å‘¨è¿›åº¦æ£€æŸ¥"},null,8,["modelValue"])]),_:1}),l(p,{label:"æ‰§è¡Œæˆå‘˜",required:""},{default:s(()=>[l(g,{modelValue:h.agentId,"onUpdate:modelValue":e[24]||(e[24]=t=>h.agentId=t),style:{width:"100%"}},{default:s(()=>[(d(!0),c(b,null,C(x.value,t=>(d(),T(m,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"æ£€æŸ¥é¢‘çŽ‡"},{default:s(()=>[l(g,{modelValue:te.value,"onUpdate:modelValue":e[25]||(e[25]=t=>te.value=t),style:{width:"100%"},onChange:De},{default:s(()=>[l(m,{label:"æ¯å¤©ä¸Šåˆ9ç‚¹",value:"0 9 * * *"}),l(m,{label:"æ¯å‘¨ä¸€ä¸Šåˆ9ç‚¹",value:"0 9 * * 1"}),l(m,{label:"æ¯å‘¨äº”ä¸‹åˆ5ç‚¹",value:"0 17 * * 5"}),l(m,{label:"æ¯æœˆ1æ—¥ä¸Šåˆ9ç‚¹",value:"0 9 1 * *"}),l(m,{label:"è‡ªå®šä¹‰",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),te.value==="custom"?(d(),T(p,{key:0,label:"Cron"},{default:s(()=>[l(U,{modelValue:h.schedule,"onUpdate:modelValue":e[26]||(e[26]=t=>h.schedule=t),placeholder:"0 9 * * 1"},null,8,["modelValue"])]),_:1})):$("",!0),l(p,{label:"æ—¶åŒº"},{default:s(()=>[l(g,{modelValue:h.tz,"onUpdate:modelValue":e[27]||(e[27]=t=>h.tz=t),style:{width:"100%"}},{default:s(()=>[l(m,{label:"Asia/Shanghai",value:"Asia/Shanghai"}),l(m,{label:"UTC",value:"UTC"}),l(m,{label:"America/New_York",value:"America/New_York"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"æ£€æŸ¥æç¤ºè¯"},{default:s(()=>[l(U,{modelValue:h.prompt,"onUpdate:modelValue":e[28]||(e[28]=t=>h.prompt=t),type:"textarea",rows:3,placeholder:"å¯ç”¨å˜é‡ï¼š{goal.title} {goal.progress} {goal.endAt}"},null,8,["modelValue"]),e[56]||(e[56]=n("div",{style:{"font-size":"11px",color:"#94a3b8","margin-top":"3px"}}," å˜é‡ï¼š{goal.title} {goal.progress} {goal.endAt} {goal.startAt} {goal.status} ",-1))]),_:1}),l(p,{label:"å¯ç”¨"},{default:s(()=>[l(Ce,{modelValue:h.enabled,"onUpdate:modelValue":e[29]||(e[29]=t=>h.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Vl=mt(gl,[["__scopeId","data-v-5437da9f"]]);export{Vl as default};
