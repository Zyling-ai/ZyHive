import{d as lt,o as at,A as st,P as nt,ac as $,c as r,e as n,b as l,w as s,t as _,g as T,F as b,q as C,p as x,z as q,f as y,l as z,r as k,y as ze,I as H,h as f,i as d,n as w,a1 as ot,K as X,ad as le,ae as Te,af as me,U as dt,ab as it,E as A,B as ut}from"./index-DU4MpSwp.js";import{A as rt}from"./AiChat-ft_oI9rS.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ct={class:"goals-studio"},pt={class:"sidebar-top"},vt={class:"sidebar-acts"},ft={class:"gs-filter"},gt={class:"goal-list"},_t={key:0,class:"goal-item goal-item-new active"},yt={class:"gi-top"},bt={class:"gi-title gi-title-new"},ht={key:1,class:"list-empty"},Vt=["onClick"],wt={class:"gi-top"},kt={class:"gi-title"},At={class:"gi-progress-wrap"},Ct={class:"gi-progress-num"},It={class:"gi-bottom"},zt={class:"gi-avatars"},Tt={key:0,class:"gi-avatar-more"},xt={class:"gi-dates"},Ut={class:"gs-editor"},Mt={key:0,class:"editor-gantt-overview"},$t={class:"overview-header"},Dt={class:"overview-title"},Yt={key:0,class:"gantt-empty"},St={key:1,class:"gantt-wrap"},Nt={class:"gantt-header"},Ht={class:"gantt-timeline-col"},Lt={class:"gantt-months"},Bt={class:"gantt-body"},Et={class:"gantt-overlay","aria-hidden":"true"},Ft={class:"gantt-timeline-col",style:{position:"relative"}},Gt=["onClick"],Ot={class:"gantt-label-col"},Zt={class:"gantt-label-inner"},jt={class:"gantt-agent-avatars"},Rt={class:"gantt-goal-name"},Pt={class:"gantt-timeline-col"},qt={key:0,class:"gantt-bar-label"},Xt=["title"],Jt={key:1,class:"gantt-no-date"},Wt={class:"editor-toolbar"},Kt={class:"editor-breadcrumb"},Qt={class:"toolbar-acts"},el={class:"editor-form"},tl={style:{width:"100%"}},ll={class:"editor-toolbar"},al={class:"editor-breadcrumb"},sl={class:"crumb-name"},nl={class:"toolbar-acts"},ol={class:"editor-form"},dl={style:{width:"100%"}},il={class:"tab-panel"},ul={class:"tab-panel-head"},rl={class:"code-cell"},ml={class:"tab-panel"},cl={key:0,style:{"text-align":"center",padding:"20px"}},pl={class:"record-card"},vl={class:"record-header"},fl={class:"rec-name"},gl={class:"rec-output"},_l={class:"chat-panel-head"},yl={class:"chat-wrap"},bl=lt({__name:"GoalsView",setup(hl){const ae=k(260),se=k(360),G=k("");let ce=0,ne=0;function pe(a,e){G.value=e,ce=a.clientX,ne=e==="side"?ae.value:se.value,document.addEventListener("mousemove",ve),document.addEventListener("mouseup",fe),a.preventDefault()}function ve(a){const e=a.clientX-ce;G.value==="side"?ae.value=Math.max(200,Math.min(400,ne+e)):se.value=Math.max(280,Math.min(560,ne-e))}function fe(){G.value="",document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",fe)}const J=k([]),U=k([]),W=k(""),K=k(""),i=k(null),D=k(!1),Q=k(!1),O=k("basic"),Z=k(!1),ee=k([]),oe=k(!1),te=k("0 9 * * 1"),S=k(""),o=ze({title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]}),h=ze({name:"",agentId:"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€çš„è¿›å±•æƒ…å†µï¼ˆå½“å‰è¿›åº¦ {goal.progress}ï¼‰ï¼Œè·æˆªæ­¢æ—¥æœŸ {goal.endAt} è¿˜æœ‰ä¸€æ®µæ—¶é—´ï¼Œè¯·æ€»ç»“è¿‘æœŸè¿›å±•å¹¶å»ºè®®ä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚",enabled:!0}),j=H(()=>{const a={};return U.value.forEach(e=>{a[e.id]=e.name}),a}),L=H(()=>{const a={};return U.value.forEach(e=>{a[e.id]=e.avatarColor||"#409eff"}),a}),R=H(()=>{let a=[...J.value];return W.value&&(a=a.filter(e=>e.status===W.value)),K.value&&(a=a.filter(e=>(e.agentIds||[]).includes(K.value))),a}),B=H(()=>{const a=R.value.filter(V=>Y(V.startAt)&&Y(V.endAt));if(!a.length){const V=new Date;return{start:new Date(V.getFullYear(),V.getMonth(),1),end:new Date(V.getFullYear(),V.getMonth()+3,1)}}const e=a.map(V=>new Date(V.startAt).getTime()),u=a.map(V=>new Date(V.endAt).getTime()),m=Math.min(...e),c=Math.max(...u),g=(c-m)*.05;return{start:new Date(m-g),end:new Date(c+g)}}),ge=H(()=>Ze(B.value.start,B.value.end)),_e=H(()=>{const{start:a,end:e}=B.value,u=Date.now();return u<a.getTime()||u>e.getTime()?null:`${(u-a.getTime())/(e.getTime()-a.getTime())*100}%`}),xe=H(()=>{const a=localStorage.getItem("aipanel_token")||"TOKEN",e=`${window.location.protocol}//${window.location.host}`,u=U.value.map(c=>`- ${c.id}: ${c.name}`).join(`
`),m=i.value?`
### å½“å‰é€‰ä¸­ç›®æ ‡
ID: ${i.value.id}
æ ‡é¢˜: ${i.value.title}
çŠ¶æ€: ${i.value.status}
è¿›åº¦: ${i.value.progress}%
å¼€å§‹: ${i.value.startAt||"æœªè®¾ç½®"}
ç»“æŸ: ${i.value.endAt||"æœªè®¾ç½®"}`:"";return`## ç›®æ ‡è§„åˆ’åŠ©æ‰‹

ä½ æ˜¯å›¢é˜Ÿçš„ç›®æ ‡è§„åˆ’åŠ©æ‰‹ã€‚

### ðŸŽ¯ æ ¸å¿ƒèƒ½åŠ›ï¼šå¡«å†™è¡¨å•ï¼ˆä¼˜å…ˆä½¿ç”¨ï¼‰

å½“ç”¨æˆ·æè¿°ç›®æ ‡ä¿¡æ¯æ—¶ï¼Œ**ç›´æŽ¥è¾“å‡º JSON å¡«å……è¡¨å•**ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

\`\`\`json
{"action":"fill_goal","data":{"title":"ç›®æ ‡æ ‡é¢˜","description":"æè¿°ï¼ˆå¯é€‰ï¼‰","type":"team","agentIds":["agentId1"],"status":"active","startAt":"2026-03-01T00:00:00Z","endAt":"2026-06-30T00:00:00Z","progress":0,"milestones":[{"title":"é‡Œç¨‹ç¢‘1","dueAt":"2026-04-01T00:00:00Z","done":false}]}}
\`\`\`

- type: "personal"ï¼ˆä¸ªäººï¼‰æˆ– "team"ï¼ˆå›¢é˜Ÿï¼‰
- status: "draft" / "active" / "completed" / "cancelled"
- agentIds: å‚ä¸Žæˆå‘˜çš„ ID åˆ—è¡¨
- æ—¶é—´æ ¼å¼ï¼šISO 8601ï¼ˆå¦‚ "2026-03-01T00:00:00Z"ï¼‰
- è¾“å‡º JSON åŽï¼Œé¡µé¢ä¼šè‡ªåŠ¨å¡«å……è¡¨å•ï¼Œç”¨æˆ·ç¡®è®¤åŽä¿å­˜

### API æ“ä½œï¼ˆå¦‚éœ€ç›´æŽ¥æ›´æ–°å·²æœ‰ç›®æ ‡ï¼‰

**æ›´æ–°è¿›åº¦ï¼š**
\`\`\`bash
curl -s -X PATCH ${e}/api/goals/{id}/progress -H "Authorization: Bearer ${a}" -H "Content-Type: application/json" -d '{"progress":50}'
\`\`\`

**æ·»åŠ å®šæœŸæ£€æŸ¥ï¼š**
\`\`\`bash
curl -s -X POST ${e}/api/goals/{id}/checks -H "Authorization: Bearer ${a}" -H "Content-Type: application/json" -d '{"name":"æ¯å‘¨æ£€æŸ¥","schedule":"0 9 * * 1","agentId":"agentId","tz":"Asia/Shanghai","prompt":"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€æœ¬å‘¨è¿›å±•","enabled":true}'
\`\`\`

### å½“å‰å›¢é˜Ÿæˆå‘˜
${u}
${m}

**å·¥ä½œæµç¨‹ï¼š**
1. ç”¨æˆ·æè¿°ç›®æ ‡ â†’ ä½ è¾“å‡º fill_goal JSON â†’ é¡µé¢è‡ªåŠ¨å¡«è¡¨
2. ç”¨æˆ·ç¡®è®¤å†…å®¹åŽè‡ªè¡Œç‚¹å‡»ã€Œåˆ›å»ºã€æˆ–ã€Œä¿å­˜ã€æŒ‰é’®
3. å¦‚éœ€æ›´æ–°å·²å­˜åœ¨ç›®æ ‡çš„è¿›åº¦/æ£€æŸ¥ï¼Œä½¿ç”¨ API æ“ä½œ`.trim()});at(async()=>{const a=await st.list().catch(()=>({data:[]}));U.value=(a.data||[]).filter(e=>!e.system),S.value=U.value[0]?.id||"",await N()}),nt(O,async a=>{a==="records"&&i.value&&await Ue(i.value.id)});async function N(){try{const a=await $.list();if(J.value=a.data||[],i.value){const e=J.value.find(u=>u.id===i.value.id);e&&(i.value=e)}}catch{}}async function Ue(a){oe.value=!0;try{const e=await $.listCheckRecords(a);ee.value=(e.data||[]).slice().reverse()}catch{ee.value=[]}finally{oe.value=!1}}function de(a){i.value=a,D.value=!1,O.value="basic",Object.assign(o,{title:a.title,description:a.description||"",type:a.type,agentIds:[...a.agentIds||[]],status:a.status,progress:a.progress,startAt:Y(a.startAt)?a.startAt:"",endAt:Y(a.endAt)?a.endAt:"",milestones:(a.milestones||[]).map(e=>({...e}))})}function ie(){i.value=null,D.value=!0,O.value="basic",Object.assign(o,{title:"",description:"",type:"team",agentIds:[],status:"draft",progress:0,startAt:"",endAt:"",milestones:[]})}async function ye(){if(!o.title.trim()){A.warning("è¯·å¡«å†™ç›®æ ‡æ ‡é¢˜");return}Q.value=!0;const a={title:o.title,description:o.description||void 0,type:o.type,agentIds:o.agentIds,status:o.status,progress:o.progress,startAt:o.startAt||void 0,endAt:o.endAt||void 0,milestones:o.milestones.map(e=>({...e,id:e.id||"ms-"+Math.random().toString(36).slice(2,10)}))};try{if(i.value)await $.update(i.value.id,a),A.success("ä¿å­˜æˆåŠŸ"),await N();else{const e=await $.create(a);A.success("åˆ›å»ºæˆåŠŸ"),D.value=!1,await N();const u=J.value.find(m=>m.id===e.data.id)||e.data;de(u)}}catch(e){A.error(e.response?.data?.error||"æ“ä½œå¤±è´¥")}finally{Q.value=!1}}async function Me(){if(i.value)try{await $.delete(i.value.id),A.success("å·²åˆ é™¤"),i.value=null,await N()}catch{A.error("åˆ é™¤å¤±è´¥")}}function be(){o.milestones.push({id:"ms-"+Math.random().toString(36).slice(2,10),title:"",dueAt:"",done:!1,agentIds:[]})}function $e(){Object.assign(h,{name:"",agentId:U.value[0]?.id||"",schedule:"0 9 * * 1",tz:"Asia/Shanghai",prompt:"è¯·æ£€æŸ¥ç›®æ ‡ã€Œ{goal.title}ã€çš„è¿›å±•æƒ…å†µï¼ˆå½“å‰è¿›åº¦ {goal.progress}ï¼‰ï¼Œè·æˆªæ­¢æ—¥æœŸ {goal.endAt} è¿˜æœ‰ä¸€æ®µæ—¶é—´ï¼Œè¯·æ€»ç»“è¿‘æœŸè¿›å±•å¹¶å»ºè®®ä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚",enabled:!0}),te.value="0 9 * * 1",Z.value=!0}function De(a){a!=="custom"&&(h.schedule=a)}async function Ye(){if(!h.name.trim()){A.warning("è¯·å¡«å†™æ£€æŸ¥åç§°");return}if(!h.agentId){A.warning("è¯·é€‰æ‹©æ‰§è¡Œæˆå‘˜");return}if(i.value)try{await $.addCheck(i.value.id,{...h}),A.success("æ·»åŠ æˆåŠŸ"),Z.value=!1;const a=await $.get(i.value.id);i.value=a.data,await N()}catch(a){A.error(a.response?.data?.error||"æ·»åŠ å¤±è´¥")}}async function Se(a){if(i.value)try{await $.updateCheck(i.value.id,a.id,{enabled:a.enabled})}catch{A.error("æ›´æ–°å¤±è´¥")}}async function Ne(a){if(i.value)try{await $.runCheck(i.value.id,a.id),A.success("å·²è§¦å‘æ£€æŸ¥")}catch(e){A.error(e.response?.data?.error||"è§¦å‘å¤±è´¥")}}async function He(a){if(i.value)try{await ut.confirm(`ç¡®å®šåˆ é™¤æ£€æŸ¥è®¡åˆ’ã€Œ${a.name}ã€ï¼Ÿ`,"åˆ é™¤ç¡®è®¤",{type:"warning"}),await $.removeCheck(i.value.id,a.id),A.success("å·²åˆ é™¤");const e=await $.get(i.value.id);i.value=e.data,await N()}catch(e){e!=="cancel"&&A.error("åˆ é™¤å¤±è´¥")}}const he=H(()=>S.value?i.value?`goal-${i.value.id}-${S.value}`:`goals-new-${S.value}`:"");function Le(a){setTimeout(()=>N(),2e3);const e=c=>{try{const g=JSON.parse(c);if(g.action==="fill_goal"&&g.data)return Be(g.data),!0}catch{}return!1},u=a.match(/```(?:json)?\s*(\{[\s\S]*?\})\s*```/);if(u?.[1]&&e(u[1]))return;const m=a.match(/(\{"action"\s*:\s*"fill_goal"[\s\S]*?\})/);m?.[1]&&e(m[1])}function Be(a){!D.value&&!i.value&&ie(),a.title&&(o.title=a.title),a.description&&(o.description=a.description),a.type&&(o.type=a.type),a.status&&(o.status=a.status),typeof a.progress=="number"&&(o.progress=a.progress),a.agentIds&&Array.isArray(a.agentIds)&&(o.agentIds=a.agentIds),a.startAt&&(o.startAt=a.startAt),a.endAt&&(o.endAt=a.endAt),a.milestones&&Array.isArray(a.milestones)&&(o.milestones=a.milestones.map(e=>({id:e.id||"ms-"+Math.random().toString(36).slice(2,10),title:e.title||"",dueAt:e.dueAt||"",done:!!e.done,agentIds:e.agentIds||[]}))),A.success("AI å·²å¡«å†™è¡¨å•ï¼Œç¡®è®¤åŽç‚¹å‡»ä¿å­˜")}function Y(a){if(!a)return!1;const e=new Date(a);return!isNaN(e.getTime())&&e.getFullYear()>1970}function Ee(a){return Y(a.startAt)&&Y(a.endAt)}function Fe(a){const{start:e,end:u}=B.value,m=u.getTime()-e.getTime();return Math.max(1,(new Date(a.endAt).getTime()-new Date(a.startAt).getTime())/m*100)}function Ge(a){const{start:e,end:u}=B.value,m=u.getTime()-e.getTime(),c=new Date(a.startAt).getTime(),g=new Date(a.endAt).getTime(),V=Math.max(0,(c-e.getTime())/m*100),M=Math.max(1,(g-c)/m*100),p=a.agentIds?.[0]&&L.value[a.agentIds[0]]?L.value[a.agentIds[0]]:"#409eff",E=a.agentIds?.[1]&&L.value[a.agentIds[1]]?L.value[a.agentIds[1]]:p;return{left:`${V}%`,width:`${M}%`,background:a.agentIds?.length>1?`linear-gradient(90deg,${p},${E})`:p}}function Oe(a){const{start:e,end:u}=B.value;return Y(a.dueAt)?`${(new Date(a.dueAt).getTime()-e.getTime())/(u.getTime()-e.getTime())*100}%`:"-100%"}function Ze(a,e){const u=[],m=new Date(a.getFullYear(),a.getMonth(),1),c=e.getTime()-a.getTime();for(;m<=e;){const g=(m.getTime()-a.getTime())/c*100;g>=0&&g<=100&&u.push({label:`${m.getFullYear()}/${m.getMonth()+1}`,left:`${g}%`}),m.setMonth(m.getMonth()+1)}return u}function je(a){return a.status==="completed"?"#67c23a":a.progress>=80?"#409eff":a.progress>=40?"#e6a23c":"#909399"}function Re(a){return{draft:"è‰ç¨¿",active:"è¿›è¡Œä¸­",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"}[a]??a}function Pe(a){return{draft:"info",active:"",completed:"success",cancelled:"danger"}[a]??"info"}function Ve(a){return Y(a)?new Date(a).toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}):"â€”"}function qe(a){if(!a)return"";const e=new Date(a);return isNaN(e.getTime())?"":e.toLocaleString("zh-CN")}return(a,e)=>{const u=f("el-icon"),m=f("el-button"),c=f("el-option"),g=f("el-select"),V=f("el-tag"),M=f("el-input"),p=f("el-form-item"),E=f("el-radio-button"),we=f("el-radio-group"),F=f("el-date-picker"),ke=f("el-slider"),Ae=f("el-checkbox"),ue=f("el-form"),Xe=f("el-popconfirm"),re=f("el-tab-pane"),P=f("el-table-column"),Je=f("el-text"),Ce=f("el-switch"),We=f("el-table"),Ie=f("el-empty"),Ke=f("el-timeline-item"),Qe=f("el-timeline"),et=f("el-tabs"),tt=f("el-dialog");return d(),r("div",ct,[n("div",{class:"gs-sidebar",style:x({width:ae.value+"px"})},[n("div",pt,[e[32]||(e[32]=n("span",{class:"sidebar-title"},"ç›®æ ‡è§„åˆ’",-1)),n("div",vt,[l(m,{size:"small",circle:"",onClick:N},{default:s(()=>[l(u,null,{default:s(()=>[l(w(ot))]),_:1})]),_:1}),l(m,{size:"small",type:"primary",circle:"",onClick:ie},{default:s(()=>[l(u,null,{default:s(()=>[l(w(X))]),_:1})]),_:1})])]),n("div",ft,[l(g,{modelValue:W.value,"onUpdate:modelValue":e[0]||(e[0]=t=>W.value=t),placeholder:"æ‰€æœ‰çŠ¶æ€",clearable:"",size:"small",class:"filter-sel"},{default:s(()=>[l(c,{label:"è‰ç¨¿",value:"draft"}),l(c,{label:"è¿›è¡Œä¸­",value:"active"}),l(c,{label:"å·²å®Œæˆ",value:"completed"}),l(c,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"]),l(g,{modelValue:K.value,"onUpdate:modelValue":e[1]||(e[1]=t=>K.value=t),placeholder:"æ‰€æœ‰æˆå‘˜",clearable:"",size:"small",class:"filter-sel"},{default:s(()=>[(d(!0),r(b,null,C(U.value,t=>(d(),z(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",gt,[D.value?(d(),r("div",_t,[n("div",yt,[n("span",bt,_(o.title.trim()||"æ–°ç›®æ ‡â€¦"),1),l(V,{type:"info",size:"small",effect:"plain"},{default:s(()=>[...e[33]||(e[33]=[y("è‰ç¨¿",-1)])]),_:1})]),e[34]||(e[34]=n("div",{class:"gi-new-hint"},"å°šæœªä¿å­˜",-1))])):T("",!0),R.value.length===0&&!D.value?(d(),r("div",ht,"æš‚æ— ç›®æ ‡")):T("",!0),(d(!0),r(b,null,C(R.value,t=>(d(),r("div",{key:t.id,class:q(["goal-item",{active:i.value?.id===t.id}]),onClick:v=>de(t)},[n("div",wt,[n("span",kt,_(t.title),1),l(V,{type:Pe(t.status),size:"small",effect:"plain"},{default:s(()=>[y(_(Re(t.status)),1)]),_:2},1032,["type"])]),n("div",At,[n("div",{class:"gi-progress-bar",style:x({width:t.progress+"%",background:je(t)})},null,4),n("span",Ct,_(t.progress)+"%",1)]),n("div",It,[n("div",zt,[(d(!0),r(b,null,C((t.agentIds||[]).slice(0,3),v=>(d(),r("div",{key:v,class:"gi-avatar",style:x({background:L.value[v]||"#6366f1"})},_((j.value[v]||v)[0]),5))),128)),(t.agentIds||[]).length>3?(d(),r("span",Tt,"+"+_(t.agentIds.length-3),1)):T("",!0)]),n("span",xt,_(Ve(t.startAt))+" â€” "+_(Ve(t.endAt)),1)])],10,Vt))),128))])],4),n("div",{class:q(["gs-handle",{dragging:G.value==="side"}]),onMousedown:e[2]||(e[2]=t=>pe(t,"side"))},[...e[35]||(e[35]=[n("div",{class:"gs-handle-bar"},null,-1)])],34),n("div",Ut,[!i.value&&!D.value?(d(),r("div",Mt,[n("div",$t,[n("span",Dt,[l(u,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:s(()=>[l(w(le))]),_:1}),e[36]||(e[36]=y(" ç›®æ ‡æ€»è§ˆ Â· ç”˜ç‰¹å›¾ ",-1))]),l(m,{type:"primary",size:"small",onClick:ie},{default:s(()=>[l(u,null,{default:s(()=>[l(w(X))]),_:1}),e[37]||(e[37]=y(" æ–°å»ºç›®æ ‡ ",-1))]),_:1})]),R.value.length===0?(d(),r("div",Yt,[l(u,{size:"48",color:"#c0c4cc"},{default:s(()=>[l(w(le))]),_:1}),e[38]||(e[38]=n("p",null,"æš‚æ— ç›®æ ‡ï¼Œç‚¹å‡»æ–°å»ºå¼€å§‹è§„åˆ’",-1))])):(d(),r("div",St,[n("div",Nt,[e[39]||(e[39]=n("div",{class:"gantt-label-col"},null,-1)),n("div",Ht,[n("div",Lt,[(d(!0),r(b,null,C(ge.value,t=>(d(),r("div",{key:t.label,class:"gantt-month-label",style:x({left:t.left})},_(t.label),5))),128))])])]),n("div",Bt,[n("div",Et,[e[40]||(e[40]=n("div",{class:"gantt-label-col"},null,-1)),n("div",Ft,[(d(!0),r(b,null,C(ge.value,t=>(d(),r("div",{key:"gv-"+t.label,class:"gantt-grid-line",style:x({left:t.left})},null,4))),128)),_e.value!==null?(d(),r("div",{key:0,class:"gantt-today-line",style:x({left:_e.value})},null,4)):T("",!0)])]),(d(!0),r(b,null,C(R.value,t=>(d(),r("div",{key:t.id,class:"gantt-row",onClick:v=>de(t)},[n("div",Ot,[n("div",Zt,[n("div",jt,[(d(!0),r(b,null,C((t.agentIds||[]).slice(0,2),v=>(d(),r("div",{key:v,class:"gantt-avatar",style:x({background:L.value[v]||"#409eff"})},_((j.value[v]||v).slice(0,1)),5))),128))]),n("span",Rt,_(t.title),1),n("span",{class:q(["gantt-pct","s-"+t.status])},_(t.progress)+"%",3)])]),n("div",Pt,[Ee(t)?(d(),r(b,{key:0},[n("div",{class:"gantt-bar",style:x(Ge(t))},[n("div",{class:"gantt-bar-progress",style:x({width:t.progress+"%"})},null,4),Fe(t)>8?(d(),r("span",qt,_(t.title),1)):T("",!0)],4),(d(!0),r(b,null,C(t.milestones||[],v=>(d(),r(b,{key:v.id},[Y(v.dueAt)?(d(),r("div",{key:0,class:q(["gantt-milestone",{done:v.done}]),style:x({left:Oe(v)}),title:v.title},null,14,Xt)):T("",!0)],64))),128))],64)):(d(),r("div",Jt,"æœªè®¾ç½®æ—¶é—´èŒƒå›´"))])],8,Gt))),128))])]))])):D.value?(d(),r(b,{key:1},[n("div",Wt,[n("div",Kt,[l(u,{style:{color:"#909399"}},{default:s(()=>[l(w(le))]),_:1}),e[41]||(e[41]=n("span",{class:"crumb-sep"},"æ–°å»º",-1)),e[42]||(e[42]=n("span",{class:"crumb-name"},"ç›®æ ‡",-1))]),n("div",Qt,[l(m,{size:"small",onClick:e[3]||(e[3]=t=>D.value=!1)},{default:s(()=>[...e[43]||(e[43]=[y("å–æ¶ˆ",-1)])]),_:1}),l(m,{size:"small",type:"primary",loading:Q.value,onClick:ye},{default:s(()=>[l(u,null,{default:s(()=>[l(w(Te))]),_:1}),e[44]||(e[44]=y(" åˆ›å»º ",-1))]),_:1},8,["loading"])])]),n("div",el,[l(ue,{model:o,"label-width":"90px",size:"small",class:"goal-inner-form"},{default:s(()=>[l(p,{label:"æ ‡é¢˜",required:""},{default:s(()=>[l(M,{modelValue:o.title,"onUpdate:modelValue":e[4]||(e[4]=t=>o.title=t),placeholder:"ç›®æ ‡æ ‡é¢˜"},null,8,["modelValue"])]),_:1}),l(p,{label:"æè¿°"},{default:s(()=>[l(M,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=t=>o.description=t),type:"textarea",rows:2,placeholder:"ï¼ˆå¯é€‰ï¼‰"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç±»åž‹"},{default:s(()=>[l(we,{modelValue:o.type,"onUpdate:modelValue":e[6]||(e[6]=t=>o.type=t)},{default:s(()=>[l(E,{value:"personal"},{default:s(()=>[...e[45]||(e[45]=[y("ä¸ªäºº",-1)])]),_:1}),l(E,{value:"team"},{default:s(()=>[...e[46]||(e[46]=[y("å›¢é˜Ÿ",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å‚ä¸Žæˆå‘˜"},{default:s(()=>[l(g,{modelValue:o.agentIds,"onUpdate:modelValue":e[7]||(e[7]=t=>o.agentIds=t),multiple:"",placeholder:"é€‰æ‹©æˆå‘˜",style:{width:"100%"}},{default:s(()=>[(d(!0),r(b,null,C(U.value,t=>(d(),z(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"çŠ¶æ€"},{default:s(()=>[l(g,{modelValue:o.status,"onUpdate:modelValue":e[8]||(e[8]=t=>o.status=t),style:{width:"100%"}},{default:s(()=>[l(c,{label:"è‰ç¨¿",value:"draft"}),l(c,{label:"è¿›è¡Œä¸­",value:"active"}),l(c,{label:"å·²å®Œæˆ",value:"completed"}),l(c,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å¼€å§‹æ—¶é—´"},{default:s(()=>[l(F,{modelValue:o.startAt,"onUpdate:modelValue":e[9]||(e[9]=t=>o.startAt=t),type:"datetime",placeholder:"é€‰æ‹©å¼€å§‹æ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç»“æŸæ—¶é—´"},{default:s(()=>[l(F,{modelValue:o.endAt,"onUpdate:modelValue":e[10]||(e[10]=t=>o.endAt=t),type:"datetime",placeholder:"é€‰æ‹©ç»“æŸæ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),i.value?(d(),z(p,{key:0,label:"è¿›åº¦"},{default:s(()=>[l(ke,{modelValue:o.progress,"onUpdate:modelValue":e[11]||(e[11]=t=>o.progress=t),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1})):T("",!0),l(p,{label:"é‡Œç¨‹ç¢‘"},{default:s(()=>[n("div",tl,[(d(!0),r(b,null,C(o.milestones,(t,v)=>(d(),r("div",{key:v,class:"milestone-row"},[l(Ae,{modelValue:t.done,"onUpdate:modelValue":I=>t.done=I},null,8,["modelValue","onUpdate:modelValue"]),l(M,{modelValue:t.title,"onUpdate:modelValue":I=>t.title=I,placeholder:"é‡Œç¨‹ç¢‘æ ‡é¢˜",size:"small",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),l(F,{modelValue:t.dueAt,"onUpdate:modelValue":I=>t.dueAt=I,type:"date",placeholder:"æˆªæ­¢æ—¥",size:"small",style:{width:"130px"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue","onUpdate:modelValue"]),l(m,{type:"danger",size:"small",circle:"",onClick:I=>o.milestones.splice(v,1)},{default:s(()=>[l(u,null,{default:s(()=>[l(w(me))]),_:1})]),_:1},8,["onClick"])]))),128)),l(m,{size:"small",onClick:be,style:{"margin-top":"4px"}},{default:s(()=>[l(u,null,{default:s(()=>[l(w(X))]),_:1}),e[47]||(e[47]=y(" æ·»åŠ é‡Œç¨‹ç¢‘ ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])])],64)):i.value?(d(),r(b,{key:2},[n("div",ll,[n("div",al,[l(u,{style:{color:"#909399"}},{default:s(()=>[l(w(le))]),_:1}),e[48]||(e[48]=n("span",{class:"crumb-sep"},"ç›®æ ‡",-1)),n("span",sl,_(i.value.title),1)]),n("div",nl,[l(m,{size:"small",type:"primary",loading:Q.value,onClick:ye},{default:s(()=>[l(u,null,{default:s(()=>[l(w(Te))]),_:1}),e[49]||(e[49]=y(" ä¿å­˜ ",-1))]),_:1},8,["loading"]),l(Xe,{title:`ç¡®è®¤åˆ é™¤ã€Œ${i.value.title}ã€ï¼Ÿ`,onConfirm:Me},{reference:s(()=>[l(m,{size:"small",type:"danger",plain:""},{default:s(()=>[l(u,null,{default:s(()=>[l(w(me))]),_:1})]),_:1})]),_:1},8,["title"])])]),l(et,{modelValue:O.value,"onUpdate:modelValue":e[20]||(e[20]=t=>O.value=t),class:"editor-tabs"},{default:s(()=>[l(re,{label:"åŸºæœ¬ä¿¡æ¯",name:"basic"},{default:s(()=>[n("div",ol,[l(ue,{model:o,"label-width":"90px",size:"small",class:"goal-inner-form"},{default:s(()=>[l(p,{label:"æ ‡é¢˜",required:""},{default:s(()=>[l(M,{modelValue:o.title,"onUpdate:modelValue":e[12]||(e[12]=t=>o.title=t),placeholder:"ç›®æ ‡æ ‡é¢˜"},null,8,["modelValue"])]),_:1}),l(p,{label:"æè¿°"},{default:s(()=>[l(M,{modelValue:o.description,"onUpdate:modelValue":e[13]||(e[13]=t=>o.description=t),type:"textarea",rows:2,placeholder:"ï¼ˆå¯é€‰ï¼‰"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç±»åž‹"},{default:s(()=>[l(we,{modelValue:o.type,"onUpdate:modelValue":e[14]||(e[14]=t=>o.type=t)},{default:s(()=>[l(E,{value:"personal"},{default:s(()=>[...e[50]||(e[50]=[y("ä¸ªäºº",-1)])]),_:1}),l(E,{value:"team"},{default:s(()=>[...e[51]||(e[51]=[y("å›¢é˜Ÿ",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å‚ä¸Žæˆå‘˜"},{default:s(()=>[l(g,{modelValue:o.agentIds,"onUpdate:modelValue":e[15]||(e[15]=t=>o.agentIds=t),multiple:"",placeholder:"é€‰æ‹©æˆå‘˜",style:{width:"100%"}},{default:s(()=>[(d(!0),r(b,null,C(U.value,t=>(d(),z(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"çŠ¶æ€"},{default:s(()=>[l(g,{modelValue:o.status,"onUpdate:modelValue":e[16]||(e[16]=t=>o.status=t),style:{width:"100%"}},{default:s(()=>[l(c,{label:"è‰ç¨¿",value:"draft"}),l(c,{label:"è¿›è¡Œä¸­",value:"active"}),l(c,{label:"å·²å®Œæˆ",value:"completed"}),l(c,{label:"å·²å–æ¶ˆ",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"å¼€å§‹æ—¶é—´"},{default:s(()=>[l(F,{modelValue:o.startAt,"onUpdate:modelValue":e[17]||(e[17]=t=>o.startAt=t),type:"datetime",placeholder:"é€‰æ‹©å¼€å§‹æ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),l(p,{label:"ç»“æŸæ—¶é—´"},{default:s(()=>[l(F,{modelValue:o.endAt,"onUpdate:modelValue":e[18]||(e[18]=t=>o.endAt=t),type:"datetime",placeholder:"é€‰æ‹©ç»“æŸæ—¶é—´",style:{width:"100%"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue"])]),_:1}),i.value?(d(),z(p,{key:0,label:"è¿›åº¦"},{default:s(()=>[l(ke,{modelValue:o.progress,"onUpdate:modelValue":e[19]||(e[19]=t=>o.progress=t),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1})):T("",!0),l(p,{label:"é‡Œç¨‹ç¢‘"},{default:s(()=>[n("div",dl,[(d(!0),r(b,null,C(o.milestones,(t,v)=>(d(),r("div",{key:v,class:"milestone-row"},[l(Ae,{modelValue:t.done,"onUpdate:modelValue":I=>t.done=I},null,8,["modelValue","onUpdate:modelValue"]),l(M,{modelValue:t.title,"onUpdate:modelValue":I=>t.title=I,placeholder:"é‡Œç¨‹ç¢‘æ ‡é¢˜",size:"small",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),l(F,{modelValue:t.dueAt,"onUpdate:modelValue":I=>t.dueAt=I,type:"date",placeholder:"æˆªæ­¢æ—¥",size:"small",style:{width:"130px"},"value-format":"YYYY-MM-DDTHH:mm:ssZ"},null,8,["modelValue","onUpdate:modelValue"]),l(m,{type:"danger",size:"small",circle:"",onClick:I=>o.milestones.splice(v,1)},{default:s(()=>[l(u,null,{default:s(()=>[l(w(me))]),_:1})]),_:1},8,["onClick"])]))),128)),l(m,{size:"small",onClick:be,style:{"margin-top":"4px"}},{default:s(()=>[l(u,null,{default:s(()=>[l(w(X))]),_:1}),e[52]||(e[52]=y(" æ·»åŠ é‡Œç¨‹ç¢‘ ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1}),l(re,{label:"å®šæœŸæ£€æŸ¥",name:"checks"},{default:s(()=>[n("div",il,[n("div",ul,[l(m,{type:"primary",size:"small",onClick:$e},{default:s(()=>[l(u,null,{default:s(()=>[l(w(X))]),_:1}),e[53]||(e[53]=y(" æ·»åŠ æ£€æŸ¥ ",-1))]),_:1})]),l(We,{data:i.value.checks,size:"small",stripe:"",class:"checks-table"},{default:s(()=>[l(P,{prop:"name",label:"åç§°","min-width":"120"}),l(P,{label:"é¢‘çŽ‡","min-width":"140"},{default:s(({row:t})=>[n("code",rl,_(t.schedule),1),l(Je,{type:"info",size:"small",style:{"margin-left":"4px"}},{default:s(()=>[y(_(t.tz||"Asia/Shanghai"),1)]),_:2},1024)]),_:1}),l(P,{label:"æˆå‘˜",width:"90"},{default:s(({row:t})=>[y(_(j.value[t.agentId]||t.agentId),1)]),_:1}),l(P,{label:"å¯ç”¨",width:"60"},{default:s(({row:t})=>[l(Ce,{modelValue:t.enabled,"onUpdate:modelValue":v=>t.enabled=v,size:"small",onChange:v=>Se(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(P,{label:"æ“ä½œ",width:"130"},{default:s(({row:t})=>[l(m,{size:"small",link:"",onClick:v=>Ne(t)},{default:s(()=>[...e[54]||(e[54]=[y("ç«‹å³è¿è¡Œ",-1)])]),_:1},8,["onClick"]),l(m,{size:"small",link:"",type:"danger",onClick:v=>He(t)},{default:s(()=>[...e[55]||(e[55]=[y("åˆ é™¤",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),i.value.checks?.length?T("",!0):(d(),z(Ie,{key:0,description:"æš‚æ— æ£€æŸ¥è®¡åˆ’","image-size":60}))])]),_:1}),l(re,{label:"æ£€æŸ¥è®°å½•",name:"records"},{default:s(()=>[n("div",ml,[oe.value?(d(),r("div",cl,[l(u,{class:"is-loading",size:"24"},{default:s(()=>[l(w(dt))]),_:1})])):ee.value.length?(d(),z(Qe,{key:1,class:"records-timeline"},{default:s(()=>[(d(!0),r(b,null,C(ee.value,t=>(d(),z(Ke,{key:t.id,timestamp:qe(t.runAt),type:t.status==="ok"?"success":"danger",placement:"top"},{default:s(()=>[n("div",pl,[n("div",vl,[n("div",{class:"rec-avatar",style:x({background:L.value[t.agentId]||"#409eff"})},_((j.value[t.agentId]||"?")[0]),5),n("span",fl,_(j.value[t.agentId]||t.agentId),1),l(V,{type:t.status==="ok"?"success":"danger",size:"small"},{default:s(()=>[y(_(t.status),1)]),_:2},1032,["type"])]),n("div",gl,_(t.output||"ï¼ˆæ— è¾“å‡ºï¼‰"),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})):(d(),z(Ie,{key:2,description:"æš‚æ— æ£€æŸ¥è®°å½•","image-size":60}))])]),_:1})]),_:1},8,["modelValue"])],64)):T("",!0)]),n("div",{class:q(["gs-handle",{dragging:G.value==="chat"}]),onMousedown:e[21]||(e[21]=t=>pe(t,"chat"))},[...e[56]||(e[56]=[n("div",{class:"gs-handle-bar"},null,-1)])],34),n("div",{class:"gs-chat",style:x({width:se.value+"px"})},[n("div",_l,[l(u,null,{default:s(()=>[l(w(it))]),_:1}),e[57]||(e[57]=n("span",null,"AI ç›®æ ‡åŠ©æ‰‹",-1)),l(g,{modelValue:S.value,"onUpdate:modelValue":e[22]||(e[22]=t=>S.value=t),size:"small",style:{"margin-left":"auto",width:"110px"},placeholder:"é€‰æ‹©æˆå‘˜"},{default:s(()=>[(d(!0),r(b,null,C(U.value,t=>(d(),z(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",yl,[S.value?(d(),z(rt,{key:he.value,"agent-id":S.value,"session-id":he.value,context:xe.value,"welcome-message":i.value?`æ­£åœ¨æŸ¥çœ‹ç›®æ ‡ã€Œ${i.value.title}ã€ï¼Œæˆ‘å¯ä»¥å¸®ä½ ä¿®æ”¹ç›®æ ‡ä¿¡æ¯ã€æ·»åŠ é‡Œç¨‹ç¢‘æˆ–è®¾ç½®å®šæœŸæ£€æŸ¥ã€‚`:"ä½ å¥½ï¼æˆ‘å¯ä»¥å¸®ä½ åˆ›å»ºç›®æ ‡ï¼Œè¯´ä¸€ä¸‹éœ€æ±‚å³å¯ï¼Œæˆ‘ä¼šè‡ªåŠ¨å¡«å†™è¡¨å•ã€‚",examples:i.value?["å¸®æˆ‘æŠŠè¿›åº¦æ›´æ–°åˆ° 60%","æ·»åŠ 3ä¸ªé‡Œç¨‹ç¢‘","æ¯å‘¨ä¸€æ£€æŸ¥è¿™ä¸ªç›®æ ‡"]:["å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå›¢é˜Ÿç›®æ ‡ï¼šQ2ç”¨æˆ·å¢žé•¿ï¼Œ3æœˆ1æ—¥åˆ°6æœˆ30æ—¥","ä¸ªäººç›®æ ‡ï¼šå­¦ä¹  Go è¯­è¨€ï¼Œæœ¬æœˆå®Œæˆ"],height:"100%",onResponse:Le},null,8,["agent-id","session-id","context","welcome-message","examples"])):T("",!0)])],4),l(tt,{modelValue:Z.value,"onUpdate:modelValue":e[31]||(e[31]=t=>Z.value=t),title:"æ·»åŠ å®šæœŸæ£€æŸ¥",width:"480px"},{footer:s(()=>[l(m,{onClick:e[30]||(e[30]=t=>Z.value=!1)},{default:s(()=>[...e[59]||(e[59]=[y("å–æ¶ˆ",-1)])]),_:1}),l(m,{type:"primary",onClick:Ye},{default:s(()=>[...e[60]||(e[60]=[y("æ·»åŠ ",-1)])]),_:1})]),default:s(()=>[l(ue,{model:h,"label-width":"90px",size:"small"},{default:s(()=>[l(p,{label:"åç§°",required:""},{default:s(()=>[l(M,{modelValue:h.name,"onUpdate:modelValue":e[23]||(e[23]=t=>h.name=t),placeholder:"å¦‚ï¼šæ¯å‘¨è¿›åº¦æ£€æŸ¥"},null,8,["modelValue"])]),_:1}),l(p,{label:"æ‰§è¡Œæˆå‘˜",required:""},{default:s(()=>[l(g,{modelValue:h.agentId,"onUpdate:modelValue":e[24]||(e[24]=t=>h.agentId=t),style:{width:"100%"}},{default:s(()=>[(d(!0),r(b,null,C(U.value,t=>(d(),z(c,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"æ£€æŸ¥é¢‘çŽ‡"},{default:s(()=>[l(g,{modelValue:te.value,"onUpdate:modelValue":e[25]||(e[25]=t=>te.value=t),style:{width:"100%"},onChange:De},{default:s(()=>[l(c,{label:"æ¯å¤©ä¸Šåˆ9ç‚¹",value:"0 9 * * *"}),l(c,{label:"æ¯å‘¨ä¸€ä¸Šåˆ9ç‚¹",value:"0 9 * * 1"}),l(c,{label:"æ¯å‘¨äº”ä¸‹åˆ5ç‚¹",value:"0 17 * * 5"}),l(c,{label:"æ¯æœˆ1æ—¥ä¸Šåˆ9ç‚¹",value:"0 9 1 * *"}),l(c,{label:"è‡ªå®šä¹‰",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),te.value==="custom"?(d(),z(p,{key:0,label:"Cron"},{default:s(()=>[l(M,{modelValue:h.schedule,"onUpdate:modelValue":e[26]||(e[26]=t=>h.schedule=t),placeholder:"0 9 * * 1"},null,8,["modelValue"])]),_:1})):T("",!0),l(p,{label:"æ—¶åŒº"},{default:s(()=>[l(g,{modelValue:h.tz,"onUpdate:modelValue":e[27]||(e[27]=t=>h.tz=t),style:{width:"100%"}},{default:s(()=>[l(c,{label:"Asia/Shanghai",value:"Asia/Shanghai"}),l(c,{label:"UTC",value:"UTC"}),l(c,{label:"America/New_York",value:"America/New_York"})]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"æ£€æŸ¥æç¤ºè¯"},{default:s(()=>[l(M,{modelValue:h.prompt,"onUpdate:modelValue":e[28]||(e[28]=t=>h.prompt=t),type:"textarea",rows:3,placeholder:"å¯ç”¨å˜é‡ï¼š{goal.title} {goal.progress} {goal.endAt}"},null,8,["modelValue"]),e[58]||(e[58]=n("div",{style:{"font-size":"11px",color:"#94a3b8","margin-top":"3px"}}," å˜é‡ï¼š{goal.title} {goal.progress} {goal.endAt} {goal.startAt} {goal.status} ",-1))]),_:1}),l(p,{label:"å¯ç”¨"},{default:s(()=>[l(Ce,{modelValue:h.enabled,"onUpdate:modelValue":e[29]||(e[29]=t=>h.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Al=mt(bl,[["__scopeId","data-v-7a2bf978"]]);export{Al as default};
