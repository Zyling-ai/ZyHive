import{u as N}from"./agents-CLVTDRW2.js";import{d as L,o as M,s as P,m as j,c as h,e as n,b as t,w as e,g as k,l as v,r as w,h as d,i as m,f as i,t as o,n as x,p as q,F as E,q as G}from"./index-DS0rbJSH.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"dashboard-page"},J={key:0,class:"no-model-banner"},O={class:"stat-value"},Q={class:"stat-value"},R={class:"stat-value"},U={class:"stat-value"},W={style:{"font-weight":"600"}},X={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Y={style:{display:"flex","align-items":"center",gap:"8px"}},Z=L({__name:"DashboardView",setup(ee){const c=N(),u=w(null),y=w(-1),A=w(!0);M(async()=>{c.fetchAll(),await Promise.allSettled([P.get().then(l=>{u.value=l.data}).catch(()=>{}),j.list().then(l=>{y.value=l.data?.length??0}).catch(()=>{y.value=0})]),A.value=!1});function z(l){return l==="running"?"success":l==="stopped"?"danger":"info"}function I(l){return l==="running"?"运行中":l==="stopped"?"已停止":"空闲"}function C(l){return l?l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${(l/1e3).toFixed(1)}k`:String(l):"0"}return(l,s)=>{const S=d("router-link"),p=d("el-card"),f=d("el-col"),T=d("el-row"),D=d("DataAnalysis"),V=d("el-icon"),b=d("el-button"),r=d("el-table-column"),_=d("el-tag"),$=d("el-table"),B=d("el-text"),F=d("el-empty");return m(),h("div",H,[s[12]||(s[12]=n("h2",{style:{margin:"0 0 20px"}},"仪表盘",-1)),!A.value&&y.value===0?(m(),h("div",J,[s[2]||(s[2]=n("div",{class:"no-model-banner-left"},[n("span",{class:"no-model-banner-icon"},"⚠️"),n("div",null,[n("div",{class:"no-model-banner-title"},"还没有配置 AI 模型"),n("div",{class:"no-model-banner-desc"},"添加模型 API Key 后，AI 成员才能开始工作。支持 Claude、DeepSeek、GPT-4 等。")])],-1)),t(S,{to:"/config/models",class:"no-model-banner-btn"},{default:e(()=>[...s[1]||(s[1]=[i("立即配置 →",-1)])]),_:1})])):k("",!0),t(T,{gutter:12,style:{"margin-bottom":"20px"}},{default:e(()=>[t(f,{xs:12,sm:12,md:6,lg:6},{default:e(()=>[t(p,{shadow:"never",class:"stat-card stat-card--members"},{default:e(()=>[s[3]||(s[3]=n("div",{class:"stat-label"},"AI 成员",-1)),n("div",O,o(u.value?.agents.total??x(c).list.length),1)]),_:1})]),_:1}),t(f,{xs:12,sm:12,md:6,lg:6},{default:e(()=>[t(p,{shadow:"never",class:"stat-card stat-card--sessions"},{default:e(()=>[s[4]||(s[4]=n("div",{class:"stat-label"},"对话总数",-1)),n("div",Q,o(u.value?.sessions.total??0),1)]),_:1})]),_:1}),t(f,{xs:12,sm:12,md:6,lg:6,style:{"margin-top":"0"}},{default:e(()=>[t(p,{shadow:"never",class:"stat-card stat-card--messages"},{default:e(()=>[s[5]||(s[5]=n("div",{class:"stat-label"},"消息总数",-1)),n("div",R,o(u.value?.sessions.totalMessages??0),1)]),_:1})]),_:1}),t(f,{xs:12,sm:12,md:6,lg:6,style:{"margin-top":"0"}},{default:e(()=>[t(p,{shadow:"never",class:"stat-card stat-card--tokens"},{default:e(()=>[s[6]||(s[6]=n("div",{class:"stat-label"},"Token 用量",-1)),n("div",U,o(C(u.value?.sessions.totalTokens??0)),1)]),_:1})]),_:1})]),_:1}),u.value?.topAgents?.length?(m(),v(p,{key:1,shadow:"hover",style:{"margin-bottom":"24px"}},{header:e(()=>[n("span",W,[t(V,{style:{"vertical-align":"-2px","margin-right":"4px"}},{default:e(()=>[t(D)]),_:1}),s[7]||(s[7]=i("成员用量排行",-1))])]),default:e(()=>[t($,{data:u.value.topAgents,stripe:"",style:{width:"100%"}},{default:e(()=>[t(r,{label:"成员","min-width":"140"},{default:e(({row:a})=>[t(b,{type:"primary",link:"",onClick:g=>l.$router.push(`/agents/${a.id}`)},{default:e(()=>[i(o(a.name),1)]),_:2},1032,["onClick"])]),_:1}),t(r,{label:"对话数",width:"100",align:"center"},{default:e(({row:a})=>[t(_,{size:"small",type:"info"},{default:e(()=>[i(o(a.sessions),1)]),_:2},1024)]),_:1}),t(r,{label:"消息数",width:"100",align:"center"},{default:e(({row:a})=>[i(o(a.messages),1)]),_:1}),t(r,{label:"Token 用量",width:"130",align:"center"},{default:e(({row:a})=>[t(_,{size:"small",type:a.tokens>1e5?"danger":a.tokens>5e4?"warning":"success",effect:"plain"},{default:e(()=>[i(o(C(a.tokens)),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])]),_:1})):k("",!0),t(p,{shadow:"hover"},{header:e(()=>[n("div",X,[s[9]||(s[9]=n("span",{style:{"font-weight":"600"}},"成员状态",-1)),t(b,{type:"primary",size:"small",onClick:s[0]||(s[0]=a=>l.$router.push("/agents"))},{default:e(()=>[...s[8]||(s[8]=[i(" 管理成员 ",-1)])]),_:1})])]),default:e(()=>[t($,{data:x(c).list,stripe:"",style:{width:"100%"}},{default:e(()=>[t(r,{label:"名称","min-width":"150"},{default:e(({row:a})=>[n("div",Y,[n("div",{class:"avatar-dot",style:q({background:a.avatarColor||"#409eff"})},o(a.name.charAt(0)),5),n("span",null,o(a.name),1)])]),_:1}),t(r,{label:"模型","min-width":"180"},{default:e(({row:a})=>[t(_,{size:"small",type:"info"},{default:e(()=>[i(o(a.modelId||a.model||"-"),1)]),_:2},1024)]),_:1}),t(r,{label:"通道","min-width":"140"},{default:e(({row:a})=>[a.channelIds?.length?(m(!0),h(E,{key:0},G(a.channelIds,g=>(m(),v(_,{key:g,size:"small",style:{"margin-right":"4px"}},{default:e(()=>[i(o(g),1)]),_:2},1024))),128)):(m(),v(B,{key:1,type:"info",size:"small"},{default:e(()=>[...s[10]||(s[10]=[i("—",-1)])]),_:1}))]),_:1}),t(r,{label:"状态",width:"100"},{default:e(({row:a})=>[t(_,{type:z(a.status),size:"small"},{default:e(()=>[i(o(I(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(r,{label:"操作",width:"100"},{default:e(({row:a})=>[t(b,{type:"primary",size:"small",link:"",onClick:g=>l.$router.push(`/agents/${a.id}`)},{default:e(()=>[...s[11]||(s[11]=[i(" 对话 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),x(c).list.length===0?(m(),v(F,{key:0,description:"暂无 AI 成员"})):k("",!0)]),_:1})])}}}),le=K(Z,[["__scopeId","data-v-6a02e355"]]);export{le as default};
